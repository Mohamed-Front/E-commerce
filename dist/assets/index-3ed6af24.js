import{_ as X,u as Y,f as Z,G as ee,r as l,w as te,o as oe,h as r,i as V,b as B,c as ae,j as n,e as o,k as c,l as h,m as se,B as t,a as L,t as p,q as w,x as ne,y as le}from"./index-7330e92f.js";const k=m=>(ne("data-v-39daba6e"),m=m(),le(),m),ce={class:"grid"},re={class:"col-12"},ie={class:"card p-4 shadow-2 border-round"},de={class:"text-2xl font-bold"},ue={class:"flex gap-2"},pe={class:"p-input-icon-left"},_e=k(()=>n("i",{class:"pi pi-search"},null,-1)),ve={class:"card shadow-1 surface-0"},he={class:"text-center py-4"},me=k(()=>n("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),fe={class:"text-xl"},ge={class:"flex justify-content-center align-items-center py-4"},ye={class:"flex align-items-center justify-content-center"},xe=k(()=>n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),be={setup(m){const C=Y(),y=Z(),{t:e}=ee(),f=l(!0),D=l([]),_=l(!1),T=l(null),P=l(null),$=l({}),g=l("");l(null);const S=l(1),I=l(0),x=l(10),N=l(0),b=()=>{f.value=!0,L.get("/api/coupon",{params:{page:S.value,per_page:x.value,search:g.value||void 0}}).then(s=>{D.value=s.data.data.data,I.value=s.data.data.total,N.value=s.data.data.last_page,f.value=!1}).catch(s=>{y.add({severity:"error",summary:e("error"),detail:e("coupon.loadError"),life:3e3}),f.value=!1,console.error("Error fetching coupons:",s)})};te([S,x,g],()=>{b()});const E=s=>{T.value=s,_.value=!0},j=()=>{L.delete(`/api/coupon/${T.value}`).then(()=>{y.add({severity:"success",summary:e("success"),detail:e("coupon.deleteSuccess"),life:3e3}),b(),_.value=!1}).catch(s=>{y.add({severity:"error",summary:e("error"),detail:e("coupon.deleteError"),life:3e3})})},G=()=>{P.value.exportCSV()},M=()=>{C.push({name:"coupon-create"})},U=s=>{C.push({name:"coupon-update",params:{id:s}})},q=s=>s===1?"success":"info",z=s=>new Date(s).toLocaleDateString();return oe(()=>{b()}),(s,i)=>{const F=r("InputText"),d=r("Button"),Q=r("Toolbar"),W=r("Toast"),u=r("Column"),A=r("Tag"),H=r("ProgressSpinner"),J=r("DataTable"),K=r("Dialog"),v=V("can"),R=V("tooltip");return B(),ae("div",ce,[n("div",re,[n("div",ie,[o(Q,{class:"mb-4"},{start:c(()=>[n("h2",de,p(t(e)("coupon.managementTitle")),1)]),end:c(()=>[n("div",ue,[n("span",pe,[_e,o(F,{modelValue:g.value,"onUpdate:modelValue":i[0]||(i[0]=a=>g.value=a),placeholder:t(e)("coupon.search")},null,8,["modelValue","placeholder"])]),h(o(d,{label:t(e)("coupon.export"),icon:"pi pi-upload",class:"p-export",onClick:G},null,8,["label"]),[[v,"list coupons"]]),h(o(d,{label:t(e)("coupon.new"),icon:"pi pi-plus",class:"p-button-success",onClick:M},null,8,["label"]),[[v,"create coupons"]])])]),_:1}),o(W),n("div",ve,[h((B(),se(J,{ref_key:"dt",ref:P,value:D.value,loading:f.value,"data-key":"id",paginator:!0,rows:x.value,filters:$.value,totalRecords:I.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,20,30],"current-page-report-template":`${t(e)("show")} {first} ${t(e)("to")} {last} ${t(e)("from")} {totalRecords}`,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[n("div",he,[me,n("p",fe,p(t(e)("coupon.noData")),1)])]),loading:c(()=>[n("div",ge,[o(H,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:c(()=>[o(u,{"selection-mode":"multiple","header-style":"width: 3rem"}),o(u,{field:"code",header:t(e)("coupon.code"),sortable:!0},{body:c(a=>[w(p(a.data.code),1)]),_:1},8,["header"]),o(u,{field:"discount_type_description",header:t(e)("coupon.type"),sortable:!0},{body:c(a=>[o(A,{value:a.data.discount_type_description,severity:q(a.data.discount_type)},null,8,["value","severity"])]),_:1},8,["header"]),o(u,{field:"discount_value",header:t(e)("coupon.value"),sortable:!0},{body:c(a=>[w(p(a.data.discount_value),1)]),_:1},8,["header"]),o(u,{field:"expires_at",header:t(e)("coupon.expiry"),sortable:!0},{body:c(a=>[w(p(z(a.data.expires_at)),1)]),_:1},8,["header"]),o(u,{header:t(e)("actions"),headerStyle:"width: 12rem"},{body:c(a=>[h(o(d,{icon:"pi pi-pencil",class:"p-detail",onClick:O=>U(a.data.id)},null,8,["onClick"]),[[v,"edit coupons"],[R,t(e)("edit"),void 0,{top:!0}]]),h(o(d,{icon:"pi pi-trash",class:"p-delete mx-2",onClick:O=>E(a.data.id)},null,8,["onClick"]),[[v,"delete coupons"],[R,t(e)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords","current-page-report-template"])),[[v,"list coupons"]])]),o(K,{visible:_.value,"onUpdate:visible":i[2]||(i[2]=a=>_.value=a),style:{width:"450px"},header:t(e)("coupon.deleteConfirmTitle"),modal:!0},{footer:c(()=>[o(d,{label:t(e)("no"),icon:"pi pi-times",class:"p-button-text",onClick:i[1]||(i[1]=a=>_.value=!1)},null,8,["label"]),o(d,{label:t(e)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:j},null,8,["label"])]),default:c(()=>[n("div",ye,[xe,n("span",null,p(t(e)("coupon.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}},ke=X(be,[["__scopeId","data-v-39daba6e"]]);export{ke as default};
