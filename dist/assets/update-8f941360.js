import{_ as G,u as H,k as J,A as K,j as Q,r as u,l as W,n as X,o as Y,a3 as T,P as Z,a as c,c as p,C as ee,f as t,t as d,e as r,B as C,h as m,v as g,x as B,w as te,F as ae,i as E}from"./index-2c0fa710.js";const oe={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},re={class:"text-3xl font-bold text-center mb-8 text-gray-800"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"space-y-2"},ne={for:"name_en",class:"block text-sm font-medium text-gray-700"},ie={class:"space-y-2"},de={for:"name_ar",class:"block text-sm font-medium text-gray-700"},ue={class:"space-y-2"},ce={for:"parent_id",class:"block text-sm font-medium text-gray-700"},pe={class:"space-y-2"},ge={for:"store_id",class:"block text-sm font-medium text-gray-700"},me={class:"space-y-2"},_e={class:"block text-sm font-medium text-gray-700"},ve={class:"flex items-center space-x-4"},be={class:"text-sm text-gray-600"},ye={class:"space-y-2"},fe={class:"block text-sm font-medium text-gray-700"},xe={class:"flex justify-center"},he={key:0,class:"p-4 w-full h-full"},we={class:"relative group w-full h-full"},ke=["src","alt"],De={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ve={key:1,class:"p-4 flex flex-col items-center justify-center"},je={class:"text-sm text-center text-gray-600"},Te={class:"text-blue-500 font-medium"},Ce={class:"space-y-2"},Ee={class:"block text-sm font-medium text-gray-700"},Ie={class:"flex justify-center"},Be={key:0,class:"p-4 w-full h-full"},Pe={class:"relative group w-full h-full"},$e=["src","alt"],Ue={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Se={key:1,class:"p-4 flex flex-col items-center justify-center"},Ae={class:"text-sm text-center text-gray-600"},Le={class:"text-blue-500 font-medium"},Fe={class:"space-y-2 md:col-span-2"},Me={class:"block text-sm font-medium text-gray-700"},Oe={class:"flex justify-center"},Re={key:0,class:"p-4 w-full h-full"},Ne={class:"relative group w-full h-full"},qe=["src","alt"],ze={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ge={key:1,class:"p-4 flex flex-col items-center justify-center"},He={class:"text-sm text-center text-gray-600"},Je={class:"text-blue-500 font-medium"},Ke={class:"pt-4 flex justify-center space-x-4"},Qe={key:0},We={key:1,class:"pi pi-spinner pi-spin"},Xe={__name:"update",setup(Ye){const P=H(),v=J(),x=K(),{t:a}=Q(),b=u(!1),$=W(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),s=u({name_en:"",name_ar:"",linked_to_market:!1,parent_id:null,store_id:null,image:null,banner_one_image:null,banner_two_image:null}),h=u(null),w=u(null),k=u(null),U=u([]),F=u([]),S=u([]),D=u(!1),V=u(!1),j=u(!1),A=async()=>{try{const o=s.value.linked_to_market?"/api/market":"/api/category",e=await E.get(o);U.value=e.data.data.data}catch(o){console.error("Error fetching parent categories:",o),x.add({severity:"error",summary:a("error"),detail:a("category.fetchParentError"),life:3e3})}},M=async()=>{try{const o=await E.get("/api/market");F.value=o.data.data.data}catch(o){console.error("Error fetching markets:",o)}},O=async()=>{try{const o=await E.get("/api/store");S.value=o.data.data.data}catch(o){console.error("Error fetching stores:",o),x.add({severity:"error",summary:a("error"),detail:a("category.fetchStoresError"),life:3e3})}},R=async o=>{try{const i=(await E.get(`/api/category/${o}`)).data.data;s.value={name_en:i.name_en||"",name_ar:i.name_ar||"",linked_to_market:!!i.linked_to_market,parent_id:i.parent_id||null,store_id:i.store_id||null,image:null,banner_one_image:null,banner_two_image:null},i.media.forEach(n=>{n.name==="category_image"?h.value=n.url:n.name==="banner_one_image"?w.value=n.url:n.name==="banner_two_image"&&(k.value=n.url)})}catch(e){console.error("Error fetching category data:",e),x.add({severity:"error",summary:a("error"),detail:a("category.fetchError"),life:3e3})}},N=(o,e)=>{const i=new FileReader;i.onload=n=>{switch(e){case"image":s.value.image=o,h.value=n.target.result,D.value=!1;break;case"banner_one":s.value.banner_one_image=o,w.value=n.target.result,V.value=!1;break;case"banner_two":s.value.banner_two_image=o,k.value=n.target.result,j.value=!1;break}},i.readAsDataURL(o)},y=(o,e)=>{var n,f,_;const i=((n=o.target.files)==null?void 0:n[0])||((_=(f=o.dataTransfer)==null?void 0:f.files)==null?void 0:_[0]);i&&i.type.match("image.*")&&N(i,e)},I=o=>{switch(o){case"image":s.value.image=null,h.value=null;break;case"banner_one":s.value.banner_one_image=null,w.value=null;break;case"banner_two":s.value.banner_two_image=null,k.value=null;break}},q=async()=>{var e,i;b.value=!0;const o=new FormData;o.append("name_en",s.value.name_en),o.append("name_ar",s.value.name_ar),o.append("linked_to_market",s.value.linked_to_market?"1":"0"),o.append("parent_id",s.value.parent_id||""),o.append("store_id",s.value.store_id||""),s.value.image&&o.append("image",s.value.image),s.value.banner_one_image&&o.append("banner_one_image",s.value.banner_one_image),s.value.banner_two_image&&o.append("banner_two_image",s.value.banner_two_image);try{const n=v.params.id,f="post",_=n?`/api/category/${n}`:"/api/category",L=await E[f](_,o);P.push({name:"category"}),x.add({severity:"success",summary:a("success"),detail:a(n?"category.updateSuccess":"category.createSuccess"),life:3e3})}catch(n){console.error("Error:",n),x.add({severity:"error",summary:a("error"),detail:((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.message)||(v.params.id?a("category.updateError"):a("category.createError")),life:3e3})}finally{b.value=!1}};return X(()=>s.value.linked_to_market,()=>{A(),s.value.parent_id=null}),Y(async()=>{await Promise.all([M(),A(),O()]);const o=v.params.id;o&&await R(o)}),(o,e)=>{const i=T("InputText"),n=T("Dropdown"),f=T("InputSwitch"),_=T("Button"),L=T("Toast"),z=Z("can");return c(),p(ae,null,[ee((c(),p("div",oe,[t("h1",re,d(r(v).params.id?r(a)("category.updateTitle"):r(a)("category.createTitle")),1),t("form",{onSubmit:g(q,["prevent"]),class:"space-y-6"},[t("div",se,[t("div",le,[t("label",ne,[C(d(r(a)("category.nameEn"))+" ",1),e[21]||(e[21]=t("span",{class:"text-red-500"},"*",-1))]),m(i,{id:"name_en",modelValue:s.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.name_en=l),placeholder:r(a)("category.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",ie,[t("label",de,[C(d(r(a)("category.nameAr"))+" ",1),e[22]||(e[22]=t("span",{class:"text-red-500"},"*",-1))]),m(i,{id:"name_ar",modelValue:s.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.name_ar=l),placeholder:r(a)("category.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",ue,[t("label",ce,d(r(a)("category.parent")),1),m(n,{filter:"",modelValue:s.value.parent_id,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.parent_id=l),options:U.value,optionLabel:$.value,optionValue:"id",placeholder:r(a)("category.selectParent"),class:"w-full"},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",pe,[t("label",ge,d(r(a)("category.store")),1),m(n,{filter:"",modelValue:s.value.store_id,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.store_id=l),options:S.value,optionLabel:$.value,optionValue:"id",placeholder:r(a)("category.selectStore"),class:"w-full"},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",me,[t("label",_e,d(r(a)("category.linkedToMarket")),1),t("div",ve,[m(f,{modelValue:s.value.linked_to_market,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.linked_to_market=l)},null,8,["modelValue"]),t("span",be,d(s.value.linked_to_market?r(a)("category.market"):r(a)("category.nonMarket")),1)])]),t("div",ye,[t("label",fe,d(r(a)("category.image")),1),t("div",xe,[t("label",{onDragover:e[7]||(e[7]=g(l=>D.value=!0,["prevent"])),onDragleave:e[8]||(e[8]=l=>D.value=!1),onDrop:e[9]||(e[9]=g(l=>y(l,"image"),["prevent"])),class:B([{"border-blue-500 bg-blue-50":D.value,"border-gray-300":!D.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[5]||(e[5]=l=>y(l,"image")),accept:"image/*",class:"hidden"},null,32),h.value?(c(),p("div",he,[t("div",we,[t("img",{src:h.value,alt:r(a)("category.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,ke),t("div",De,[t("button",{type:"button",onClick:e[6]||(e[6]=g(l=>I("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[23]||(e[23]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Ve,[e[24]||(e[24]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",je,[t("span",Te,d(r(a)("category.clickToUpload")),1),C(" "+d(r(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Ce,[t("label",Ee,d(r(a)("category.bannerOne")),1),t("div",Ie,[t("label",{onDragover:e[12]||(e[12]=g(l=>V.value=!0,["prevent"])),onDragleave:e[13]||(e[13]=l=>V.value=!1),onDrop:e[14]||(e[14]=g(l=>y(l,"banner_one"),["prevent"])),class:B([{"border-blue-500 bg-blue-50":V.value,"border-gray-300":!V.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[10]||(e[10]=l=>y(l,"banner_one")),accept:"image/*",class:"hidden"},null,32),w.value?(c(),p("div",Be,[t("div",Pe,[t("img",{src:w.value,alt:r(a)("category.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,$e),t("div",Ue,[t("button",{type:"button",onClick:e[11]||(e[11]=g(l=>I("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[25]||(e[25]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Se,[e[26]||(e[26]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Ae,[t("span",Le,d(r(a)("category.clickToUpload")),1),C(" "+d(r(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Fe,[t("label",Me,d(r(a)("category.bannerTwo")),1),t("div",Oe,[t("label",{onDragover:e[17]||(e[17]=g(l=>j.value=!0,["prevent"])),onDragleave:e[18]||(e[18]=l=>j.value=!1),onDrop:e[19]||(e[19]=g(l=>y(l,"banner_two"),["prevent"])),class:B([{"border-blue-500 bg-blue-50":j.value,"border-gray-300":!j.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[15]||(e[15]=l=>y(l,"banner_two")),accept:"image/*",class:"hidden"},null,32),k.value?(c(),p("div",Re,[t("div",Ne,[t("img",{src:k.value,alt:r(a)("category.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,qe),t("div",ze,[t("button",{type:"button",onClick:e[16]||(e[16]=g(l=>I("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[27]||(e[27]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Ge,[e[28]||(e[28]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",He,[t("span",Je,d(r(a)("category.clickToUpload")),1),C(" "+d(r(a)("category.orDragAndDrop")),1)])]))],34)])])]),t("div",Ke,[m(_,{type:"button",label:r(a)("cancel"),icon:"pi pi-times",onClick:e[20]||(e[20]=l=>r(P).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:b.value},null,8,["label","disabled"]),m(_,{type:"submit",label:r(v).params.id?r(a)("category.updateButton"):r(a)("category.createButton"),icon:"pi pi-plus",loading:b.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:b.value},{default:te(()=>[b.value?(c(),p("i",We)):(c(),p("span",Qe,d(r(v).params.id?r(a)("category.updateButton"):r(a)("category.createButton")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[z,"create categories"]]),m(L)],64)}}},et=G(Xe,[["__scopeId","data-v-6ccaa507"]]);export{et as default};
