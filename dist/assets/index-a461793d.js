import{u as he,M as _e,j as ye,r as s,n as ee,o as xe,a3 as E,P as te,a as m,c as f,f as r,h as n,w as c,e as a,A as k,b as we,t as d,F as ae,d as ke,i as C,R as Ce,a1 as T,Z as De,N as Pe,$ as h,O as I,a4 as $e,x as Se,g as le,a5 as Ve}from"./index-9a99efb8.js";const Ee={class:"grid"},Ue={class:"col-12"},Fe={class:"card p-4 shadow-2 border-round"},Re={class:"text-2xl font-bold"},Le={class:"flex gap-2 align-items-center"},Be={class:"p-input-icon-left"},Ne={class:"card shadow-1 surface-0"},Te={class:"text-center py-4"},Ie={class:"text-xl"},je={class:"flex justify-content-center align-items-center py-4"},Ae={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},ze={class:"p-paginator-left-content"},Me={class:"p-paginator-current"},Ke={class:"p-paginator-right-content"},Oe=["disabled"],Qe=["disabled"],qe=["onClick"],Ge={key:1,class:"p-paginator-dots"},We=["disabled"],Ze=["disabled"],He={class:"flex align-items-center justify-content-center"},Je={class:"flex flex-column gap-3"},Xe={key:0,class:"mt-2"},Ye={class:"font-semibold"},lt={__name:"index",setup(et){const j=he(),u=_e(),{t}=ye(),D=s(!0),A=s([]),_=s(!1),z=s(null),M=s(null),oe=s({}),P=s("");s(null);const y=s(!1),v=s(null),U=s(!1),K=s([]),O=s([]),$=s(null),S=s(null),Q=s(""),F=s(localStorage.getItem("appLang")||"en"),p=s(1),R=s(0),g=s(10),V=s(0),se=s(""),re=s(""),q=s(""),G=s(""),W=s(0),Z=s(0),H=s([]),L=async()=>{try{const l=await C.get("/api/category",{params:{search:Q.value||void 0}}),e=F.value;K.value=l.data.data.data.map(i=>({label:e==="en"?`${i.name_en} `:`${i.name_ar} `,value:i.id}))}catch(l){u.add({severity:"error",summary:t("error"),detail:t("category.loadError"),life:3e3}),console.error("Error fetching categories:",l)}},J=async()=>{try{const l=await C.get("/api/store"),e=F.value;O.value=l.data.data.data.map(i=>({label:e==="en"?`${i.name_en} `:`${i.name_ar} `,value:i.id}))}catch(l){u.add({severity:"error",summary:t("error"),detail:t("store.loadError"),life:3e3}),console.error("Error fetching stores:",l)}},b=()=>{D.value=!0,C.get("/api/product",{params:{page:p.value,limit:g.value,search:P.value||void 0,category_id:$.value||void 0,store_id:S.value||void 0}}).then(l=>{A.value=l.data.data.data,R.value=l.data.data.total,V.value=l.data.data.last_page,se.value=l.data.data.first_page_url,re.value=l.data.data.last_page_url,q.value=l.data.data.next_page_url,G.value=l.data.data.prev_page_url,W.value=l.data.data.from,Z.value=l.data.data.to,H.value=l.data.data.links,D.value=!1}).catch(l=>{u.add({severity:"error",summary:t("error"),detail:t("product.loadError"),life:3e3}),D.value=!1,console.error("Error fetching products:",l)})};ee([P,g,$,S],()=>{p.value=1,b()}),ee(F,()=>{L(),J()});const ne=l=>{Q.value=l.value,L()},x=l=>{l>=1&&l<=V.value&&(p.value=l,b())},ie=l=>{g.value=l.value,p.value=1,b()},de=l=>{z.value=l,_.value=!0},ce=()=>{C.delete(`/api/product/${z.value}`).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.deleteSuccess"),life:3e3}),b(),_.value=!1}).catch(l=>{u.add({severity:"error",summary:t("error"),detail:t("product.deleteError"),life:3e3}),console.error("Error deleting product:",l)})},ue=()=>{M.value.exportCSV()},pe=()=>{const l=`store_id,category_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,Demo Product 1,منتج تجريبي 1,SKU001,1,Sub Demo 1,تجريبي فرعي 1,Description of Demo Product 1,وصف المنتج التجريبي 1,15.50,10.00,0.05
2,2,Demo Product 2,منتج تجريبي 2,SKU002,2,Sub Demo 2,تجريبي فرعي 2,Description of Demo Product 2,وصف المنتج التجريبي 2,22.00,15.00,0.05`,e=new Blob([l],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(i.download!==void 0){const B=URL.createObjectURL(e);i.setAttribute("href",B),i.setAttribute("download","product_import_example.csv"),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}},ve=l=>{v.value=l.files[0]},me=()=>{if(!v.value){u.add({severity:"error",summary:t("error"),detail:t("validation.fileRequired"),life:3e3});return}U.value=!0;const l=new FormData;l.append("file",v.value),C.post("/api/import/products",l).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.importSuccess"),life:3e3}),b(),y.value=!1,v.value=null}).catch(e=>{u.add({severity:"error",summary:t("error"),detail:t("product.importError"),life:3e3}),console.error("Error importing products:",e)}).finally(()=>{U.value=!1})},ge=()=>{j.push({name:"product-create"})},be=l=>{j.push({name:"product-update",params:{id:l}})};return xe(()=>{Promise.all([L(),J(),b()])}),(l,e)=>{const i=E("Button"),B=E("ProgressSpinner"),fe=E("DataTable"),X=E("Dialog"),w=te("can"),Y=te("tooltip");return m(),f("div",Ee,[r("div",Ue,[r("div",Fe,[n(a(De),{class:"mb-4"},{start:c(()=>[r("h2",Re,d(a(t)("product.managementTitle")),1)]),end:c(()=>[r("div",Le,[r("span",Be,[e[13]||(e[13]=r("i",{class:"pi pi-search"},null,-1)),n(a(Ce),{modelValue:P.value,"onUpdate:modelValue":e[0]||(e[0]=o=>P.value=o),placeholder:a(t)("product.search")},null,8,["modelValue","placeholder"])]),n(a(T),{modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=o=>$.value=o),options:K.value,optionLabel:"label",optionValue:"value",placeholder:a(t)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search categories",onFilter:ne},null,8,["modelValue","options","placeholder"]),n(a(T),{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=o=>S.value=o),options:O.value,optionLabel:"label",optionValue:"value",placeholder:a(t)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),n(i,{label:a(t)("product.import"),icon:"pi pi-download",class:"p-import",onClick:e[3]||(e[3]=o=>y.value=!0)},null,8,["label"]),k(n(i,{label:a(t)("product.export"),icon:"pi pi-upload",class:"p-export",onClick:ue},null,8,["label"]),[[w,"list products"]]),k(n(i,{label:a(t)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:ge},null,8,["label"]),[[w,"create products"]])])]),_:1}),n(a(Pe)),r("div",Ne,[k((m(),we(fe,{ref_key:"dt",ref:M,value:A.value,loading:D.value,"data-key":"id",paginator:!1,rows:g.value,filters:oe.value,totalRecords:R.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[r("div",Te,[e[14]||(e[14]=r("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),r("p",Ie,d(a(t)("product.noData")),1)])]),loading:c(()=>[r("div",je,[n(B,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:c(()=>[n(a(h),{"selection-mode":"multiple","header-style":"width: 3rem"}),n(a(h),{field:"name_ar",header:a(t)("product.nameAr"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(o=>[I(d(o.data.name_ar),1)]),_:1},8,["header"]),n(a(h),{field:"name_en",header:a(t)("product.nameEn"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(o=>[I(d(o.data.name_en),1)]),_:1},8,["header"]),n(a(h),{field:"base_price",header:a(t)("product.basePrice"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(o=>[I(d(o.data.base_price),1)]),_:1},8,["header"]),n(a(h),{field:"is_displayed",header:a(t)("product.isDisplayed"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(o=>[n(a($e),{value:o.data.is_displayed?a(t)("yes"):a(t)("no"),severity:o.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),n(a(h),{header:a(t)("actions"),"header-style":"width: 12rem"},{body:c(o=>[k(n(i,{icon:"pi pi-pencil",class:"p-detail",onClick:N=>be(o.data.id)},null,8,["onClick"]),[[w,"edit products"],[Y,a(t)("edit"),void 0,{top:!0}]]),k(n(i,{icon:"pi pi-trash mx-2",class:"p-delete",onClick:N=>de(o.data.id)},null,8,["onClick"]),[[w,"delete products"],[Y,a(t)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[w,"list products"]]),r("div",Ae,[r("div",ze,[r("span",Me,d(a(t)("show"))+" "+d(W.value)+" "+d(a(t)("to"))+" "+d(Z.value)+" "+d(a(t)("from"))+" "+d(R.value),1)]),r("div",Ke,[r("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:e[4]||(e[4]=o=>x(1))},e[15]||(e[15]=[r("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Oe),r("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!G.value,onClick:e[5]||(e[5]=o=>x(p.value-1))},e[16]||(e[16]=[r("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Qe),(m(!0),f(ae,null,ke(H.value,(o,N)=>(m(),f(ae,{key:N},[o.label&&!isNaN(parseInt(o.label))?(m(),f("button",{key:0,class:Se(["p-paginator-page p-paginator-element p-link",{"p-highlight":o.active}]),onClick:tt=>x(parseInt(o.label))},d(o.label),11,qe)):o.label==="..."?(m(),f("span",Ge,"...")):le("",!0)],64))),128)),r("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!q.value,onClick:e[6]||(e[6]=o=>x(p.value+1))},e[17]||(e[17]=[r("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,We),r("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===V.value,onClick:e[7]||(e[7]=o=>x(V.value))},e[18]||(e[18]=[r("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Ze),n(a(T),{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=o=>g.value=o),options:[5,10,20,30],onChange:ie,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),n(X,{visible:_.value,"onUpdate:visible":e[10]||(e[10]=o=>_.value=o),style:{width:"450px"},header:a(t)("product.deleteConfirmTitle"),modal:!0},{footer:c(()=>[n(i,{label:a(t)("no"),icon:"pi pi-times",class:"p-button-text",onClick:e[9]||(e[9]=o=>_.value=!1)},null,8,["label"]),n(i,{label:a(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:ce},null,8,["label"])]),default:c(()=>[r("div",He,[e[19]||(e[19]=r("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),r("span",null,d(a(t)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),n(X,{visible:y.value,"onUpdate:visible":e[12]||(e[12]=o=>y.value=o),style:{width:"450px"},header:a(t)("product.importTitle"),modal:!0},{footer:c(()=>[n(i,{label:a(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:e[11]||(e[11]=o=>y.value=!1)},null,8,["label"]),n(i,{label:a(t)("product.importButton"),icon:"pi pi-check",loading:U.value,disabled:!v.value,onClick:me},null,8,["label","loading","disabled"])]),default:c(()=>[r("div",Je,[n(i,{label:a(t)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:pe},null,8,["label"]),n(a(Ve),{mode:"basic","custom-upload":!0,onSelect:ve,maxFileSize:1e7,chooseLabel:"Select File"}),v.value?(m(),f("div",Xe,[r("p",Ye,d(a(t)("selectedFile"))+": "+d(v.value.name),1)])):le("",!0)])]),_:1},8,["visible","header"])])])])}}};export{lt as default};
