import{_ as J,k as K,u as Q,j as U,r as u,m as W,n as X,a as o,c as g,f as r,t as x,e as y,h as E,w as D,g as v,b as w,F as M,d as Y,i as k}from"./index-e48ba634.js";import{b as F,S as Z,A as ee,a as ae}from"./productsSwiper-6e79cbb8.js";import{N as te}from"./navigation-c4bae44c.js";import{d as p}from"./banner-addtion-e4104052.js";import{C as se}from"./CustomTaps-c63a8096.js";const re={class:"mx-auto bg-gradient-to mt-16 max-w-7xl px-4 sm:px-6 lg:px-8"},le={key:0,class:"py-16"},ne={class:"flex flex-col items-center justify-center space-y-4"},oe={class:"text-indigo-600 text-xl font-semibold animate-pulse"},ie={key:1,class:"text-center py-16 text-red-600"},de={class:"text-lg font-semibold"},ce={key:2},ue={class:"text-center mb-2"},me={class:"text-4xl sm:text-4xl font-extrabold text-gray-800 tracking-tight animate-fade-in"},ge={key:0},_e={class:"w-full h-48 overflow-hidden rounded-xl shadow-md relative"},ve=["src","alt"],pe={class:"font-sans mt-4 mb-1 text-gray-800 font-semibold text-sm sm:text-base md:text-lg"},fe={key:1,class:"my-8"},ye={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},be=["src","alt"],he={key:2,class:"my-8"},xe={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},we=["src","alt"],ke={__name:"SubCategory",setup(Fe){const $=K(),j=Q(),{t:i,locale:_}=U(),m=u(localStorage.getItem("defaultStoreId")),d=u({}),f=u([]),B=u({title:"",products:[]}),I=u([]),S=u({title:"",products:[]}),P=u({title:"",products:[]}),b=u({title:"",products:[]}),C=u(!1),c=u(null),h=a=>_.value==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar,L=a=>_.value==="ar"?"منتجات "+(a.name_ar||a.name_en):"Products "+(a.name_en||a.name_ar),O=a=>{a.has_subcategories>0?j.push({name:"subcategory",params:{id:a.id}}):j.push({name:"produts_category",params:{id:a.id}})},z=async()=>{try{const t=(await k.get(`/api/home/products-by-category/${$.params.id}/${m.value}`)).data.data;d.value={id:t.category.id,name_ar:t.category.name_ar,name_en:t.category.name_en,media:t.category.media||[{url:p,name:"default"}]},f.value=t.sub_categories.map(e=>({id:e.id,name_ar:e.name_ar||e.name_en,name_en:e.name_en||e.name_ar,media:e.media.length?e.media:[{url:p,name:"default"}]})),B.value={title:L(d.value),products:(t.products.data||[]).map(e=>{var n,s;return{id:e.id,name:_.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((s=(n=e.media)==null?void 0:n.find(l=>l.name==="product_main_image"))==null?void 0:s.url)||e.key_default_image||p}})}}catch(a){console.error("Error fetching category data:",a),c.value=i("category.errorLoading")||"Failed to load category data."}},R=async()=>{try{const a=f.value.map(async e=>((await k.get(`/api/home/products-by-category/${e.id}/${m.value}`)).data.data.products.data||[]).map(l=>{var V,A;return{id:l.id,name:_.value==="ar"?l.name_ar||l.name_en:l.name_en||l.name_ar,tax:l.tax||0,price:parseFloat(l.base_price||0).toFixed(2),img:((A=(V=l.media)==null?void 0:V.find(H=>H.name==="product_main_image"))==null?void 0:A.url)||l.key_default_image||p}})),t=await Promise.allSettled(a);I.value=t.filter(e=>e.status==="fulfilled").flatMap(e=>e.value)}catch(a){console.error("Error fetching subcategory products:",a),c.value=i("category.errorLoading")||"Failed to load subcategory products."}},T=async()=>{try{const t=(await k.get(`/api/home/best-sellers/${m.value}`)).data.data.data||[];S.value={title:i("category.bestsellers")||"Best Sellers",products:t.map(e=>{var n,s;return{id:e.id,name:_.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((s=(n=e.media)==null?void 0:n.find(l=>l.name==="product_main_image"))==null?void 0:s.url)||e.key_default_image||p}})}}catch(a){console.error("Error fetching best sellers:",a),c.value=i("category.errorLoading")||"Failed to load best sellers."}},q=async()=>{try{const t=(await k.get(`/api/home/new-arrivals/${m.value}`)).data.data.data||[];P.value={title:i("category.newlyarrived")||"New Arrivals",products:t.map(e=>{var n,s;return{id:e.id,name:_.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((s=(n=e.media)==null?void 0:n.find(l=>l.name==="product_main_image"))==null?void 0:s.url)||e.key_default_image||p}})}}catch(a){console.error("Error fetching new arrivals:",a),c.value=i("category.errorLoading")||"Failed to load new arrivals."}},G=async()=>{try{const t=(await k.get(`/api/home/exclusive-offers/${m.value}`)).data.data||[];b.value={title:i("category.exclusive")||"Exclusive Offers",products:t.map(e=>{var n,s;return{id:e.id,name:_.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((s=(n=e.media)==null?void 0:n.find(l=>l.name==="product_main_image"))==null?void 0:s.url)||e.key_default_image||p}})}}catch(a){console.error("Error fetching exclusive offers:",a),c.value=i("category.errorLoading")||"Failed to load exclusive offers."}},N=async()=>{C.value=!0,c.value=null,await Promise.allSettled([z(),T(),q(),G()]),f.value.length&&await R(),C.value=!1};return W(()=>{$.params.id&&m.value?N():c.value=i("category.missingParams")||"Missing category or store ID."}),X(()=>$.params.id,(a,t)=>{a!==t&&a&&m.value?N():(!a||!m.value)&&(c.value=i("category.missingParams")||"Missing category or store ID.")}),(a,t)=>{var e,n;return o(),g(M,null,[r("div",re,[C.value?(o(),g("div",le,[r("div",ne,[t[0]||(t[0]=r("div",{class:"relative w-24 h-24"},[r("div",{class:"absolute inset-0 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin"}),r("div",{class:"absolute inset-4 rounded-full border-4 border-pink-500 border-b-transparent animate-spin animation-delay-200"}),r("div",{class:"absolute inset-8 rounded-full border-4 border-purple-500 border-l-transparent animate-spin animation-delay-400"})],-1)),r("p",oe,x(y(i)("category.loading")),1),t[1]||(t[1]=r("div",{class:"w-1/2 h-2 bg-gray-200 rounded-full overflow-hidden"},[r("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-pink-500 animate-progress"})],-1))])])):c.value?(o(),g("div",ie,[r("p",de,x(c.value),1),r("button",{onClick:N,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},x(y(i)("category.retry")),1)])):(o(),g("div",ce,[r("div",ue,[r("h1",me,x(h(d.value)),1)]),f.value.length>=1?(o(),g("div",ge,[t[3]||(t[3]=r("h2",{class:"font-bold font-sans text-gray-800 text-2xl sm:text-3xl lg:text-4xl mb-8 animate-slide-up"},null,-1)),E(y(ae),{modules:[y(ee),y(te)],"slides-per-view":3,"space-between":20,loop:f.value.length>3,autoplay:{delay:3e3,disableOnInteraction:!1},speed:1e3,"grab-cursor":!0,navigation:!1,class:"mt-6",breakpoints:{320:{slidesPerView:1,spaceBetween:8},640:{slidesPerView:2,spaceBetween:12},768:{slidesPerView:2,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:20}}},{default:D(()=>[(o(!0),g(M,null,Y(f.value,s=>(o(),w(y(Z),{key:s.id,class:"group flex flex-col items-center cursor-pointer transition-all duration-300 hover:-translate-y-2",onClick:l=>O(s)},{default:D(()=>{var l;return[r("div",_e,[r("img",{src:(l=s.media[0])==null?void 0:l.url,alt:`${h(s)} image`,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,ve),t[2]||(t[2]=r("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1))]),r("h3",pe,x(h(s)),1)]}),_:2},1032,["onClick"]))),128))]),_:1},8,["modules","loop"])])):v("",!0),(e=d.value.media)!=null&&e.find(s=>s.name==="banner_one_image")?(o(),g("div",fe,[r("div",ye,[r("img",{src:d.value.media.find(s=>s.name==="banner_one_image").url,alt:`${h(d.value)} banner one`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,be),t[4]||(t[4]=r("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center p-6"},null,-1))])])):v("",!0),r("section",null,[B.value.products.length?(o(),w(F,{key:0,products:B.value,title:L(d.value)},null,8,["products","title"])):v("",!0),E(F,{products:I.value,title:b.value.title},null,8,["products","title"]),b.value.products.length?(o(),w(F,{key:1,products:b.value,title:b.value.title},null,8,["products","title"])):v("",!0),S.value.products.length?(o(),w(F,{key:2,products:S.value,title:S.value.title},null,8,["products","title"])):v("",!0),P.value.products.length?(o(),w(F,{key:3,products:P.value,title:P.value.title},null,8,["products","title"])):v("",!0)]),(n=d.value.media)!=null&&n.find(s=>s.name==="banner_two_image")?(o(),g("div",he,[r("div",xe,[r("img",{src:d.value.media.find(s=>s.name==="banner_two_image").url,alt:`${h(d.value)} banner two`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,we),t[5]||(t[5]=r("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/50 flex items-center justify-center p-6"},null,-1))])])):v("",!0)]))]),E(se)],64)}}},Ne=J(ke,[["__scopeId","data-v-1155313b"]]);export{Ne as default};
