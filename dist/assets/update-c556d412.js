import{p as T,s as q,u as L,r,H as j,o as z,z as H,B as g,e as n,f as a,h as e,t as c,j as $,I as J,F as _,k as C,J as K,n as U,b as D,K as G,E as O,G as Q,m as W}from"./index-d6624249.js";const I=m=>(O("data-v-44766cd8"),m=m(),Q(),m),X={class:"permission-manager"},Y={class:"controls"},Z={class:"name-input"},N=I(()=>e("label",{for:"roleName"},[W(" Role Name "),e("span",{class:"required"},"*")],-1)),ee={key:0,class:"loading"},te={key:0,class:"table-view"},se=I(()=>e("thead",null,[e("tr",null,[e("th",null,"Group"),e("th",null,"Permission"),e("th",null,"Description"),e("th",null,"Select")])],-1)),le=["rowspan"],oe=["id","checked",".indeterminate","onChange"],ne=["for"],ae=["onClick","disabled"],ie=["id","value"],de={key:1,class:"card-view"},ce={class:"permission-groups"},re={class:"group-header"},ue=["id","checked",".indeterminate","onChange"],ve=["for"],pe={class:"permission-items"},he={class:"permission-info"},_e=["id","value"],me=["for"],be=["onClick","disabled"],fe=["disabled"],ke={class:"modal-content"},ye=I(()=>e("h3",null,"Permission Description",-1)),ge={setup(m){const M=q(),w=L(),v=r({}),x=r(null),b=r(!0),i=r([]),p=r(""),f=r(!1),S=r(""),k=r(!1),y=j(()=>w.params.id),B=()=>{D.get("api/role/get/permissions").then(d=>{v.value=d.data.data,y.value?A():b.value=!1})},A=()=>{D.get(`api/role/${w.params.id}`).then(d=>{x.value=d.data.data,p.value=x.value.name,i.value=x.value.permissions.map(t=>t.id),b.value=!1}).catch(()=>{b.value=!1})},V=(d,t)=>{const o=(v.value[d]||[]).map(s=>s.id);t.target.checked?i.value=[...new Set([...i.value,...o])]:i.value=i.value.filter(s=>!o.includes(s))},P=d=>{const t=v.value[d]||[];return t.length===0?!1:t.every(h=>i.value.includes(h.id))},E=d=>{const t=v.value[d]||[];if(t.length===0)return!1;const h=t.some(s=>i.value.includes(s.id)),o=t.every(s=>i.value.includes(s.id));return h&&!o},R=d=>{S.value=d||"No description available",f.value=!0},F=()=>{if(!p.value){alert("Please enter a role name");return}const d={name:p.value,permissions:i.value};D.put(`/api/role/${w.params.id}`,d).then(t=>{M.push({name:"roles"})}).catch(t=>{console.error("Error:",t)})};return z(()=>{B()}),(d,t)=>{const h=H("can");return g((n(),a("div",X,[e("h1",null,c($(y)?"Edit":"Create")+" Role Permissions",1),e("div",Y,[e("div",Z,[N,g(e("input",{type:"text",id:"roleName","onUpdate:modelValue":t[0]||(t[0]=o=>p.value=o),placeholder:"Enter role name",required:""},null,512),[[J,p.value]])]),e("button",{onClick:t[1]||(t[1]=o=>k.value=!k.value),class:"view-toggle"},c(k.value?"Switch to Card View":"Switch to Table View"),1)]),b.value?(n(),a("div",ee,"Loading "+c($(y)?"role data":"permissions")+"...",1)):(n(),a(_,{key:1},[k.value?(n(),a("div",te,[e("table",null,[se,e("tbody",null,[(n(!0),a(_,null,C(v.value,(o,s)=>(n(),a(_,{key:s},[(n(!0),a(_,null,C(o,l=>(n(),a("tr",{key:l.id},[o.indexOf(l)===0?(n(),a("td",{key:0,rowspan:o.length},[e("input",{type:"checkbox",id:`group-${s}-table`,checked:P(s),".indeterminate":E(s),onChange:u=>V(s,u)},null,40,oe),e("label",{for:`group-${s}-table`},c(s.charAt(0).toUpperCase()+s.slice(1)),9,ne)],8,le)):U("",!0),e("td",null,c(l.name),1),e("td",null,[e("button",{onClick:u=>R(l.description),class:"description-btn",disabled:!l.description},c(l.description?"View":"None"),9,ae)]),e("td",null,[g(e("input",{type:"checkbox",id:`permission-${l.id}-table`,value:l.id,"onUpdate:modelValue":t[2]||(t[2]=u=>i.value=u)},null,8,ie),[[G,i.value]])])]))),128))],64))),128))])])])):(n(),a("div",de,[e("div",ce,[(n(!0),a(_,null,C(v.value,(o,s)=>(n(),a("div",{key:s,class:"permission-group"},[e("div",re,[e("input",{type:"checkbox",id:`group-${s}`,checked:P(s),".indeterminate":E(s),onChange:l=>V(s,l)},null,40,ue),e("label",{for:`group-${s}`},c(s.charAt(0).toUpperCase()+s.slice(1)),9,ve)]),e("div",pe,[(n(!0),a(_,null,C(o,l=>(n(),a("div",{key:l.id,class:"permission-item"},[e("div",he,[g(e("input",{type:"checkbox",id:`permission-${l.id}`,value:l.id,"onUpdate:modelValue":t[3]||(t[3]=u=>i.value=u)},null,8,_e),[[G,i.value]]),e("label",{for:`permission-${l.id}`},c(l.name),9,me)]),e("button",{onClick:u=>R(l.description),class:"description-btn",disabled:!l.description},c(l.description?"View Description":"No Description"),9,be)]))),128))])]))),128))])]))],64)),e("button",{onClick:F,class:"submit-btn",disabled:i.value.length===0||!p.value},c($(y)?"Update":"Create")+" Role with Selected Permissions ",9,fe),f.value?(n(),a("div",{key:2,class:"modal-overlay",onClick:t[5]||(t[5]=K(o=>f.value=!1,["self"]))},[e("div",ke,[ye,e("p",null,c(S.value),1),e("button",{onClick:t[4]||(t[4]=o=>f.value=!1),class:"close-modal"},"Close")])])):U("",!0)])),[[h,"edit roles"]])}}},we=T(ge,[["__scopeId","data-v-44766cd8"]]);export{we as default};
