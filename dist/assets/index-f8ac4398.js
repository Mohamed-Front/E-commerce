import{_ as de,u as ce,A as ue,j as pe,r as i,n as ve,o as ge,P as me,a as y,c as f,f as s,h as r,w as d,e as a,t as n,F as O,d as be,i as C,R as ye,a1 as z,T as u,Z as fe,O as he,E as _e,$ as h,B as L,C as M,a0 as xe,x as we,g as q,a2 as G,a5 as Ce}from"./index-eaab2c81.js";const ke={class:"grid"},$e={class:"col-12"},Ee={class:"card p-4 shadow-2 border-round"},Ue={class:"text-2xl font-bold"},Re={class:"flex gap-2"},Le={class:"p-input-icon-left"},Pe={class:"card shadow-1 surface-0"},Se={class:"text-center py-4"},De={class:"text-xl"},Ve={class:"flex justify-content-center align-items-center py-4"},Fe={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Ne={class:"p-paginator-left-content"},Ie={class:"p-paginator-current"},Te={class:"p-paginator-right-content"},je=["disabled"],Ae=["disabled"],Be=["onClick","aria-label"],Oe={key:1,class:"p-paginator-dots"},ze=["disabled"],Me=["disabled"],qe={class:"flex align-items-center justify-content-center"},Ge={class:"flex flex-column gap-3"},Qe={key:0,class:"mt-2"},We={class:"font-semibold"},Ze={__name:"index",setup(He){const V=ce(),v=ue(),{t:l}=pe(),k=i(!0),F=i([]),_=i(!1),P=i(null),Q=i(null),W=i({}),$=i("");i(null);const x=i(!1),g=i(null),E=i(!1),N=i([]),U=i(null),Z=i(localStorage.getItem("appLang")),p=i(1),S=i(0),m=i(10),R=i(0),H=i(""),J=i(""),I=i(""),T=i(""),j=i(0),A=i(0),B=i([]),K=i([{id:"شفت 7",arabic_name:"Shift7",english_name:"الأحذية",Top_Parent:"shift7"}]),X=()=>{C.get("/api/store").then(o=>{N.value=o.data.data.data}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("store.loadError"),life:3e3}),console.error("Error fetching stores:",o)})},b=()=>{var o;k.value=!0,C.get("/api/category",{params:{page:p.value,limit:m.value,search:$.value||void 0,store_id:((o=U.value)==null?void 0:o.id)||void 0}}).then(e=>{F.value=e.data.data.data,S.value=e.data.data.total,R.value=e.data.data.last_page,H.value=e.data.data.first_page_url,J.value=e.data.data.last_page_url,I.value=e.data.data.next_page_url,T.value=e.data.data.prev_page_url,j.value=e.data.data.from,A.value=e.data.data.to,B.value=e.data.data.links,p.value=e.data.data.current_page,k.value=!1}).catch(e=>{v.add({severity:"error",summary:l("error"),detail:l("category.loadError"),life:3e3}),k.value=!1,console.error("Error fetching categories:",e)})};ve([$,m,U],()=>{p.value=1,b()});const w=o=>{o>=1&&o<=R.value&&(p.value=o,b())},Y=o=>{m.value=o.value,p.value=1,b()},ee=o=>{P.value=o,_.value=!0},ae=()=>{C.delete(`/api/category/${P.value}`).then(()=>{v.add({severity:"success",summary:l("success"),detail:l("category.deleteSuccess"),life:3e3}),b(),_.value=!1,P.value=null}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("category.deleteError"),life:3e3}),console.error("Error deleting category:",o)})},te=()=>{C.get("/api/export/category",{responseType:"blob"}).then(o=>{const e=new Blob([o.data],{type:"text/csv"}),c=window.URL.createObjectURL(e),t=document.createElement("a");t.href=c,t.setAttribute("download","categories_export.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(c)}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("category.exportError"),life:3e3}),console.error("Error exporting categories:",o)})},le=()=>{const o=`id,Arabic Name,English Name,Top Parent / Store
`+K.value.map(t=>`"${t.id}","${t.arabic_name}","${t.english_name}","${t.Top_Parent}",`).join(`
`),e=new Blob([o],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");if(c.download!==void 0){const t=URL.createObjectURL(e);c.setAttribute("href",t),c.setAttribute("download","category_import_example.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(t)}},oe=()=>{x.value=!0,g.value=null},se=o=>{g.value=o.files[0]},ie=()=>{if(!g.value){v.add({severity:"warn",summary:l("warning"),detail:l("category.importNoFile"),life:3e3});return}E.value=!0;const o=new FormData;o.append("file",g.value),C.post("/api/import/store",o).then(()=>{v.add({severity:"success",summary:l("success"),detail:l("category.importSuccess"),life:3e3}),b(),x.value=!1,g.value=null;const e=document.querySelector('.p-fileupload input[type="file"]');e&&(e.value="")}).catch(e=>{v.add({severity:"error",summary:l("error"),detail:l("category.importError"),life:3e3}),console.error("Error importing categories:",e)}).finally(()=>{E.value=!1})},re=()=>{V.push({name:"category-create"})},ne=o=>{V.push({name:"category-update",params:{id:o}})};return ge(()=>{X(),b()}),(o,e)=>{const c=me("tooltip");return y(),f("div",ke,[s("div",$e,[s("div",Ee,[r(a(fe),{class:"mb-4"},{start:d(()=>[s("h2",Ue,n(a(l)("category.managementTitle")),1)]),end:d(()=>[s("div",Re,[s("span",Le,[e[11]||(e[11]=s("i",{class:"pi pi-search"},null,-1)),r(a(ye),{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=t=>$.value=t),placeholder:a(l)("category.search")},null,8,["modelValue","placeholder"])]),r(a(z),{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=t=>U.value=t),options:N.value,optionLabel:"name_en",placeholder:a(l)("category.selectStore"),class:"w-12rem",showClear:!0,"aria-label":"Filter by store"},null,8,["modelValue","options","placeholder"]),r(a(u),{label:a(l)("category.import"),icon:"pi pi-download",class:"exite",onClick:oe,"aria-label":"Import categories"},null,8,["label"]),r(a(u),{label:a(l)("category.export"),icon:"pi pi-upload",class:"exite",onClick:te,"aria-label":"Export categories"},null,8,["label"]),r(a(u),{label:a(l)("category.new"),icon:"pi pi-plus",class:"p-button-success",onClick:re,"aria-label":"Create new category"},null,8,["label"])])]),_:1}),r(a(he)),s("div",Pe,[r(a(xe),{ref_key:"dt",ref:Q,value:F.value,loading:k.value,"data-key":"id",paginator:!1,rows:m.value,filters:W.value,totalRecords:S.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[s("div",Se,[e[12]||(e[12]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",De,n(a(l)("category.noData")),1)])]),loading:d(()=>[s("div",Ve,[r(a(_e),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[r(a(h),{"selection-mode":"multiple","header-style":"width: 3rem"}),r(a(h),{field:"id",header:a(l)("id"),sortable:!0,"header-style":"width:5%; min-width:5rem;"},{body:d(t=>[L(n(t.data.id),1)]),_:1},8,["header"]),r(a(h),{field:"name_en",header:a(l)("category.nameEn"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>[L(n(t.data.name_en),1)]),_:1},8,["header"]),r(a(h),{field:"name_ar",header:a(l)("category.nameAr"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>[L(n(t.data.name_ar),1)]),_:1},8,["header"]),r(a(h),{field:"belongs_to",header:a(l)("category.store"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>[L(n(Z.value==="ar"?t.data.belongs_to_ar:t.data.belongs_to_en||a(l)("category.noStore")),1)]),_:1},8,["header"]),r(a(h),{header:a(l)("actions"),"header-style":"width:12rem;"},{body:d(t=>[M(r(a(u),{icon:"pi pi-pencil",class:"p-detail",onClick:D=>ne(t.data.id),"aria-label":"Edit category"},null,8,["onClick"]),[[c,a(l)("edit"),void 0,{top:!0}]]),M(r(a(u),{icon:"pi pi-trash",class:"p-delete",onClick:D=>ee(t.data.id),"aria-label":"Delete category"},null,8,["onClick"]),[[c,a(l)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"]),s("div",Fe,[s("div",Ne,[s("span",Ie,n(a(l)("show"))+" "+n(j.value)+" "+n(a(l)("to"))+" "+n(A.value)+" "+n(a(l)("from"))+" "+n(S.value),1)]),s("div",Te,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:e[2]||(e[2]=t=>w(1)),"aria-label":"First page"},e[13]||(e[13]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,je),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!T.value,onClick:e[3]||(e[3]=t=>w(p.value-1)),"aria-label":"Previous page"},e[14]||(e[14]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Ae),(y(!0),f(O,null,be(B.value,(t,D)=>(y(),f(O,{key:D},[t.label&&!isNaN(parseInt(t.label))?(y(),f("button",{key:0,class:we(["p-paginator-page p-paginator-element p-link",{"p-highlight":t.active}]),onClick:Je=>w(parseInt(t.label)),"aria-label":`Page ${t.label}`},n(t.label),11,Be)):t.label==="..."?(y(),f("span",Oe,"...")):q("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!I.value,onClick:e[4]||(e[4]=t=>w(p.value+1)),"aria-label":"Next page"},e[15]||(e[15]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,ze),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===R.value,onClick:e[5]||(e[5]=t=>w(R.value)),"aria-label":"Last page"},e[16]||(e[16]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Me),r(a(z),{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=t=>m.value=t),options:[5,10,20,30],onChange:Y,class:"ml-2",style:{width:"80px"},"aria-label":"Rows per page"},null,8,["modelValue"])])])]),r(a(G),{visible:_.value,"onUpdate:visible":e[8]||(e[8]=t=>_.value=t),style:{width:"450px"},header:a(l)("category.deleteConfirmTitle"),modal:!0},{footer:d(()=>[r(a(u),{label:a(l)("cancel"),icon:"pi pi-times",text:"",onClick:e[7]||(e[7]=t=>_.value=!1),"aria-label":"Cancel delete"},null,8,["label"]),r(a(u),{label:a(l)("yes"),icon:"pi pi-check",text:"",severity:"danger",onClick:ae,"aria-label":"Confirm delete"},null,8,["label"])]),default:d(()=>[s("div",qe,[e[17]||(e[17]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,n(a(l)("category.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),r(a(G),{visible:x.value,"onUpdate:visible":e[10]||(e[10]=t=>x.value=t),style:{width:"500px"},header:a(l)("category.importInstructions"),modal:!0},{footer:d(()=>[r(a(u),{label:a(l)("cancel"),icon:"pi pi-times",text:"",onClick:e[9]||(e[9]=t=>x.value=!1),"aria-label":"Cancel import"},null,8,["label"]),r(a(u),{label:a(l)("import"),icon:"pi pi-check",class:"p-button-success",onClick:ie,disabled:!g.value,loading:E.value,"aria-label":"Import categories"},null,8,["label","disabled","loading"])]),default:d(()=>[s("div",Ge,[s("div",null,[r(a(u),{label:a(l)("category.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:le,"aria-label":"Download example CSV"},null,8,["label"])]),r(a(Ce),{mode:"basic",name:"file",accept:".xlsx,.xls,.csv",maxFileSize:1e7,chooseLabel:a(l)("category.chooseFile"),onSelect:se,auto:!1,disabled:E.value,class:"mb-3"},null,8,["chooseLabel","disabled"]),g.value?(y(),f("div",Qe,[s("p",We,n(a(l)("selectedFile"))+": "+n(g.value.name),1)])):q("",!0)])]),_:1},8,["visible","header"])])])])}}},Xe=de(Ze,[["__scopeId","data-v-8140d34a"]]);export{Xe as default};
