import{_ as Y,k as Z,u as ee,G as ae,j as te,r as n,l as h,q as se,R as le,z as oe,a as L,c as C,f as s,t as v,e as r,p as b,h as m,y as _,D as re,a2 as V,S as q,U as O,Q as ne,i as f}from"./index-bd4d5038.js";const de=["dir"],ue={key:0,class:"flex justify-center items-center h-64"},ie={key:1},ce={class:"text-3xl font-bold text-center mb-8 text-gray-800"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe={class:"space-y-2"},ve={for:"belongs_to",class:"block text-sm font-medium text-gray-700"},be={class:"space-y-2"},_e={for:"type",class:"block text-sm font-medium text-gray-700"},ye={class:"space-y-2"},fe={for:"model_id",class:"block text-sm font-medium text-gray-700"},ge={class:"space-y-2"},xe={for:"row_type",class:"block text-sm font-medium text-gray-700"},we={class:"space-y-2"},he={for:"name_en",class:"block text-sm font-medium text-gray-700"},Ve={class:"space-y-2"},ke={for:"name_ar",class:"block text-sm font-medium text-gray-700"},Te={class:"pt-4 flex justify-center space-x-4"},Se={__name:"edit",setup(Fe){const Q=Z(),D=ee(),p=ae(),{t}=te(),a=n({id:null,belongs_to:null,model_id:null,name_en:"",name_ar:"",type:null,row_type:null}),j=n([{label:"Store",value:"store"},{label:"Category",value:"category"},{label:"Market",value:"market"}]),E=n([{label:"Categories",value:1},{label:"Products",value:2},{label:"Brand",value:3}]),I=n([{label:"Single Row",value:1},{label:"Double Rows",value:2}]),g=n([]),x=n([]),w=n([]),k=n(""),T=n(""),S=n(""),u=n(null),U=h(()=>localStorage.getItem("appLang")||"en"),N=h(()=>U.value==="en"?"name_en":"name_ar"),P=h(()=>U.value==="ar"),i=n(!1),y=n(!0),F=(l,e)=>{let c;return function(...o){clearTimeout(c),c=setTimeout(()=>l.apply(this,o),e)}},B=async()=>{try{const l=await f.get("/api/store",{params:{search:k.value||void 0}});g.value=l.data.data.data||l.data.data||[],u.value&&a.value.belongs_to==="store"&&!g.value.some(e=>e.id===u.value.id)&&g.value.push(u.value)}catch{p.add({severity:"error",summary:t("error"),detail:t("error.storeLoad"),life:3e3})}},M=async()=>{try{const l=await f.get("/api/category",{params:{search:T.value||void 0}});x.value=l.data.data.data||l.data.data||[],u.value&&a.value.belongs_to==="category"&&!x.value.some(e=>e.id===u.value.id)&&x.value.push(u.value)}catch{p.add({severity:"error",summary:t("error"),detail:t("error.categoryLoad"),life:3e3})}},R=async()=>{try{const l=await f.get("/api/market",{params:{search:S.value||void 0}});w.value=l.data.data.data||l.data.data||[],u.value&&a.value.belongs_to==="market"&&!w.value.some(e=>e.id===u.value.id)&&w.value.push(u.value)}catch{p.add({severity:"error",summary:t("error"),detail:t("error.marketLoad"),life:3e3})}},z=F(B,300),A=F(M,300),G=F(R,300),H=l=>{const e=l.value;a.value.belongs_to==="store"?(k.value=e,z()):a.value.belongs_to==="category"?(T.value=e,A()):a.value.belongs_to==="market"&&(S.value=e,G())},J=async l=>{var e,c,o;try{const d=(await f.get(`/api/custom-tabs/${l}`)).data.data;a.value={id:d.id,belongs_to:d.belongs_to,model_id:((e=d.model)==null?void 0:e.id)||null,name_en:d.name_en||"",name_ar:d.name_ar||"",type:d.type,row_type:d.row_type},d.model&&d.belongs_to&&(u.value={id:d.model.id,name_en:d.model.name_en,name_ar:d.model.name_ar}),await Promise.all([B(),M(),R()])}catch($){p.add({severity:"error",summary:t("error"),detail:((o=(c=$.response)==null?void 0:c.data)==null?void 0:o.message)||t("error.fetchCustomTab"),life:3e3}),D.push({name:"custom-tabs"})}finally{y.value=!1}},K=()=>{a.value.model_id=null,a.value.type=null,k.value="",T.value="",S.value=""},W=h(()=>{switch(a.value.belongs_to){case"store":return g.value;case"category":return x.value;case"market":return w.value;default:return[]}}),X=async()=>{var e,c;if(["belongs_to","model_id","name_en","name_ar","type","row_type"].some(o=>!a.value[o]&&a.value[o]!==0)){p.add({severity:"error",summary:t("error"),detail:t("validation.requiredFields"),life:3e3});return}i.value=!0;try{await f.put(`/api/custom-tabs/${a.value.id}`,a.value),p.add({severity:"success",summary:t("success"),detail:t("customTabs.updateSuccess"),life:3e3})}catch(o){p.add({severity:"error",summary:t("error"),detail:((c=(e=o.response)==null?void 0:e.data)==null?void 0:c.message)||t("error.updateError"),life:3e3})}finally{i.value=!1}};return se(()=>Q.params.id,l=>{l&&(y.value=!0,J(l))},{immediate:!0}),(l,e)=>{const c=le("can");return oe((L(),C("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:P.value?"rtl":"ltr"},[y.value?(L(),C("div",ue,e[7]||(e[7]=[s("i",{class:"pi pi-spin pi-spinner text-4xl text-gray-500"},null,-1)]))):(L(),C("div",ie,[s("h1",ce,v(r(t)("customTabs.updateTitle")),1),s("form",{onSubmit:re(X,["prevent"]),class:"space-y-6"},[s("div",me,[s("div",pe,[s("label",ve,[b(v(r(t)("customTabs.belongsTo"))+" ",1),e[8]||(e[8]=s("span",{class:"text-red-500"},"*",-1))]),m(r(V),{id:"belongs_to",modelValue:a.value.belongs_to,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.belongs_to=o),options:j.value,optionLabel:"label",optionValue:"value",class:_(["w-full",{"p-invalid":!a.value.belongs_to}]),onChange:K,disabled:i.value},null,8,["modelValue","options","class","disabled"])]),s("div",be,[s("label",_e,[b(v(r(t)("customTabs.type"))+" ",1),e[9]||(e[9]=s("span",{class:"text-red-500"},"*",-1))]),m(r(V),{id:"type",modelValue:a.value.type,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.type=o),options:E.value,optionLabel:"label",optionValue:"value",class:_(["w-full",{"p-invalid":!a.value.type&&a.value.type!==0}]),disabled:i.value},null,8,["modelValue","options","class","disabled"])]),s("div",ye,[s("label",fe,[b(v(r(t)("customTabs.modelId"))+" ",1),e[10]||(e[10]=s("span",{class:"text-red-500"},"*",-1))]),m(r(V),{id:"model_id",modelValue:a.value.model_id,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.model_id=o),options:W.value,optionLabel:N.value,optionValue:"id",class:_(["w-full",{"p-invalid":!a.value.model_id&&a.value.model_id!==0}]),disabled:!a.value.belongs_to||i.value,filter:"",filterPlaceholder:"Search",onFilter:H},null,8,["modelValue","options","optionLabel","class","disabled"])]),s("div",ge,[s("label",xe,[b(v(r(t)("customTabs.rowType"))+" ",1),e[11]||(e[11]=s("span",{class:"text-red-500"},"*",-1))]),m(r(V),{id:"row_type",modelValue:a.value.row_type,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.row_type=o),options:I.value,optionLabel:"label",optionValue:"value",class:_(["w-full",{"p-invalid":!a.value.row_type&&a.value.row_type!==0}]),disabled:i.value},null,8,["modelValue","options","class","disabled"])]),s("div",we,[s("label",he,[b(v(r(t)("customTabs.nameEn"))+" ",1),e[12]||(e[12]=s("span",{class:"text-red-500"},"*",-1))]),m(r(q),{id:"name_en",modelValue:a.value.name_en,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.name_en=o),class:_(["w-full",{"p-invalid":!a.value.name_en}]),disabled:i.value},null,8,["modelValue","class","disabled"])]),s("div",Ve,[s("label",ke,[b(v(r(t)("customTabs.nameAr"))+" ",1),e[13]||(e[13]=s("span",{class:"text-red-500"},"*",-1))]),m(r(q),{id:"name_ar",modelValue:a.value.name_ar,"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.name_ar=o),dir:"rtl",class:_(["w-full",{"p-invalid":!a.value.name_ar}]),disabled:i.value},null,8,["modelValue","class","disabled"])])]),s("div",Te,[m(r(O),{type:"button",label:r(t)("customTabs.cancelButton"),icon:"pi pi-times",onClick:e[6]||(e[6]=o=>r(D).push({name:"custom-tabs"})),class:"p-button-outlined p-button-secondary text-sm mx-2",disabled:i.value||y.value},null,8,["label","disabled"]),m(r(O),{type:"submit",label:r(t)("customTabs.updateButton"),icon:"pi pi-check",loading:i.value,class:"p-button-success text-sm mx-2",disabled:y.value},null,8,["label","loading","disabled"])])],32)])),m(r(ne))],8,de)),[[c,"update custom tabs"]])}}},Ce=Y(Se,[["__scopeId","data-v-082e3a78"]]);export{Ce as default};
