import{_ as ne,j as ie,k as ue,u as ce,v as de,G as ve,r as v,l as h,q as pe,o as _e,a as n,c as i,h as F,e as o,f as s,t as r,g as c,F as j,d as L,p as ge,x as H,y as me,A as he,i as B,H as fe,I as z,J as xe}from"./index-e8223ef4.js";import{P as ye}from"./ProductOffers-ff1b376a.js";const be={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},we={key:0,class:"text-center py-20"},ke={class:"mt-4 text-gray-600"},Oe={key:1,class:"text-red-500 text-center py-10 text-lg"},Se={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Ce={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},De={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},Fe=["src","alt","onClick"],Re={class:"w-full lg:w-3/4 order-1 lg:order-2"},Ve={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},qe={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},Ae={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},Be=["src","alt"],$e={class:"w-full lg:w-1/2"},Ee={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},Te={class:"flex flex-wrap gap-3 mb-6"},je={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},Le={key:0,class:"text-xl text-gray-600 mb-6"},ze={class:"flex items-center gap-3 mb-6"},Ie={class:"text-gray-600"},Me={class:"mb-8"},Ne={class:"flex items-baseline gap-4 flex-wrap"},Pe={class:"text-4xl font-bold text-gray-900"},Ue={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},Qe={key:1,class:"flex items-center gap-6 mb-8"},Ge={class:"font-bold text-gray-700 text-lg"},He={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden"},Je=["disabled"],We={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},Ke=["disabled"],Xe=["disabled"],Ye={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Ze={key:1},et={key:2},tt={key:3},st={key:2,class:"text-red-600 font-semibold text-center mt-4"},at={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},lt={class:"text-gray-700 leading-relaxed text-base"},ot={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},rt={class:"text-3xl font-bold text-center text-gray-800 mb-10"},nt={class:"grid md:grid-cols-3 gap-8"},it={class:"text-center"},ut={class:"text-6xl font-bold text-gray-800"},ct={class:"text-gray-500"},dt={class:"md:col-span-2"},vt={class:"w-4 text-sm font-bold"},pt={class:"flex-1 bg-gray-200 rounded-full h-3 relative overflow-hidden"},_t={class:"text-sm text-gray-600 w-12 text-right"},gt={class:"mt-12"},mt={class:"text-xl font-bold mb-6 text-center"},ht={key:0,class:"max-w-2xl mx-auto"},ft=["placeholder"],xt=["disabled"],yt={key:0,class:"text-red-500 text-center mt-3"},bt={key:1,class:"text-center py-8"},wt={class:"text-gray-600 mb-6"},kt={key:0,class:"mt-12 space-y-8"},Ot={class:"text-2xl font-bold text-gray-800"},St={class:"flex items-center justify-between mb-3"},Ct={class:"flex items-center gap-3"},Dt={class:"font-semibold"},Ft={class:"text-sm text-gray-500"},Rt={class:"text-gray-700 leading-relaxed"},Vt={key:1,class:"text-center py-12 text-gray-500"},qt={key:5,class:"mt-12"},At={__name:"product-details",setup(Bt){const{t:l,locale:f}=ie(),$=ue(),y=ce(),R=de(),k=ve(),e=v({}),E=v([]),O=v(""),x=v(1),b=v(!0),w=v(null),S=v(!1),C=v(!1),d=v([]),V=v(!1),q=v(!1),D=v(null),I=v(0),g=v({rating:0,comment:""});h(()=>{const a=parseFloat(e.value.price||0),t=parseFloat(e.value.total_discounts_value||0);return(a-t).toFixed(2)});const J=h(()=>parseFloat(e.value.total_discounts_value||0)>0);h(()=>{const a=parseFloat(e.value.price||0),t=parseFloat(e.value.total_discounts_value||0);return a?Math.round(t/a*100):0});const M=a=>parseFloat(a||0).toFixed(2),A=h(()=>f.value==="en"?e.value.description_en:e.value.description_ar||l("product.noDescription")),N=h(()=>A.value.length>300),W=h(()=>N.value?A.value.slice(0,300)+"...":A.value),P=h(()=>d.value.length?d.value.reduce((t,p)=>t+p.rate,0)/d.value.length:0),K=h(()=>{const a={5:0,4:0,3:0,2:0,1:0};return d.value.forEach(t=>a[t.rate]++),[5,4,3,2,1].map(t=>({stars:t,count:a[t],percentage:d.value.length?Math.round(a[t]/d.value.length*100):0}))}),X=h(()=>d.value.slice(0,5)),Y=a=>O.value=a,Z=()=>V.value=!V.value,ee=a=>a?new Date(a).toLocaleDateString(f.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}):"",te=async()=>{var a,t;if(!R.authenticatedweb)return y.push({name:"authlog"});if(!(e.value.isOutOfStock||S.value)){S.value=!0;try{await B.post("/api/cart/add",{product_id:e.value.id,variant_id:e.value.variant_id||null,quantity:1}),e.value.in_cart=!0,x.value=1,k.add({severity:"success",summary:l("success"),detail:l("cart.added"),life:3e3})}catch(p){k.add({severity:"error",detail:((t=(a=p.response)==null?void 0:a.data)==null?void 0:t.message)||l("cart.error"),life:3e3})}finally{S.value=!1}}},U=async a=>{if(!R.authenticatedweb)return y.push({name:"authlog"});if(C.value||e.value.isOutOfStock)return;const t=a==="plus"?x.value+1:x.value-1;if(!(t<1)){C.value=!0;try{await B.post("/api/cart/update",{product_id:e.value.id,variant_id:e.value.variant_id||null,quantity:t}),x.value=t,e.value.in_cart=!0,k.add({severity:"success",detail:l(a==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{k.add({severity:"error",detail:l("cart.quantityError"),life:3e3})}finally{C.value=!1}}},se=()=>{e.value.in_cart||te()},ae=async()=>{var a,t,p;if(g.value.rating===0||!g.value.comment.trim()){D.value=l("reviews.requiredFields");return}q.value=!0,D.value=null;try{const m={model_id:$.params.id,rate:g.value.rating,type:"product",message:g.value.comment.trim()},{data:_}=await B.post("/api/review",m);_.is_success&&(d.value.unshift({id:_.data.id,rate:g.value.rating,message:g.value.comment.trim(),user:{name:((a=R.user)==null?void 0:a.name)||l("reviews.anonymous")},created_at:new Date().toISOString()}),g.value={rating:0,comment:""},k.add({severity:"success",detail:l("reviews.submitSuccess"),life:3e3}))}catch(m){D.value=((p=(t=m.response)==null?void 0:t.data)==null?void 0:p.message)||l("reviews.submitError")}finally{q.value=!1}},le=a=>a&&y.push(a.has_subcategories?{name:"subcategory",params:{id:a.id}}:{name:"produts_category",params:{id:a.id}}),oe=a=>a&&y.push({name:"products-brand",params:{id:a.id}}),re=a=>a&&y.push(a.has_market?{name:"stores-hasmarket"}:{name:"home"}),Q=async()=>{var a,t,p;b.value=!0;try{const{data:m}=await B.get(`/api/home/product-details/${$.params.id}`);if(m.is_success){const _=m.data.product;e.value={..._,in_cart:_.in_cart||!1,isOutOfStock:_.is_stock===0},E.value=_.media||[],O.value=((a=E.value[0])==null?void 0:a.url)||e.value.key_default_image,d.value=_.reviews||[],x.value=e.value.in_cart&&_.quantity||1}}catch(m){w.value=((p=(t=m.response)==null?void 0:t.data)==null?void 0:p.message)||l("product.loadError")}finally{b.value=!1}};return pe(()=>$.params.id,a=>{a&&(Q(),window.scrollTo(0,0))},{immediate:!1}),_e(()=>{window.scrollTo(0,0),Q()}),(a,t)=>{var p,m,_,G;return n(),i("div",be,[b.value?(n(),i("div",we,[F(o(fe),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),s("p",ke,r(o(l)("loading")),1)])):c("",!0),w.value?(n(),i("div",Oe,r(w.value),1)):(n(),i("header",Se,[s("div",Ce,[s("div",De,[(n(!0),i(j,null,L(E.value,u=>(n(),i("img",{key:u.url,src:u.url,alt:o(l)("product.thumbnailAlt"),class:H(["h-20 w-20 object-cover rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":O.value===u.url,"border-gray-300 opacity-70":O.value!==u.url}]),onClick:T=>Y(u.url)},null,10,Fe))),128))]),s("div",Re,[s("div",Ve,[e.value.is_best_seller?(n(),i("div",qe," Best Seller ")):c("",!0),e.value.is_free_shipping?(n(),i("div",Ae,[t[8]||(t[8]=s("i",{class:"pi pi-truck"},null,-1)),ge(" "+r(o(l)("products.Free_Delivery")),1)])):c("",!0),s("img",{src:O.value||e.value.key_default_image,alt:o(f)==="en"?e.value.name_en:e.value.name_ar,class:"w-full h-full object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,Be)])])]),s("div",$e,[s("div",Ee,[s("section",Te,[e.value.store_id?(n(),i("span",{key:0,onClick:t[0]||(t[0]=u=>re(e.value.store)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?(p=e.value.store)==null?void 0:p.name_en:((m=e.value.store)==null?void 0:m.name_ar)||o(l)("store.default")),1)):c("",!0),e.value.category?(n(),i("span",{key:1,onClick:t[1]||(t[1]=u=>le(e.value.category)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?e.value.category.name_en:e.value.category.name_ar),1)):c("",!0),e.value.brand_id?(n(),i("span",{key:2,onClick:t[2]||(t[2]=u=>oe(e.value.brand)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?(_=e.value.brand)==null?void 0:_.name_en:((G=e.value.brand)==null?void 0:G.name_ar)||o(l)("brand.default")),1)):c("",!0)]),s("h1",je,r(o(f)==="en"?e.value.name_en:e.value.name_ar),1),e.value.sub_name_en||e.value.sub_name_ar?(n(),i("h2",Le,r(o(f)==="en"?e.value.sub_name_en:e.value.sub_name_ar),1)):c("",!0),s("div",ze,[F(o(z),{modelValue:P.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),s("span",Ie,"("+r(d.value.length)+" "+r(d.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural"))+")",1)]),t[10]||(t[10]=s("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),s("div",Me,[s("div",Ne,[s("span",Pe,r(M(e.value.base_price_after_discount))+" "+r(a.$t("currencyLabel")),1),J.value?(n(),i("span",Ue,r(M(e.value.base_price))+" "+r(a.$t("currencyLabel")),1)):c("",!0)])]),e.value.in_cart?(n(),i("div",Qe,[s("label",Ge,r(o(l)("product.quantity"))+":",1),s("div",He,[s("button",{onClick:t[3]||(t[3]=u=>U("minus")),disabled:x.value<=1||C.value||e.value.isOutOfStock,class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 transition"},"âˆ’",8,Je),s("span",We,r(x.value),1),s("button",{onClick:t[4]||(t[4]=u=>U("plus")),disabled:C.value||e.value.isOutOfStock,class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 transition"},"+",8,Ke)])])):c("",!0),s("button",{onClick:se,disabled:S.value||e.value.isOutOfStock,class:H(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!e.value.in_cart&&!e.value.isOutOfStock,"bg-[#0b3baa]":e.value.in_cart,"bg-gray-400 cursor-not-allowed":e.value.isOutOfStock}])},[e.value.in_cart?(n(),i("svg",Ye,t[9]||(t[9]=[s("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):c("",!0),e.value.in_cart?(n(),i("span",Ze,r(o(l)("product.inCart")),1)):e.value.isOutOfStock?(n(),i("span",et,r(o(l)("product.outOfStock")),1)):(n(),i("span",tt,r(S.value?o(l)("product.adding")+"...":o(l)("product.addToCart")),1))],10,Xe),e.value.isOutOfStock?(n(),i("p",st,r(o(l)("product.outOfStock")),1)):c("",!0)])])])),!b.value&&!w.value?(n(),i("section",at,[s("p",lt,r(V.value?A.value:W.value),1),N.value?(n(),i("button",{key:0,onClick:Z,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline"},r(V.value?o(l)("product.readLess"):o(l)("product.readMore")),1)):c("",!0)])):c("",!0),!b.value&&!w.value?(n(),i("section",ot,[s("h2",rt,r(o(l)("reviews.title")),1),s("div",nt,[s("div",it,[s("div",ut,r(P.value.toFixed(1)),1),F(o(z),{modelValue:I.value,"onUpdate:modelValue":t[5]||(t[5]=u=>I.value=u),readonly:!0,cancel:!1,class:"my-3 justify-center text-3xl"},null,8,["modelValue"]),s("p",ct,r(d.value.length)+" "+r(d.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural")),1)]),s("div",dt,[(n(!0),i(j,null,L(K.value,u=>(n(),i("div",{key:u.stars,class:"flex items-center gap-3 mb-4"},[s("span",vt,r(u.stars),1),s("div",pt,[s("div",{class:"absolute top-0 left-0 h-full bg-[#F0E3C2] transition-all duration-500",style:xe({width:u.percentage+"%"})},null,4)]),s("span",_t,r(u.count),1)]))),128))])]),s("div",gt,[s("h3",mt,r(o(l)("reviews.writeReview")),1),o(R).authenticatedweb?(n(),i("div",ht,[me(s("textarea",{"onUpdate:modelValue":t[6]||(t[6]=u=>g.value.comment=u),rows:"5",class:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#A6853B] focus:border-transparent outline-none resize-none",placeholder:o(l)("reviews.placeholder")},null,8,ft),[[he,g.value.comment]]),s("button",{onClick:ae,disabled:q.value||g.value.rating===0||!g.value.comment.trim(),class:"mt-4 w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed"},r(q.value?o(l)("reviews.submitting"):o(l)("reviews.submit")),9,xt),D.value?(n(),i("p",yt,r(D.value),1)):c("",!0)])):(n(),i("div",bt,[s("p",wt,r(o(l)("reviews.loginToReview")),1),s("button",{onClick:t[7]||(t[7]=u=>o(y).push({name:"authlog"})),class:"px-8 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition"},r(o(l)("reviews.login")),1)]))]),d.value.length?(n(),i("div",kt,[s("h3",Ot,r(o(l)("reviews.customerReviews")),1),(n(!0),i(j,null,L(X.value,u=>{var T;return n(),i("div",{key:u.id,class:"border-b pb-6"},[s("div",St,[s("div",Ct,[s("span",Dt,r(((T=u.user)==null?void 0:T.name)||o(l)("reviews.anonymous")),1),F(o(z),{modelValue:u.rate,readonly:!0,cancel:!1},null,8,["modelValue"])]),s("span",Ft,r(ee(u.created_at)),1)]),s("p",Rt,r(u.message),1)])}),128))])):(n(),i("div",Vt,r(o(l)("reviews.noReviews")),1))])):c("",!0),!b.value&&!w.value?(n(),i("section",qt,[F(ye)])):c("",!0)])}}},Tt=ne(At,[["__scopeId","data-v-e7d04b1b"]]);export{Tt as default};
