import{_ as N,k as R,u as V,j as W,p as q,r as d,l as D,m as H,o as T,q as U,a as n,c as r,f as s,t as u,e as g,F as G,d as J,h as K,i as w,s as B,v as O,g as C,x as Q}from"./index-a850403b.js";import{d as X}from"./banner-addtion-e4104052.js";const Y={class:"mx-auto mt-16 max-w-7xl px-4 sm:px-6 lg:px-8 pb-16"},Z={key:0,class:"py-16"},ee={class:"flex flex-col items-center justify-center space-y-4"},te={class:"text-indigo-600 text-xl font-semibold animate-pulse"},se={key:1,class:"text-center mb-10 py-16 text-red-600"},ae={class:"text-lg font-semibold"},oe={key:2},ne={class:"font-bold font-sans text-gray-800 lg:mt-4 xs:mt-2 xs:text-lg sm:text-xl md:text-2xl lg:text-3xl text-center animate-fade-in"},re={class:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-10 mb-10"},ie=["onClick"],le={class:"w-full h-60 overflow-hidden rounded-t-lg relative"},de=["src","alt"],ce=["onClick"],ue={class:"p-4 w-full"},ge={class:"font-sans text-gray-800 font-medium text-base line-clamp-2 h-12"},me={key:0,class:"font-sans text-gray-600 text-sm line-clamp-1 mt-1"},ve={class:"flex items-center w-full justify-between mt-3"},pe={class:"font-sans text-[#A6853B] font-semibold text-lg"},_e=["onClick"],fe={class:"mt-8 bg-white flex justify-center"},he={__name:"produts-category",setup(we){const L=R(),b=V(),{t:_,locale:x}=W(),f=q(),P=d(localStorage.getItem("defaultStoreId")),y=d({title:"",products:[]}),k=d(!1),m=d(null),c=d(1),v=d(12),z=d(0),p=d(window.innerWidth>=1024),F=()=>{p.value=window.innerWidth>=1024,v.value=p.value?12:6},h=async(a=1)=>{k.value=!0,m.value=null;try{const t=(await w.get(`/api/home/products-by-category/${L.params.id}/${P.value}`,{params:{page:a,limit:v.value}})).data.data;y.value={title:x.value==="ar"?`منتجات ${t.category.name_ar||t.category.name_en}`:`Products ${t.category.name_en||t.category.name_ar}`,products:(t.products.data||[]).map(o=>{var i,l;return{id:o.id,name:x.value==="ar"?o.name_ar||o.name_en:o.name_en||o.name_ar,sub_name:x.value==="ar"?o.sub_name_ar||o.sub_name_en:o.sub_name_en||o.sub_name_ar,price:parseFloat(o.base_price||0).toFixed(2),img:((l=(i=o.media)==null?void 0:i.find(E=>E.name==="product_main_image"))==null?void 0:l.url)||o.key_default_image||X,is_wished:o.is_wished||!1,variant_id:o.variant_id||null}})},c.value=t.products.current_page,z.value=t.products.total}catch(e){console.error("Error fetching products:",e),m.value=_("products.errorLoading")||"Failed to load products."}finally{k.value=!1}},$=D(()=>y.value.products),M=a=>{c.value=a.page+1,h(c.value)},I=async a=>{if(!f.authenticatedweb){b.push({name:"AuthLogin"});return}try{const e={product_id:a.id,variant_id:a.variant_id,quantity:1},t=await w.post("/api/cart/add",e);console.log("Added to cart successfully:",t.data),alert("Product added to cart!")}catch(e){console.error("Error adding to cart:",e),alert("Failed to add product to cart.")}},S=async a=>{if(!f.authenticatedweb){b.push({name:"AuthLogin"});return}const e=a.is_wished,t=e?"delete":"post",o=e?`/api/wishlists/${a.id}`:"/api/wishlists",i={product_id:a.id};try{let l;t==="post"?l=await w.post(o,i):l=await w.delete(o,{data:i}),a.is_wished=!e,console.log(`Product ${e?"removed from":"added to"} wishlist successfully:`,l.data)}catch(l){console.error("Error toggling favorite status:",l),a.is_wished=e,alert("Failed to update wishlist.")}},j=(a,e)=>a.length<=e?a:a.slice(0,e)+"...",A=()=>{const a=window.innerWidth>=1024;a!==p.value&&(p.value=a,v.value=p.value?12:6,c.value=1,h(c.value))};return H(()=>{L.params.id&&P.value?(F(),h(c.value)):m.value=_("products.missingParams")||"Missing category or store ID."}),T(()=>{window.addEventListener("resize",A)}),U(()=>{window.removeEventListener("resize",A)}),(a,e)=>(n(),r("div",Y,[k.value?(n(),r("div",Z,[s("div",ee,[e[1]||(e[1]=s("div",{class:"relative w-24 h-24"},[s("div",{class:"absolute inset-0 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin"}),s("div",{class:"absolute inset-4 rounded-full border-4 border-pink-500 border-b-transparent animate-spin animation-delay-200"}),s("div",{class:"absolute inset-8 rounded-full border-4 border-purple-500 border-l-transparent animate-spin animation-delay-400"})],-1)),s("p",te,u(g(_)("products.loading")),1),e[2]||(e[2]=s("div",{class:"w-1/2 h-2 bg-gray-200 rounded-full overflow-hidden"},[s("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-pink-500 animate-progress"})],-1))])])):m.value?(n(),r("div",se,[s("p",ae,u(m.value),1),s("button",{onClick:h,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700"},u(g(_)("products.retry")),1)])):(n(),r("div",oe,[s("h2",ne,u(y.value.title),1),s("div",re,[(n(!0),r(G,null,J($.value,(t,o)=>(n(),r("div",{key:t.id,class:"group flex flex-col items-start cursor-pointer h-full bg-white transition-all pb-4 rounded-lg shadow-lg duration-300 hover:-translate-y-2 hover:shadow-xl",onClick:i=>g(b).push({name:"Product-details",params:{id:t.id}})},[s("div",le,[s("img",{src:t.img,alt:t.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,de),e[4]||(e[4]=s("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1)),g(f).authenticatedweb?(n(),r("button",{key:0,class:"absolute top-2 right-2 p-2 rounded-full bg-white text-gray-500 hover:text-red-500 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 z-10",onClick:B(i=>S(t),["stop"]),"aria-label":"Add to wishlist"},[(n(),r("svg",{class:O(["w-5 h-5",{"text-red-500":t.is_wished}]),fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e[3]||(e[3]=[s("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)]),2))],8,ce)):C("",!0)]),s("div",ue,[s("p",ge,u(j(t.name,30)),1),t.sub_name?(n(),r("p",me,u(t.sub_name.slice(0,37)),1)):C("",!0),s("div",ve,[s("span",pe," $"+u(t.price),1),g(f).authenticatedweb?(n(),r("button",{key:0,class:"p-2 rounded-full bg-gray-100 text-[#A6853B] hover:bg-[#A6853B] hover:text-white transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-[#A6853B] focus:ring-offset-2",onClick:B(i=>I(t),["stop"]),"aria-label":"Add to cart"},e[5]||(e[5]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})],-1)]),8,_e)):C("",!0)])])],8,ie))),128))]),s("div",fe,[K(g(Q),{rows:v.value,totalRecords:z.value,pageLinkSize:3,first:(c.value-1)*v.value,onPage:e[0]||(e[0]=t=>M(t)),template:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",class:"custom-paginator"},null,8,["rows","totalRecords","first"])])]))]))}},ye=N(he,[["__scopeId","data-v-a8c51f9e"]]);export{ye as default};
