import{j as q,u as E,k as I,q as N,r as v,o as P,a as l,c as o,f as s,x as _,e as r,t as d,F as A,d as B,g as p,i as y,v as L}from"./index-c059490f.js";const R={class:"bg-[#FAF7F0] min-h-[100vh] py-8"},S={class:"mx-auto w-full max-w-7xl px-4"},D={key:0,class:"text-center"},H={class:"text-lg font-sans"},V={key:1,class:"text-center text-red-500"},U={class:"text-lg font-sans"},G={key:2,class:"text-center"},J={class:"text-lg font-sans"},K={key:3,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},O=["onClick"],Q={class:"w-full aspect-square overflow-hidden rounded-t-lg relative"},X=["src","alt"],Y=["onClick","aria-label"],Z={class:"p-4 flex flex-col flex-grow w-full"},ee={class:"flex items-center justify-between mt-auto"},te={class:"font-sans text-[#A6853B] font-semibold xs:text-base sm:text-lg"},ae=["onClick","aria-label"],se={key:4,class:"mt-8 flex justify-center items-center gap-2"},ie=["disabled"],re={class:"flex gap-1"},le=["onClick","disabled","aria-label"],oe=["disabled"],ce={__name:"favorites",setup(ne){const{t:i,locale:f}=q(),x=E(),$=I(),h=N(),k=v(localStorage.getItem("appLang")||"ar"),g=v({title:i("favorites.title")||"Favorites",products:[]}),w=v(!1),m=v(null),c=v({current_page:parseInt($.query.page)||1,last_page:1,links:[]}),b=async(a=1)=>{w.value=!0,m.value=null;try{const e=await y.get("/api/wishlists",{params:{page:a,limit:12}}),t=e.data.data.data||[],u=e.data.data;g.value={title:i("favorites.title")||"Favorites",products:t.map(n=>{var C,F;return{id:n.id,variant_id:n.variant_id,data:n,is_wished:n.is_wished??!0,sub_name:k.value==="ar"?n.sub_name_ar||n.sub_name_en:n.sub_name_en||n.sub_name_ar,name:k.value==="ar"?n.name_ar:n.name_en,price:parseFloat(n.base_price).toFixed(2),img:((F=(C=n.media)==null?void 0:C.find(T=>T.name==="product_main_image"))==null?void 0:F.url)||n.key_default_image}})},c.value={current_page:u.current_page||1,last_page:u.last_page||1,links:u.links||[]}}catch(e){console.error("Error fetching favorites:",e),m.value=i("favorites.errorLoading")||"Failed to load favorites."}finally{w.value=!1}},M=a=>{if(!a)return null;try{const e=new URL(a).searchParams.get("page");return e?parseInt(e):null}catch{return null}},W=async a=>{if(!h.authenticatedweb){x.push({name:"AuthLogin"});return}try{await y.post("/api/cart/add",{product_id:a.id,variant_id:a.variant_id,quantity:1}),alert(i("favorites.addedToCart")||"Added to cart successfully!")}catch(e){console.error("Error adding to cart:",e),alert(i("favorites.errorCart")||"Failed to add to cart.")}},j=async a=>{if(!h.authenticatedweb){x.push({name:"AuthLogin"});return}try{const e=a.is_wished?"/api/wishlists/remove":"/api/wishlists/add";await y.post(e,{product_id:a.id,variant_id:a.variant_id}),a.is_wished=!a.is_wished,a.is_wished||(g.value.products=g.value.products.filter(t=>t.id!==a.id||t.variant_id!==a.variant_id)),alert(i(a.is_wished?"favorites.addedToWishlist":"favorites.removedFromWishlist")||"Wishlist updated!")}catch(e){console.error("Error toggling wishlist:",e),alert(i("favorites.errorWishlist")||"Failed to update wishlist.")}},z=(a,e)=>a?a.length<=e?a:a.slice(0,e)+"...":"";return P(()=>{b(c.value.current_page)}),(a,e)=>(l(),o("main",R,[s("section",S,[s("h1",{class:_(["text-3xl font-bold text-center mb-8",{"font-noto-kufi text-right":r(f)==="ar","font-plus-jakarta":r(f)==="en"}])},d(r(i)("favorites.title")),3),w.value?(l(),o("div",D,[s("p",H,d(r(i)("favorites.loading")),1)])):m.value?(l(),o("div",V,[s("p",U,d(m.value),1)])):g.value.products.length===0?(l(),o("div",G,[s("p",J,d(r(i)("favorites.empty")),1)])):(l(),o("div",K,[(l(!0),o(A,null,B(g.value.products,t=>(l(),o("div",{key:`${t.id}-${t.variant_id}`,class:"group flex flex-col items-start bg-white rounded-lg shadow-lg transition-all duration-300 hover:-translate-y-2 cursor-pointer",onClick:u=>r(x).push({name:"Product-details",params:{id:t.id}})},[s("div",Q,[s("img",{src:t.img,alt:t.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,X),e[3]||(e[3]=s("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1)),r(h).authenticatedweb?(l(),o("button",{key:0,class:"absolute top-2 right-2 p-2 rounded-full bg-white text-gray-500 hover:text-red-500 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 z-10",onClick:L(u=>j(t),["stop"]),"aria-label":t.is_wished?r(i)("favorites.removeFromWishlist"):r(i)("favorites.addToWishlist")},[(l(),o("svg",{class:_(["w-5 h-5",{"text-red-500":t.is_wished}]),fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e[2]||(e[2]=[s("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)]),2))],8,Y)):p("",!0)]),s("div",Z,[s("p",{class:_(["font-sans text-gray-800 font-medium xs:text-sm sm:text-base md:text-lg truncate",{"text-right":r(f)==="ar"}])},d(z(t.name,30)),3),t.sub_name?(l(),o("p",{key:0,class:_(["font-sans text-gray-600 text-sm truncate",{"text-right":r(f)==="ar"}])},d(t.sub_name.slice(0,37)),3)):p("",!0),s("div",ee,[s("span",te,d(t.price)+" "+d(r(i)("currencyLabel")),1),r(h).authenticatedweb?(l(),o("button",{key:0,class:"p-2 rounded-full bg-gray-100 text-[#A6853B] hover:bg-[#A6853B] hover:text-white transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-[#A6853B] focus:ring-offset-2",onClick:L(u=>W(t),["stop"]),"aria-label":r(i)("favorites.addToCart")},e[4]||(e[4]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})],-1)]),8,ae)):p("",!0)])])],8,O))),128))])),c.value.last_page>1?(l(),o("div",se,[s("button",{onClick:e[0]||(e[0]=t=>b(c.value.current_page-1)),disabled:c.value.current_page===1,class:"px-4 py-2 rounded-lg text-gray-700 bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300","aria-label":"الصفحة السابقة"},d(r(i)("pagination.previous")||"السابق"),9,ie),s("div",re,[(l(!0),o(A,null,B(c.value.links,t=>(l(),o("button",{key:t.label,onClick:u=>b(M(t.url)),class:_([{"bg-yellow-500 text-white":t.active,"bg-gray-200 text-gray-700":!t.active},"px-4 py-2 rounded-lg"]),disabled:!t.url,"aria-label":`الصفحة ${t.label}`},d(t.label),11,le))),128))]),s("button",{onClick:e[1]||(e[1]=t=>b(c.value.current_page+1)),disabled:c.value.current_page===c.value.last_page,class:"px-4 py-2 rounded-lg text-gray-700 bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300","aria-label":"الصفحة التالية"},d(r(i)("pagination.next")||"التالي"),9,oe)])):p("",!0)])]))}};export{ce as default};
