import{_ as N,u as z,l as Q,I as G,k as H,r as u,c as J,o as K,n as T,Q as W,a as c,b as p,z as X,e as t,t as d,h as o,y as x,f as m,L as g,p as $,w as Y,F as Z,i as I}from"./index-c1f9e4e6.js";const ee={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},te={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},oe={class:"space-y-2"},se={for:"name_en",class:"block text-sm font-medium text-gray-700"},re={class:"space-y-2"},le={for:"name_ar",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},ie={for:"parent_id",class:"block text-sm font-medium text-gray-700"},de={class:"space-y-2"},ue={for:"store_id",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2 md:col-span-2"},pe={class:"block text-sm font-medium text-gray-700"},ge={class:"flex items-center space-x-4"},me={class:"text-sm text-gray-600"},be={class:"space-y-2"},ve={class:"block text-sm font-medium text-gray-700"},_e={class:"flex justify-center"},ye={key:0,class:"p-4 w-full h-full"},fe={class:"relative group w-full h-full"},xe=["src","alt"],he={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},we={key:1,class:"p-4 flex flex-col items-center justify-center"},ke={class:"text-sm text-center text-gray-600"},De={class:"text-blue-500 font-medium"},Ve={class:"space-y-2"},je={class:"block text-sm font-medium text-gray-700"},Te={class:"flex justify-center"},Ie={key:0,class:"p-4 w-full h-full"},Ce={class:"relative group w-full h-full"},Be=["src","alt"],$e={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ee={key:1,class:"p-4 flex flex-col items-center justify-center"},Ue={class:"text-sm text-center text-gray-600"},Pe={class:"text-blue-500 font-medium"},Se={class:"space-y-2 md:col-span-2"},Le={class:"block text-sm font-medium text-gray-700"},Ae={class:"flex justify-center"},Fe={key:0,class:"p-4 w-full h-full"},Oe={class:"relative group w-full h-full"},Re=["src","alt"],qe={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Me={key:1,class:"p-4 flex flex-col items-center justify-center"},Ne={class:"text-sm text-center text-gray-600"},ze={class:"text-blue-500 font-medium"},Qe={class:"pt-4 flex justify-center space-x-4"},Ge={key:0},He={key:1,class:"pi pi-spinner pi-spin"},Je={__name:"update",setup(Ke){const E=z(),v=Q(),C=G(),{t:a}=H(),_=u(!1),U=J(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),l=u({name_en:"",name_ar:"",is_market:!1,parent_id:null,store_id:null,image:null,banner_one_image:null,banner_two_image:null}),h=u(null),w=u(null),k=u(null),P=u([]),S=u([]),D=u(!1),V=u(!1),j=u(!1),A=async()=>{try{const s=await I.get("/api/category");P.value=s.data.data.data}catch(s){console.error("Error fetching parent categories:",s)}},F=async()=>{try{const s=await I.get("/api/store");S.value=s.data.data.data}catch(s){console.error("Error fetching stores:",s)}},O=async s=>{try{const i=(await I.get(`/api/category/${s}`)).data.data;l.value={name_en:i.name_en||"",name_ar:i.name_ar||"",is_market:!!i.is_market,parent_id:i.parent_id||null,store_id:i.store_id||null,image:null,banner_one_image:null,banner_two_image:null},i.media.forEach(n=>{n.name==="category_image"?h.value=n.url:n.name==="banner_one_image"?w.value=n.url:n.name==="banner_two_image"&&(k.value=n.url)})}catch(e){console.error("Error fetching category data:",e),C.add({severity:"error",summary:a("error"),detail:a("category.fetchError"),life:3e3})}},R=(s,e)=>{const i=new FileReader;i.onload=n=>{switch(e){case"image":l.value.image=s,h.value=n.target.result,D.value=!1;break;case"banner_one":l.value.banner_one_image=s,w.value=n.target.result,V.value=!1;break;case"banner_two":l.value.banner_two_image=s,k.value=n.target.result,j.value=!1;break}},i.readAsDataURL(s)},y=(s,e)=>{var n,f,b;const i=((n=s.target.files)==null?void 0:n[0])||((b=(f=s.dataTransfer)==null?void 0:f.files)==null?void 0:b[0]);i&&i.type.match("image.*")&&R(i,e)},B=s=>{switch(s){case"image":l.value.image=null,h.value=null;break;case"banner_one":l.value.banner_one_image=null,w.value=null;break;case"banner_two":l.value.banner_two_image=null,k.value=null;break}},q=async()=>{var e,i;_.value=!0;const s=new FormData;s.append("name_en",l.value.name_en),s.append("name_ar",l.value.name_ar),s.append("is_market",l.value.is_market?"1":"0"),s.append("parent_id",l.value.parent_id||""),s.append("store_id",l.value.store_id||""),l.value.image&&s.append("image",l.value.image),l.value.banner_one_image&&s.append("banner_one_image",l.value.banner_one_image),l.value.banner_two_image&&s.append("banner_two_image",l.value.banner_two_image);try{const n=v.params.id,f="post",b=n?`/api/category/${n}`:"/api/category",L=await I[f](b,s);E.push({name:"category"}),C.add({severity:"success",summary:a("success"),detail:a(n?"category.updateSuccess":"category.createSuccess"),life:3e3})}catch(n){console.error("Error:",n),C.add({severity:"error",summary:a("error"),detail:((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.message)||(v.params.id?a("category.updateError"):a("category.createError")),life:3e3})}finally{_.value=!1}};return K(async()=>{await A(),await F();const s=v.params.id;s&&await O(s)}),(s,e)=>{const i=T("InputText"),n=T("Dropdown"),f=T("InputSwitch"),b=T("Button"),L=T("Toast"),M=W("can");return c(),p(Z,null,[X((c(),p("div",ee,[t("h1",te,d(o(v).params.id?o(a)("category.updateTitle"):o(a)("category.createTitle")),1),t("form",{onSubmit:g(q,["prevent"]),class:"space-y-6"},[t("div",ae,[t("div",oe,[t("label",se,[x(d(o(a)("category.nameEn"))+" ",1),e[21]||(e[21]=t("span",{class:"text-red-500"},"*",-1))]),m(i,{id:"name_en",modelValue:l.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.name_en=r),placeholder:o(a)("category.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",re,[t("label",le,[x(d(o(a)("category.nameAr"))+" ",1),e[22]||(e[22]=t("span",{class:"text-red-500"},"*",-1))]),m(i,{id:"name_ar",modelValue:l.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.name_ar=r),placeholder:o(a)("category.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",ne,[t("label",ie,d(o(a)("category.parent")),1),m(n,{filter:"",modelValue:l.value.parent_id,"onUpdate:modelValue":e[2]||(e[2]=r=>l.value.parent_id=r),options:P.value,optionLabel:U.value,optionValue:"id",placeholder:o(a)("category.selectParent"),class:"w-full",showClear:!0},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",de,[t("label",ue,[x(d(o(a)("category.store"))+" ",1),e[23]||(e[23]=t("span",{class:"text-red-500"},"*",-1))]),m(n,{filter:"",modelValue:l.value.store_id,"onUpdate:modelValue":e[3]||(e[3]=r=>l.value.store_id=r),options:S.value,optionLabel:U.value,optionValue:"id",placeholder:o(a)("category.selectStore"),class:"w-full",required:""},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",ce,[t("label",pe,d(o(a)("category.marketType")),1),t("div",ge,[m(f,{modelValue:l.value.is_market,"onUpdate:modelValue":e[4]||(e[4]=r=>l.value.is_market=r)},null,8,["modelValue"]),t("span",me,d(l.value.is_market?o(a)("category.market"):o(a)("category.nonMarket")),1)])]),t("div",be,[t("label",ve,d(o(a)("category.image")),1),t("div",_e,[t("label",{onDragover:e[7]||(e[7]=g(r=>D.value=!0,["prevent"])),onDragleave:e[8]||(e[8]=r=>D.value=!1),onDrop:e[9]||(e[9]=g(r=>y(r,"image"),["prevent"])),class:$([{"border-blue-500 bg-blue-50":D.value,"border-gray-300":!D.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[5]||(e[5]=r=>y(r,"image")),accept:"image/*",class:"hidden"},null,32),h.value?(c(),p("div",ye,[t("div",fe,[t("img",{src:h.value,alt:o(a)("category.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,xe),t("div",he,[t("button",{type:"button",onClick:e[6]||(e[6]=g(r=>B("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[24]||(e[24]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",we,[e[25]||(e[25]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",ke,[t("span",De,d(o(a)("category.clickToUpload")),1),x(" "+d(o(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Ve,[t("label",je,d(o(a)("category.bannerOne")),1),t("div",Te,[t("label",{onDragover:e[12]||(e[12]=g(r=>V.value=!0,["prevent"])),onDragleave:e[13]||(e[13]=r=>V.value=!1),onDrop:e[14]||(e[14]=g(r=>y(r,"banner_one"),["prevent"])),class:$([{"border-blue-500 bg-blue-50":V.value,"border-gray-300":!V.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[10]||(e[10]=r=>y(r,"banner_one")),accept:"image/*",class:"hidden"},null,32),w.value?(c(),p("div",Ie,[t("div",Ce,[t("img",{src:w.value,alt:o(a)("category.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Be),t("div",$e,[t("button",{type:"button",onClick:e[11]||(e[11]=g(r=>B("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[26]||(e[26]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Ee,[e[27]||(e[27]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Ue,[t("span",Pe,d(o(a)("category.clickToUpload")),1),x(" "+d(o(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Se,[t("label",Le,d(o(a)("category.bannerTwo")),1),t("div",Ae,[t("label",{onDragover:e[17]||(e[17]=g(r=>j.value=!0,["prevent"])),onDragleave:e[18]||(e[18]=r=>j.value=!1),onDrop:e[19]||(e[19]=g(r=>y(r,"banner_two"),["prevent"])),class:$([{"border-blue-500 bg-blue-50":j.value,"border-gray-300":!j.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[15]||(e[15]=r=>y(r,"banner_two")),accept:"image/*",class:"hidden"},null,32),k.value?(c(),p("div",Fe,[t("div",Oe,[t("img",{src:k.value,alt:o(a)("category.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Re),t("div",qe,[t("button",{type:"button",onClick:e[16]||(e[16]=g(r=>B("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[28]||(e[28]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Me,[e[29]||(e[29]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Ne,[t("span",ze,d(o(a)("category.clickToUpload")),1),x(" "+d(o(a)("category.orDragAndDrop")),1)])]))],34)])])]),t("div",Qe,[m(b,{type:"button",label:o(a)("cancel"),icon:"pi pi-times",onClick:e[20]||(e[20]=r=>o(E).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},null,8,["label","disabled"]),m(b,{type:"submit",label:o(v).params.id?o(a)("category.updateButton"):o(a)("category.createButton"),icon:"pi pi-plus",loading:_.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},{default:Y(()=>[_.value?(c(),p("i",He)):(c(),p("span",Ge,d(o(v).params.id?o(a)("category.updateButton"):o(a)("category.createButton")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[M,"create categories"]]),m(L)],64)}}},Xe=N(Je,[["__scopeId","data-v-261f5c95"]]);export{Xe as default};
