import{_ as ne,b as de,I as ue,u as ce,r as f,G as $,d as pe,v as k,S as me,x as _e,o as y,e as x,f as a,t as i,j as r,p as b,g as d,s as g,F as j,z as G,h as O,L as w,a as D}from"./index-07d2a61c.js";const ve=["dir"],be={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},fe={class:"space-y-2"},ye={for:"store_id",class:"block text-sm font-medium text-gray-700"},xe={class:"space-y-2"},Ve={for:"category_id",class:"block text-sm font-medium text-gray-700"},he={class:"space-y-2"},ke={for:"brand_id",class:"block text-sm font-medium text-gray-700"},we={class:"space-y-2"},Ue={for:"name_en",class:"block text-sm font-medium text-gray-700"},De={class:"space-y-2"},Ie={for:"name_ar",class:"block text-sm font-medium text-gray-700"},Ce={class:"space-y-2"},Le={for:"sub_name_en",class:"block text-sm font-medium text-gray-700"},Fe={class:"space-y-2"},$e={for:"sub_name_ar",class:"block text-sm font-medium text-gray-700"},Te={class:"md:col-span-2 space-y-2"},Se={for:"description_en",class:"block text-sm font-medium text-gray-700"},Ae={class:"md:col-span-2 space-y-2"},je={for:"description_ar",class:"block text-sm font-medium text-gray-700"},Ee={class:"space-y-2"},Be={for:"tax",class:"block text-sm font-medium text-gray-700"},Ne={class:"space-y-2"},Re={for:"is_displayed",class:"block text-sm font-medium text-gray-700"},Pe={class:"space-y-2"},ze={for:"base_price",class:"block text-sm font-medium text-gray-700"},Me={class:"space-y-2"},qe={for:"cost_price",class:"block text-sm font-medium text-gray-700"},Ge={class:"md:col-span-2 space-y-2"},Oe={class:"flex items-center"},He={for:"hasVariants",class:"text-sm font-medium text-gray-700"},Je={key:1,class:"md:col-span-2 space-y-4"},Ke={class:"border-b pb-2"},Qe={class:"text-lg font-semibold text-gray-800"},We={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"space-y-2 md:col-span-2"},Ye=["for"],Ze={class:"space-y-2"},ea=["for"],aa={class:"space-y-2"},ta=["for"],sa={class:"space-y-2"},la=["for"],oa={class:"space-y-2"},ra=["for"],ia={class:"space-y-2"},na=["for"],da=["for","onDrop"],ua=["id","onChange"],ca={key:0,class:"p-4"},pa={class:"relative group"},ma=["src"],_a={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},va=["onClick","title"],ba={class:"mt-2 text-center text-sm text-gray-500"},ga={key:1,class:"p-4 flex flex-col items-center justify-center"},fa={class:"text-xs text-center text-gray-600"},ya={class:"text-blue-500 font-medium"},xa={class:"text-xs text-gray-400"},Va={class:"flex justify-end"},ha={class:"md:col-span-2 space-y-2"},ka={class:"block text-sm font-medium text-gray-700"},wa={key:0,class:"space-y-4"},Ua={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},Da=["src"],Ia={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ca=["onClick","title"],La={class:"text-center text-sm text-gray-500"},Fa={key:1,class:"flex flex-col items-center justify-center space-y-3"},$a={class:"text-sm text-center text-gray-600"},Ta={class:"text-blue-500 font-medium"},Sa={class:"text-xs text-gray-400"},Aa={class:"pt-4 flex justify-center space-x-4"},ja={__name:"create",setup(Ea){const E=de(),v=ue(),{t}=ce();f();const I=f(!1),h=f(!1),B=f([]),N=f([]),R=f([]),P=f([]),V=f(!1),T=f([]),C=f([]),L=$(()=>localStorage.getItem("appLang")||"en"),U=$(()=>L.value==="en"?"name_en":"name_ar"),H=$(()=>L.value==="ar"),s=f({store_id:null,category_id:null,brand_id:null,name_en:"",name_ar:"",sub_name_en:"",sub_name_ar:"",description_en:"",description_ar:"",base_price:null,cost_price:null,tax:0,is_displayed:!0,variants:[]}),J=$(()=>P.value.map(o=>({label:L.value==="en"?o.name_en:o.name_ar,value:o.id,items:o.values.map(e=>({id:e.id,[U.value]:L.value==="en"?e.value_en:e.value_ar}))}))),K=async()=>{try{const o=await D.get("/api/store");B.value=o.data.data.data}catch{v.add({severity:"error",summary:t("error"),detail:t("error.storeLoad"),life:3e3})}},Q=async()=>{try{const o=await D.get("/api/category");N.value=o.data.data.data}catch{v.add({severity:"error",summary:t("error"),detail:t("error.categoryLoad"),life:3e3})}},W=async()=>{try{const o=await D.get("/api/brand");R.value=o.data.data.data}catch{v.add({severity:"error",summary:t("error"),detail:t("error.brandLoad"),life:3e3})}},X=async()=>{try{const o=await D.get("/api/product/create/data");P.value=o.data.data}catch{v.add({severity:"error",summary:t("error"),detail:t("error.attributeLoad"),life:3e3})}};pe(()=>{K(),Q(),W(),X()});const Y=o=>{for(let e=0;e<o.length;e++){const c=o[e];if(c.size>2*1024*1024){v.add({severity:"error",summary:t("error"),detail:t("validation.imageSize"),life:3e3});continue}if(!c.type.match("image.*")){v.add({severity:"error",summary:t("error"),detail:t("validation.imageInvalid"),life:3e3});continue}const m=new FileReader;m.onload=n=>{T.value.push(c),C.value.push(n.target.result)},m.readAsDataURL(c)}h.value=!1},z=o=>{var c;const e=o.target.files||((c=o.dataTransfer)==null?void 0:c.files);e&&e.length>0&&Y(e)},Z=o=>{T.value.splice(o,1),C.value.splice(o,1)},ee=(o,e)=>{if(o.size>2*1024*1024){v.add({severity:"error",summary:t("error"),detail:t("validation.imageSize"),life:3e3});return}if(!o.type.match("image.*")){v.add({severity:"error",summary:t("error"),detail:t("validation.imageInvalid"),life:3e3});return}s.value.variants[e].variant_image=o;const c=new FileReader;c.onload=m=>{s.value.variants[e].variant_image_preview=m.target.result},c.readAsDataURL(o)},M=(o,e)=>{var m,n,_;const c=((m=o.target.files)==null?void 0:m[0])||((_=(n=o.dataTransfer)==null?void 0:n.files)==null?void 0:_[0]);c&&ee(c,e)},ae=o=>{s.value.variants[o].variant_image=null,s.value.variants[o].variant_image_preview=null},te=()=>{V.value=!V.value,V.value&&!s.value.variants.length?q():V.value||(s.value.variants=[])},q=()=>{s.value.variants.push({sku_ar:"",sku_en:"",price:"",cost_price:null,attribute_value_ids:[],variant_image:null,variant_image_preview:null})},se=o=>{s.value.variants.length>1?s.value.variants.splice(o,1):v.add({severity:"warn",summary:t("error"),detail:t("validation.atLeastOneVariant"),life:3e3})},le=async()=>{var c,m;if(["store_id","category_id","brand_id","name_en","name_ar"].some(n=>!s.value[n])){v.add({severity:"error",summary:t("error"),detail:t("validation.requiredFields"),life:3e3});return}if(V.value){if(s.value.variants.some(n=>!n.sku_en||!n.sku_ar||!n.price||n.attribute_value_ids.length===0)){v.add({severity:"error",summary:t("error"),detail:t("validation.variantRequiredFields"),life:3e3});return}}else if(!s.value.base_price){v.add({severity:"error",summary:t("error"),detail:t("validation.basePriceRequired"),life:3e3});return}I.value=!0;const e=new FormData;e.append("store_id",s.value.store_id),e.append("category_id",s.value.category_id),e.append("brand_id",s.value.brand_id),e.append("name_en",s.value.name_en),e.append("name_ar",s.value.name_ar),e.append("sub_name_en",s.value.sub_name_en||""),e.append("sub_name_ar",s.value.sub_name_ar||""),e.append("description_en",s.value.description_en||""),e.append("description_ar",s.value.description_ar||""),e.append("tax",s.value.tax),e.append("is_displayed",s.value.is_displayed?1:0),T.value.forEach((n,_)=>{e.append(`main_images[${_}]`,n)}),V.value?s.value.variants.forEach((n,_)=>{e.append(`variants[${_}][sku_en]`,n.sku_en),e.append(`variants[${_}][sku_ar]`,n.sku_ar),e.append(`variants[${_}][price]`,n.price),e.append(`variants[${_}][cost_price]`,n.cost_price||0),Array.isArray(n.attribute_value_ids)&&n.attribute_value_ids.forEach((S,A)=>{e.append(`variants[${_}][attribute_value_ids][${A}]`,S)}),n.variant_image&&e.append(`variants[${_}][variant_image]`,n.variant_image)}):(e.append("base_price",s.value.base_price),e.append("cost_price",s.value.cost_price||0));try{await D.post("/api/product",e,{headers:{"Content-Type":"multipart/form-data"}}),E.push({name:"product"}),v.add({severity:"success",summary:t("success"),detail:t("product.createSuccess"),life:3e3})}catch(n){v.add({severity:"error",summary:t("error"),detail:((m=(c=n.response)==null?void 0:c.data)==null?void 0:m.message)||t("error.createError"),life:3e3})}finally{I.value=!1}};return(o,e)=>{const c=k("Dropdown"),m=k("InputText"),n=k("Textarea"),_=k("InputNumber"),S=k("InputSwitch"),A=k("Checkbox"),oe=k("MultiSelect"),F=k("Button"),re=k("Toast"),ie=me("can");return _e((y(),x("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:H.value?"rtl":"ltr"},[a("h1",be,i(r(t)("product.createTitle")),1),a("form",{onSubmit:w(le,["prevent"]),class:"space-y-6"},[a("div",ge,[a("div",fe,[a("label",ye,[b(i(r(t)("product.store"))+" ",1),e[19]||(e[19]=a("span",{class:"text-red-500"},"*",-1))]),d(c,{filter:"",id:"store_id",modelValue:s.value.store_id,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.store_id=l),options:B.value,optionLabel:U.value,optionValue:"id",class:g(["w-full",{"p-invalid":!s.value.store_id}])},null,8,["modelValue","options","optionLabel","class"])]),a("div",xe,[a("label",Ve,[b(i(r(t)("product.category"))+" ",1),e[20]||(e[20]=a("span",{class:"text-red-500"},"*",-1))]),d(c,{filter:"",id:"category_id",modelValue:s.value.category_id,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.category_id=l),options:N.value,optionLabel:U.value,optionValue:"id",class:g(["w-full",{"p-invalid":!s.value.category_id}])},null,8,["modelValue","options","optionLabel","class"])]),a("div",he,[a("label",ke,[b(i(r(t)("product.brand"))+" ",1),e[21]||(e[21]=a("span",{class:"text-red-500"},"*",-1))]),d(c,{filter:"",id:"brand_id",modelValue:s.value.brand_id,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.brand_id=l),options:R.value,optionLabel:U.value,optionValue:"id",class:g(["w-full",{"p-invalid":!s.value.brand_id}])},null,8,["modelValue","options","optionLabel","class"])]),a("div",we,[a("label",Ue,[b(i(r(t)("product.nameEn"))+" ",1),e[22]||(e[22]=a("span",{class:"text-red-500"},"*",-1))]),d(m,{id:"name_en",modelValue:s.value.name_en,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.name_en=l),class:g(["w-full",{"p-invalid":!s.value.name_en}])},null,8,["modelValue","class"])]),a("div",De,[a("label",Ie,[b(i(r(t)("product.nameAr"))+" ",1),e[23]||(e[23]=a("span",{class:"text-red-500"},"*",-1))]),d(m,{id:"name_ar",modelValue:s.value.name_ar,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.name_ar=l),dir:"rtl",class:g(["w-full",{"p-invalid":!s.value.name_ar}])},null,8,["modelValue","class"])]),a("div",Ce,[a("label",Le,i(r(t)("product.subNameEn")),1),d(m,{id:"sub_name_en",modelValue:s.value.sub_name_en,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.sub_name_en=l),class:"w-full"},null,8,["modelValue"])]),a("div",Fe,[a("label",$e,i(r(t)("product.subNameAr")),1),d(m,{id:"sub_name_ar",modelValue:s.value.sub_name_ar,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.sub_name_ar=l),dir:"rtl",class:"w-full"},null,8,["modelValue"])]),a("div",Te,[a("label",Se,i(r(t)("product.descriptionEn")),1),d(n,{id:"description_en",modelValue:s.value.description_en,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.description_en=l),rows:"4",class:"w-full"},null,8,["modelValue"])]),a("div",Ae,[a("label",je,i(r(t)("product.descriptionAr")),1),d(n,{id:"description_ar",modelValue:s.value.description_ar,"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.description_ar=l),rows:"4",dir:"rtl",class:"w-full"},null,8,["modelValue"])]),a("div",Ee,[a("label",Be,i(r(t)("product.tax"))+" (%) ",1),d(_,{id:"tax",modelValue:s.value.tax,"onUpdate:modelValue":e[9]||(e[9]=l=>s.value.tax=l),mode:"decimal",min:0,max:100,minFractionDigits:2,class:"w-full"},null,8,["modelValue"])]),a("div",Ne,[a("label",Re,i(r(t)("product.displayStatus")),1),d(S,{id:"is_displayed",modelValue:s.value.is_displayed,"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.is_displayed=l)},null,8,["modelValue"])]),V.value?G("",!0):(y(),x(j,{key:0},[a("div",Pe,[a("label",ze,[b(i(r(t)("product.basePrice"))+" ",1),e[24]||(e[24]=a("span",{class:"text-red-500"},"*",-1))]),d(_,{id:"base_price",modelValue:s.value.base_price,"onUpdate:modelValue":e[11]||(e[11]=l=>s.value.base_price=l),mode:"decimal",minFractionDigits:2,class:g(["w-full",{"p-invalid":!s.value.base_price}])},null,8,["modelValue","class"])]),a("div",Me,[a("label",qe,i(r(t)("product.costPrice")),1),d(_,{id:"cost_price",modelValue:s.value.cost_price,"onUpdate:modelValue":e[12]||(e[12]=l=>s.value.cost_price=l),mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["modelValue"])])],64)),a("div",Ge,[a("div",Oe,[d(A,{modelValue:V.value,"onUpdate:modelValue":e[13]||(e[13]=l=>V.value=l),inputId:"hasVariants",binary:!0,onClick:te,class:"mr-2"},null,8,["modelValue"]),a("label",He,i(r(t)("product.hasVariants")),1)])]),V.value?(y(),x("div",Je,[a("div",Ke,[a("h3",Qe,i(r(t)("product.variants")),1)]),(y(!0),x(j,null,O(s.value.variants,(l,u)=>(y(),x("div",{key:u,class:"p-4 border rounded-lg space-y-4 bg-gray-50"},[a("div",We,[a("div",Xe,[a("label",{for:"attributes_"+u,class:"block text-sm font-medium text-gray-700"},[b(i(r(t)("product.attributes"))+" ",1),e[25]||(e[25]=a("span",{class:"text-red-500"},"*",-1))],8,Ye),d(oe,{id:"attributes_"+u,modelValue:l.attribute_value_ids,"onUpdate:modelValue":p=>l.attribute_value_ids=p,options:J.value,optionGroupLabel:"label",optionGroupChildren:"items",optionLabel:U.value,optionValue:"id",class:g(["w-full",{"p-invalid":l.attribute_value_ids.length===0}]),display:"chip",filter:!0,showToggleAll:!1},null,8,["id","modelValue","onUpdate:modelValue","options","optionLabel","class"])]),a("div",Ze,[a("label",{for:"sku_en_"+u,class:"block text-sm font-medium text-gray-700"},[b(i(r(t)("product.skuEn"))+" ",1),e[26]||(e[26]=a("span",{class:"text-red-500"},"*",-1))],8,ea),d(m,{id:"sku_en_"+u,modelValue:l.sku_en,"onUpdate:modelValue":p=>l.sku_en=p,class:g(["w-full",{"p-invalid":!l.sku_en}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),a("div",aa,[a("label",{for:"sku_ar_"+u,class:"block text-sm font-medium text-gray-700"},[b(i(r(t)("product.skuAr"))+" ",1),e[27]||(e[27]=a("span",{class:"text-red-500"},"*",-1))],8,ta),d(m,{id:"sku_ar_"+u,modelValue:l.sku_ar,"onUpdate:modelValue":p=>l.sku_ar=p,dir:"rtl",class:g(["w-full",{"p-invalid":!l.sku_ar}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),a("div",sa,[a("label",{for:"price_"+u,class:"block text-sm font-medium text-gray-700"},[b(i(r(t)("product.price"))+" ",1),e[28]||(e[28]=a("span",{class:"text-red-500"},"*",-1))],8,la),d(_,{id:"price_"+u,modelValue:l.price,"onUpdate:modelValue":p=>l.price=p,mode:"decimal",minFractionDigits:2,class:g(["w-full",{"p-invalid":!l.price}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),a("div",oa,[a("label",{for:"cost_price_"+u,class:"block text-sm font-medium text-gray-700"},i(r(t)("product.costPrice")),9,ra),d(_,{id:"cost_price_"+u,modelValue:l.cost_price,"onUpdate:modelValue":p=>l.cost_price=p,mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue"])]),a("div",ia,[a("label",{for:"variant_image_"+u,class:"block text-sm font-medium text-gray-700"},i(r(t)("product.variantImage")),9,na),a("label",{for:"variant_image_"+u,onDragover:e[14]||(e[14]=w(p=>h.value=!0,["prevent"])),onDragleave:e[15]||(e[15]=p=>h.value=!1),onDrop:w(p=>M(p,u),["prevent"]),class:g([{"border-blue-500 bg-blue-50":h.value,"border-gray-300":!h.value},"cursor-pointer w-full rounded-lg border-2 border-dashed transition-colors duration-300 block"])},[a("input",{type:"file",id:"variant_image_"+u,onChange:p=>M(p,u),accept:"image/*",class:"hidden"},null,40,ua),l.variant_image_preview?(y(),x("div",ca,[a("div",pa,[a("img",{src:l.variant_image_preview,alt:"Variant Preview",class:"w-full h-32 object-contain rounded-lg shadow-md"},null,8,ma),a("div",_a,[a("button",{type:"button",onClick:w(p=>ae(u),["stop"]),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition",title:r(t)("product.deleteImage")},e[29]||(e[29]=[a("i",{class:"pi pi-trash text-sm"},null,-1)]),8,va)])]),a("p",ba,i(r(t)("product.changeImage")),1)])):(y(),x("div",ga,[e[30]||(e[30]=a("div",{class:"bg-blue-100 p-2 rounded-full mb-2"},[a("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),a("p",fa,[a("span",ya,i(r(t)("product.uploadClick")),1),b(" "+i(r(t)("product.uploadDrag")),1)]),a("p",xa,i(r(t)("product.imageFormat")),1)]))],42,da)])]),a("div",Va,[d(F,{type:"button",icon:"pi pi-trash",class:"p-button-danger p-button-sm",onClick:p=>se(u),disabled:s.value.variants.length===1,label:r(t)("product.removeVariant")},null,8,["onClick","disabled","label"])])]))),128)),d(F,{type:"button",label:r(t)("product.addVariant"),icon:"pi pi-plus",class:"p-button-outlined p-button-secondary",onClick:q},null,8,["label"])])):G("",!0),a("div",ha,[a("label",ka,i(r(t)("product.images")),1),a("label",{for:"main_images_upload",onDragover:e[16]||(e[16]=w(l=>h.value=!0,["prevent"])),onDragleave:e[17]||(e[17]=l=>h.value=!1),onDrop:w(z,["prevent"]),class:g([{"border-blue-500 bg-blue-50":h.value,"border-gray-300":!h.value},"cursor-pointer w-full rounded-xl border-2 border-dashed transition-colors duration-300 p-6 block"])},[a("input",{type:"file",id:"main_images_upload",onChange:z,accept:"image/*",multiple:"",class:"hidden"},null,32),C.value.length>0?(y(),x("div",wa,[a("div",Ua,[(y(!0),x(j,null,O(C.value,(l,u)=>(y(),x("div",{key:u,class:"relative group"},[a("img",{src:l,alt:"Preview",class:"w-full h-32 object-cover rounded-lg shadow-md"},null,8,Da),a("div",Ia,[a("button",{type:"button",onClick:w(p=>Z(u),["stop"]),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition",title:r(t)("product.deleteImage")},e[31]||(e[31]=[a("i",{class:"pi pi-trash text-sm"},null,-1)]),8,Ca)])]))),128))]),a("p",La,i(r(t)("product.addMoreImages")),1)])):(y(),x("div",Fa,[e[32]||(e[32]=a("div",{class:"bg-blue-100 p-3 rounded-full"},[a("i",{class:"pi pi-images text-blue-500 text-2xl"})],-1)),a("p",$a,[a("span",Ta,i(r(t)("product.uploadClick")),1),b(" "+i(r(t)("product.uploadDrag")),1)]),a("p",Sa,i(r(t)("product.imageFormat")),1)]))],34)])]),a("div",Aa,[d(F,{type:"button",label:r(t)("product.cancelButton"),icon:"pi pi-times",onClick:e[18]||(e[18]=l=>r(E).go(-1)),class:"p-button-outlined p-button-secondary",disabled:I.value},null,8,["label","disabled"]),d(F,{type:"submit",label:r(t)("product.createButton"),icon:"pi pi-check",loading:I.value,class:"p-button-success"},null,8,["label","loading"])])],32),d(re)],8,ve)),[[ie,"create products"]])}}},Na=ne(ja,[["__scopeId","data-v-306511cf"]]);export{Na as default};
