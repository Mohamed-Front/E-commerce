import{_ as L,k as N,u as R,M as S,j as q,r as V,l as B,o as M,a3 as f,P,a as c,c as p,A as O,f as a,t as v,e as r,b as z,g as C,v as G,O as y,h as i,F as $,d as H,w as J,i as w}from"./index-5d7df6f4.js";const K=["dir"],Q={class:"text-3xl font-bold text-center mb-8 text-gray-800"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},X={class:"space-y-2"},Y={for:"name_en",class:"block text-sm font-medium text-gray-700"},Z={class:"space-y-2"},ee={for:"name_ar",class:"block text-sm font-medium text-gray-700"},te={class:"space-y-4"},ae={class:"text-lg font-semibold text-gray-700 border-b pb-2"},se={class:"space-y-2"},re=["for"],le={class:"flex space-x-2"},oe={class:"space-y-2"},ne=["for"],ie={class:"flex space-x-2"},ue={class:"pt-2"},de={class:"pt-4 flex justify-center space-x-4"},ce={key:0},me={key:1,class:"pi pi-spinner pi-spin"},pe={__name:"update",setup(ve){const k=N(),x=R(),m=S(),{t:e}=q(),_=V(!1),h=V(!0),D=B(()=>localStorage.getItem("appLang")||"en"),T=B(()=>D.value==="ar"),s=V({name_en:"",name_ar:"",values:[{id:null,value_en:"",value_ar:""}]});M(async()=>{var n,t;try{const l=(await w.get(`/api/attribute/${k.params.id}`)).data.data;s.value={name_en:l.name_en,name_ar:l.name_ar,values:l.values.map(o=>({id:o.id,value_en:o.value_en,value_ar:o.value_ar}))},s.value.values.length===0&&s.value.values.push({id:null,value_en:"",value_ar:""})}catch(d){console.error("Error fetching attribute:",d),m.add({severity:"error",summary:e("error"),detail:((t=(n=d.response)==null?void 0:n.data)==null?void 0:t.message)||e("error.fetchError"),life:3e3}),x.push({name:"attribute"})}finally{h.value=!1}});const E=()=>{s.value.values.push({id:null,value_en:"",value_ar:""})},F=async n=>{const t=s.value.values[n].id;t?confirm.require({message:e("attribute.confirmDeleteValue"),header:e("common.confirmation"),icon:"pi pi-exclamation-triangle",accept:async()=>{var d,l;try{await w.delete(`/api/attribute-value/${t}`),s.value.values.splice(n,1),m.add({severity:"success",summary:e("success"),detail:e("attribute.valueDeleted"),life:3e3})}catch(o){console.error("Error deleting value:",o),m.add({severity:"error",summary:e("error"),detail:((l=(d=o.response)==null?void 0:d.data)==null?void 0:l.message)||e("error.deleteError"),life:3e3})}}}):s.value.values.length>1?s.value.values.splice(n,1):m.add({severity:"warn",summary:e("warning"),detail:e("attribute.minOneValue"),life:3e3})},I=async()=>{if(!s.value.name_en||!s.value.name_ar){m.add({severity:"error",summary:e("error"),detail:e("validation.requiredFields"),life:3e3});return}for(const n of s.value.values)if(!n.value_en||!n.value_ar){m.add({severity:"error",summary:e("error"),detail:e("attribute.valueRequired"),life:3e3});return}_.value=!0;try{await w.put(`/api/attribute/${k.params.id}`,s.value),m.add({severity:"success",summary:e("success"),detail:e("attribute.updateSuccess"),life:3e3}),x.push({name:"attribute"})}finally{_.value=!1}};return(n,t)=>{const d=f("ProgressBar"),l=f("InputText"),o=f("Button"),U=f("ConfirmDialog"),A=f("Toast"),j=P("can");return c(),p($,null,[O((c(),p("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:T.value?"rtl":"ltr"},[a("h1",Q,v(r(e)("attribute.updateTitle")),1),h.value?(c(),z(d,{key:0,mode:"indeterminate",class:"h-1"})):C("",!0),h.value?C("",!0):(c(),p("form",{key:1,onSubmit:G(I,["prevent"]),class:"space-y-6"},[a("div",W,[a("div",X,[a("label",Y,[y(v(r(e)("attribute.nameEn"))+" ",1),t[3]||(t[3]=a("span",{class:"text-red-500"},"*",-1))]),i(l,{id:"name_en",modelValue:s.value.name_en,"onUpdate:modelValue":t[0]||(t[0]=u=>s.value.name_en=u),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),a("div",Z,[a("label",ee,[y(v(r(e)("attribute.nameAr"))+" ",1),t[4]||(t[4]=a("span",{class:"text-red-500"},"*",-1))]),i(l,{id:"name_ar",modelValue:s.value.name_ar,"onUpdate:modelValue":t[1]||(t[1]=u=>s.value.name_ar=u),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])])]),a("div",te,[a("h3",ae,v(r(e)("attribute.values")),1),(c(!0),p($,null,H(s.value.values,(u,b)=>(c(),p("div",{key:b,class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},[a("div",se,[a("label",{for:`value_en_${b}`,class:"block text-sm font-medium text-gray-700"},[y(v(r(e)("attribute.valueEn"))+" ",1),t[5]||(t[5]=a("span",{class:"text-red-500"},"*",-1))],8,re),a("div",le,[i(l,{id:`value_en_${b}`,modelValue:u.value_en,"onUpdate:modelValue":g=>u.value_en=g,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"])])]),a("div",oe,[a("label",{for:`value_ar_${b}`,class:"block text-sm font-medium text-gray-700"},[y(v(r(e)("attribute.valueAr"))+" ",1),t[6]||(t[6]=a("span",{class:"text-red-500"},"*",-1))],8,ne),a("div",ie,[i(l,{id:`value_ar_${b}`,modelValue:u.value_ar,"onUpdate:modelValue":g=>u.value_ar=g,dir:"rtl",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"]),i(o,{type:"button",icon:"pi pi-trash",severity:"danger",onClick:g=>F(b),class:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",title:r(e)("attribute.removeValue")},null,8,["onClick","title"])])])]))),128)),a("div",ue,[i(o,{type:"button",label:r(e)("attribute.addValue"),icon:"pi pi-plus",onClick:E,class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition"},null,8,["label"])])]),a("div",de,[i(o,{type:"button",label:r(e)("attribute.cancelButton"),icon:"pi pi-times",onClick:t[2]||(t[2]=u=>r(x).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},null,8,["label","disabled"]),i(o,{type:"submit",label:r(e)("attribute.updateButton"),icon:"pi pi-check",loading:_.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},{default:J(()=>[_.value?(c(),p("i",me)):(c(),p("span",ce,v(r(e)("attribute.updateButton")),1))]),_:1},8,["label","loading","disabled"])])],32)),i(U)],8,K)),[[j,"edit attributes"]]),i(A)],64)}}},fe=L(pe,[["__scopeId","data-v-6126faf1"]]);export{fe as default};
