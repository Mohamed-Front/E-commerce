import{_ as T,j as N,r as _,q as U,u as W,k as G,l as J,o as A,s as K,n as B,a as o,c as n,f as a,t as u,e as m,F as O,d as E,g as v,i as b,B as I,v as P}from"./index-39233d5b.js";const Q={class:"mx-auto px-4 max-w-[1500px]"},X={key:0,class:"flex justify-center items-center py-16"},Y={key:1,class:"text-center py-16 text-red-600"},Z={class:"text-lg font-semibold"},tt={key:2,class:"m-auto max-w-7xl"},et={class:"font-bold font-sans text-gray-600 lg:mt-4 xs:mt-2 xs:text-lg text-center sm:text-xl md:text-2xl lg:text-3xl"},st={class:"mt-6 grid gap-x-4 gap-y-8 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-5"},at=["onClick","aria-label"],it={class:"w-full overflow-hidden rounded-xl shadow-sm relative bg-gray-100 aspect-square"},ot=["src","alt"],nt=["onClick","aria-label","title"],lt={class:"p-4 w-full"},rt={class:"font-sans text-gray-800 font-medium xs:text-sm sm:text-base md:text-lg w-full truncate"},dt={key:0,class:"font-sans text-gray-600 text-sm w-full truncate"},ct={class:"flex items-center w-full justify-between mt-1"},ut={class:"font-sans text-[#E39F30] font-semibold text-lg"},gt=["disabled","onClick","aria-label","title"],_t={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ft={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},mt={key:0,class:"flex justify-center items-center pt-8"},ht={class:"inline-flex gap-2","aria-label":"Pagination"},vt=["onClick","aria-current"],pt="/placeholder.jpg",wt={__name:"customtap-products",props:{title:{type:String,default:""}},setup(j){const{t:d}=N(),S=_(localStorage.getItem("appLang")||"ar"),p=U(),z=_([]),k=_(!0),w=_(null),x=W(),g=G(),y=_({current_page:1,last_page:1,next_page_url:null,prev_page_url:null,links:[]}),f=_(parseInt(g.query.page)||1),L=_(!1),C=()=>{typeof window<"u"&&(L.value=window.innerWidth<768)},F=J(()=>L.value?10:20);A(()=>{C(),typeof window<"u"&&window.addEventListener("resize",C)}),K(()=>{typeof window<"u"&&window.removeEventListener("resize",C)});const h=async(s,e=1)=>{k.value=!0,w.value=null;const t=`/api/home/products?limit=${F.value}&page=${e}`;try{const c=(await b.get(t)).data.data,l=c.data?c:c.details||c;y.value={current_page:l.current_page,last_page:l.last_page,next_page_url:l.next_page_url,prev_page_url:l.prev_page_url,links:l.links},f.value=l.current_page,z.value=(l.data||[]).map(i=>{var M,$;return{id:i.id,name:S.value==="ar"?i.name_ar||i.name_en:i.name_en||i.name_ar,sub_name:S.value==="ar"?i.sub_name_ar||i.sub_name_en:i.sub_name_en||i.sub_name_ar,price:i.base_price,img:(($=(M=i.media)==null?void 0:M.find(H=>H.name==="product_main_image"))==null?void 0:$.url)||i.key_default_image||pt,is_wished:i.is_wished||!1,in_cart:i.in_cart||!1,isOutOfStock:i.is_stock===0,variant_id:i.has_variants?i.variant_id:null}})}catch(r){console.error("Error fetching products:",r),w.value=d("error.fetchFailed")||"Failed to load products."}finally{k.value=!1,x.push({query:{...g.query,page:f.value}}).catch(()=>{})}},q=s=>{x.push({name:"Product-details",params:{id:s}})},R=s=>{s>=1&&s<=y.value.last_page&&h(g.params.id,s)},D=async s=>{if(!p.authenticatedweb){x.push({name:"AuthLogin"});return}if(!s.isOutOfStock)try{const e={product_id:s.id,variant_id:s.variant_id,quantity:1};(await b.post("/api/cart/add",e)).status===200&&(s.in_cart=!0,alert(d("cart.added")||"Product added to cart!"))}catch(e){console.error("Error adding to cart:",e),alert(d("cart.error")||"Failed to add product to cart.")}},V=async s=>{if(!p.authenticatedweb){x.push({name:"AuthLogin"});return}const e=s.is_wished,t=e?"delete":"post",r=e?`/api/wishlists/${s.id}`:"/api/wishlists",c={product_id:s.id};try{let l;t==="post"?l=await b.post(r,c):l=await b.delete(r,{data:c}),(l.status===200||l.status===204)&&(s.is_wished=!e,alert(d(e?"wishlist.removed":"wishlist.added")||`Product ${e?"removed from":"added to"} wishlist!`))}catch(l){console.error("Error toggling favorite status:",l),s.is_wished=e,alert(d("wishlist.error")||"Failed to update wishlist.")}};return A(()=>{h(g.params.id,f.value)}),B(()=>g.params.id,s=>{f.value=1,h(s,1)}),B(F,(s,e)=>{s!==e&&(f.value=1,h(g.params.id,1))}),(s,e)=>(o(),n("div",Q,[k.value?(o(),n("div",X,e[1]||(e[1]=[a("svg",{class:"animate-spin h-8 w-8 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):w.value?(o(),n("div",Y,[a("p",Z,u(w.value),1),a("button",{onClick:e[0]||(e[0]=t=>h(m(g).params.id,f.value)),class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},u(m(d)("products.retry")||"Retry"),1)])):(o(),n("div",tt,[a("h2",et,u(j.title||m(d)("products.allProducts")||"Products"),1),a("div",st,[(o(!0),n(O,null,E(z.value,t=>(o(),n("div",{key:t.id,class:"group flex flex-col items-start cursor-pointer transition-all pb-[1%] rounded-lg shadow-lg duration-300 hover:-translate-y-2 h-auto",onClick:r=>q(t.id),"aria-label":`View product ${t.name}`},[a("div",it,[a("img",{src:t.img,alt:t.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,ot),e[3]||(e[3]=a("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1)),m(p).authenticatedweb?(o(),n("button",{key:0,class:"absolute top-2 right-2 p-2 rounded-full bg-white text-gray-500 hover:text-red-500 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 z-10",onClick:I(r=>V(t),["stop"]),"aria-label":t.is_wished?"Remove from wishlist":"Add to wishlist",title:t.is_wished?"Remove from wishlist":"Add to wishlist"},[(o(),n("svg",{class:P(["w-5 h-5",{"text-red-500":t.is_wished}]),fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e[2]||(e[2]=[a("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)]),2))],8,nt)):v("",!0)]),a("div",lt,[a("p",rt,u(t.name),1),t.sub_name?(o(),n("p",dt,u(t.sub_name),1)):v("",!0),a("div",ct,[a("span",ut,u(t.price)+" "+u(m(d)("currencyLabel")),1),m(p).authenticatedweb?(o(),n("button",{key:0,class:P(["p-2 rounded-full bg-gray-100 text-[#E39F30] transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:ring-offset-2",{"hover:bg-indigo-600 hover:text-white":!t.in_cart&&!t.isOutOfStock,"bg-gray-300 text-gray-500 cursor-not-allowed":t.isOutOfStock}]),disabled:t.isOutOfStock,onClick:I(r=>D(t),["stop"]),"aria-label":t.in_cart?"In cart":t.isOutOfStock?"Out of stock":"Add to cart",title:t.in_cart?"In cart":t.isOutOfStock?"Out of stock":"Add to cart"},[t.in_cart?(o(),n("svg",_t,e[4]||(e[4]=[a("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):(o(),n("svg",ft,e[5]||(e[5]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])))],10,gt)):v("",!0)])])],8,at))),128))]),y.value.last_page>1?(o(),n("div",mt,[a("nav",ht,[(o(!0),n(O,null,E(y.value.links,(t,r)=>(o(),n(O,{key:r},[t.url&&!["« Previous","Next »"].includes(t.label)?(o(),n("button",{key:0,onClick:c=>R(parseInt(t.label)),"aria-current":t.active?"page":void 0,class:P(["px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200",t.active?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-indigo-100 hover:text-indigo-700"])},u(t.label),11,vt)):v("",!0)],64))),128))])])):v("",!0)]))]))}},yt=T(wt,[["__scopeId","data-v-2d69624c"]]);export{yt as default};
