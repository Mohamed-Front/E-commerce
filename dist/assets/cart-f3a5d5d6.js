import{_ as A,j as I,r as l,H as D,l as j,o as H,a as n,c as d,f as e,I as E,R as N,F as $,d as T,q as V,t as o,J as U,h as J,e as K,i as m,K as L}from"./index-18453617.js";const O="/assets/prand 1-7db5856b.png";const P={class:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 font-inter"},Q={class:"flex lg:flex-row flex-col gap-10"},R={class:"flex-1 bg-white rounded-2xl shadow-lg p-6"},G={key:0,class:"flex justify-center items-center py-4"},W={key:1},X={class:"mb-6"},Y=["value"],Z={class:"flex items-center gap-4 mb-6"},ee={key:0,class:"text-center text-gray-600 py-4"},te=["src","alt"],se={class:"flex flex-col mx-4 gap-2 flex-1"},ae={class:"text-lg font-bold text-gray-800"},oe={class:"text-yellow-600 text-sm"},le={class:"flex items-center justify-between"},ie={class:"text-yellow-600 text-sm"},re={class:"border border-gray-300 p-2 rounded-md flex items-center gap-3"},ne=["onClick"],de={class:"text-sm font-medium"},ce=["onClick"],ue=["onClick"],ye={class:"bg-gray-100 p-6 mt-6 rounded-lg shadow-inner"},me={class:"flex flex-col gap-4"},pe={class:"flex justify-between items-center"},fe={class:"text-gray-700"},ve={class:"flex justify-between items-center"},_e={class:"text-gray-700"},xe={class:"flex justify-between items-center"},ge={class:"text-gray-700"},be=["disabled"],he={class:"lg:w-1/4 w-full p-6 bg-white rounded-2xl shadow-lg"},we={class:"flex flex-col gap-4"},ke={class:"flex justify-between items-center"},Ce={class:"text-gray-700"},qe={class:"flex justify-between items-center"},Fe={class:"text-gray-700"},je={class:"flex justify-between items-center"},Ee={class:"text-gray-700"},$e={class:"flex flex-col mt-6"},Te=["disabled"],Ve={__name:"cart",setup(Be){I(),l("Store 1");const p=l(""),b=l(0),c=l([]),x=l(!0),r=D(),h=l(0),w=l(0),f=l([]),u=l(null),y=l(!1),B=async()=>{try{const a=await m.get("/api/address");a.data.is_success&&(f.value=a.data.data.data,f.value.length>0&&(u.value=f.value[0].id))}catch(a){r.add({severity:"error",summary:"خطأ",detail:"فشل تحميل العناوين",life:3e3}),console.error("Error fetching addresses:",a)}},M=async()=>{try{x.value=!0;const a=await m.get("/api/cart");a.data.is_success&&(c.value=a.data.data.items.map(t=>({id:t.id,product_id:t.product.id,variant_id:t.variant.id,name:t.product.name_ar||t.product.name_en,img:t.product.key_default_image||O,price:parseFloat(t.variant.price)||parseFloat(t.product.base_price)||0,quantity:t.quantity})),await v())}catch(a){r.add({severity:"error",summary:"خطأ",detail:"فشل تحميل بيانات سلة التسوق",life:3e3}),console.error("Error fetching cart:",a)}finally{x.value=!1}},v=async()=>{try{const a={is_expressed:y.value,address_id:u.value,view:!0,items:c.value.map(s=>({product_id:s.product_id,variant_id:s.variant_id,quantity:s.quantity}))};p.value&&(a.coupon=p.value);const t=await m.post("/api/order/view",a);t.data.is_success&&(h.value=parseFloat(t.data.data.subtotal||0).toFixed(2),b.value=parseFloat(t.data.data.shipping_fee||0).toFixed(2),w.value=parseFloat(t.data.data.total||0).toFixed(2))}catch(a){r.add({severity:"error",summary:"خطأ",detail:"فشل تحميل إجمالي الطلب",life:3e3}),console.error("Error fetching order totals:",a)}},S=async()=>{try{await v(),r.add({severity:"success",summary:"نجاح",detail:"تم تطبيق كود الخصم",life:3e3})}catch(a){r.add({severity:"error",summary:"خطأ",detail:"فشل تطبيق كود الخصم",life:3e3}),console.error("Error applying coupon:",a)}},k=async(a,t,s,i,F)=>{const _=c.value.find(g=>g.id===t);if(_)try{a==="plus"?(await m.post("/api/cart/update",{product_id:s,variant_id:i,quantity:F+1}),_.quantity+=1):a==="minus"&&_.quantity>1&&(await m.post("/api/cart/update",{product_id:s,variant_id:i,quantity:F-1}),_.quantity-=1),await v()}catch(g){r.add({severity:"error",summary:"خطأ",detail:`فشل ${a==="plus"?"زيادة":"تقليل"} الكمية`,life:3e3}),console.error(`Error ${a==="plus"?"increasing":"decreasing"} quantity:`,g)}},z=async(a,t,s)=>{try{await m.delete("/api/cart/clear",{data:{product_id:t,variant_id:s}}),c.value=c.value.filter(i=>i.id!==a),await v(),r.add({severity:"success",summary:"نجاح",detail:"تم إزالة المنتج من السلة",life:3e3})}catch(i){r.add({severity:"error",summary:"خطأ",detail:"فشل إزالة المنتج من السلة",life:3e3}),console.error("Error clearing product:",i)}},C=j(()=>h.value),q=j(()=>w.value);return H(()=>{B(),M()}),(a,t)=>(n(),d("div",P,[e("div",Q,[e("section",R,[x.value?(n(),d("div",G,t[3]||(t[3]=[e("svg",{class:"animate-spin h-8 w-8 text-yellow-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):(n(),d("div",W,[e("div",X,[t[5]||(t[5]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"اختر عنوان التوصيل",-1)),E(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),class:"w-full bg-amber-50 border border-amber-200 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-600 transition-all"},[t[4]||(t[4]=e("option",{value:null,disabled:""},"اختر عنوان",-1)),(n(!0),d($,null,T(f.value,s=>(n(),d("option",{key:s.id,value:s.id},o(s.name)+" - "+o(s.street)+", "+o(s.city),9,Y))),128))],512),[[N,u.value]])]),e("div",Z,[t[6]||(t[6]=e("label",{class:"text-gray-800 font-medium"},"توصيل سريع",-1)),e("button",{onClick:t[1]||(t[1]=s=>y.value=!y.value),class:V(["relative inline-flex items-center h-6 rounded-full transition-colors duration-200",y.value?"bg-yellow-600":"bg-gray-300"])},[e("span",{class:V(["inline-block h-4 transform bg-white rounded-full transition-transform duration-200",y.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),c.value.length===0?(n(),d("div",ee," سلة التسوق فارغة ")):(n(!0),d($,{key:1},T(c.value,s=>(n(),d("div",{key:s.id,class:"flex items-center mt-6 bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300"},[e("img",{src:s.img,alt:s.name,class:"w-16 h-16 md:w-20 md:h-20 lg:w-28 lg:h-28 object-cover rounded-md border border-gray-800"},null,8,te),e("div",se,[e("h3",ae,o(s.name),1),e("p",oe,"السعر: "+o(s.price)+" د.أ",1),e("div",le,[e("p",ie,"الكمية: "+o(s.quantity),1),e("div",re,[e("button",{onClick:i=>k("minus",s.id,s.product_id,s.variant_id,s.quantity),class:"text-lg font-semibold text-gray-700 hover:text-yellow-600 transition-colors"},"-",8,ne),e("span",de,o(s.quantity),1),e("button",{onClick:i=>k("plus",s.id,s.product_id,s.variant_id,s.quantity),class:"text-lg font-semibold text-gray-700 hover:text-yellow-600 transition-colors"},"+",8,ce)]),e("button",{onClick:i=>z(s.id,s.product_id,s.variant_id),class:"text-white bg-yellow-600 px-3 py-1 text-sm rounded-md hover:bg-yellow-700 transition-all"},o(a.$t("remove")),9,ue)])])]))),128)),e("div",ye,[e("div",me,[e("span",pe,[t[7]||(t[7]=e("h4",{class:"text-yellow-600 font-semibold"},"مدة الشحن",-1)),e("p",fe,o(y.value?"1 ساعة":"3 ساعات"),1)]),e("span",ve,[t[8]||(t[8]=e("h4",{class:"text-yellow-600 font-semibold"},"المجموع الفرعي",-1)),e("p",_e,o(C.value)+" د.أ",1)]),e("span",xe,[t[9]||(t[9]=e("h4",{class:"text-yellow-600 font-semibold"},"الإجمالي",-1)),e("p",ge,o(q.value)+" د.أ",1)])]),e("button",{disabled:!u.value,class:"w-full mt-6 py-3 text-sm sm:text-base lg:text-lg bg-gray-800 rounded-md text-white font-semibold transition-transform duration-150 hover:shadow-lg active:scale-95 disabled:bg-gray-400 disabled:cursor-not-allowed"}," إتمام الشراء ",8,be)])]))]),e("section",he,[e("div",we,[e("span",ke,[t[10]||(t[10]=e("h4",{class:"text-yellow-600 font-semibold"},"المجموع الفرعي",-1)),e("p",Ce,o(C.value)+" د.أ",1)]),e("span",qe,[t[11]||(t[11]=e("h4",{class:"text-yellow-600 font-semibold"},"رسوم الشحن",-1)),e("p",Fe,o(b.value)+" د.أ",1)]),e("span",je,[t[12]||(t[12]=e("h4",{class:"text-yellow-600 font-semibold"},"الإجمالي",-1)),e("p",Ee,o(q.value)+" د.أ",1)])]),e("div",$e,[E(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),type:"text",placeholder:"كود الخصم",class:"bg-amber-50 placeholder-yellow-600 border border-amber-200 rounded-md w-full px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-600 transition-all"},null,512),[[U,p.value]]),e("button",{onClick:S,class:"w-full mt-4 py-2 text-sm bg-amber-100 rounded-md text-yellow-600 font-semibold hover:bg-amber-200 transition-all active:scale-95"}," تطبيق "),e("button",{disabled:!u.value,class:"w-full mt-4 py-2 text-sm bg-gray-800 rounded-md text-white font-semibold hover:shadow-lg transition-all active:scale-95 disabled:bg-gray-400 disabled:cursor-not-allowed"}," إتمام الشراء الكلي ",8,Te)])])]),J(K(L))]))}},Se=A(Ve,[["__scopeId","data-v-e8007cf6"]]);export{Se as default};
