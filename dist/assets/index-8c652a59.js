import{_ as $,r as u,d as R,v as l,S,x as h,o as _,e as y,f as o,g as s,i as d,a as D,F as z,h as A,c as F,p as M,t as j}from"./index-89b558a5.js";const H={class:"permissions-container"},K={class:"card"},L={class:"toolbar"},O={class:"description-cell"},q={class:"p-fluid"},G={class:"p-field"},J={class:"p-field"},Q={__name:"index",setup(W){const w=u({}),b=u([]),r=u(!0),f=u(0),m=u(!1),c=u({id:"",name:"",description:""}),C=t=>{const e=[];for(const[i,p]of Object.entries(t))e.push({name:i.charAt(0).toUpperCase()+i.slice(1),value:i,permissions:p});return e.sort((i,p)=>i.name.localeCompare(p.name)),e},v=()=>{r.value=!0,D.get("api/role/get/permissions").then(t=>{w.value=t.data.data,b.value=C(t.data.data),r.value=!1}).catch(t=>{console.error("Error fetching permissions:",t),r.value=!1})},g=t=>{m.value=!0,c.value={id:t.id,name:t.name,description:t.description||""}},T=()=>{r.value=!0,D.put(`/api/role/permission/${c.value.id}`,{description:c.value.description}).then(()=>{v(),m.value=!1}).catch(t=>{console.error("Update failed:",t)}).finally(()=>{r.value=!1})};return R(()=>{v()}),(t,e)=>{const i=l("Button"),p=l("Column"),k=l("Tag"),V=l("DataTable"),N=l("TabPanel"),P=l("TabView"),I=l("InputText"),U=l("Textarea"),B=l("Dialog"),x=S("can");return h((_(),y("div",H,[o("div",K,[e[8]||(e[8]=o("div",{class:"header"},[o("h1",null,"Permissions Management"),o("p",{class:"subtitle"},"View and manage all system permissions grouped by modules")],-1)),o("div",L,[s(i,{icon:"pi pi-refresh",label:"Refresh",onClick:v,loading:r.value},null,8,["loading"])]),s(P,{activeIndex:f.value,"onUpdate:activeIndex":e[0]||(e[0]=n=>f.value=n),class:"grouped-tabs"},{default:d(()=>[(_(!0),y(z,null,A(b.value,n=>(_(),F(N,{key:n.value,header:n.name},{default:d(()=>[s(V,{value:n.permissions,stripedRows:"",class:"p-datatable-sm",loading:r.value,dataKey:"id",scrollable:"",scrollHeight:"flex"},{empty:d(()=>e[5]||(e[5]=[o("div",{class:"empty-message"},[o("i",{class:"pi pi-database",style:{"font-size":"2rem"}}),o("p",null,"No permissions found in this group")],-1)])),default:d(()=>[s(p,{field:"id",header:"ID",sortable:"",style:{width:"80px"}}),s(p,{field:"name",header:"Name",sortable:""},{body:d(({data:a})=>[s(k,{value:a.name,severity:a.name.includes("delete")?"danger":a.name.includes("edit")?"warning":a.name.includes("create")?"success":"info"},null,8,["value","severity"])]),_:1}),s(p,{field:"description",header:"Description"},{body:d(({data:a})=>[o("div",O,[M(j(a.description||"No description")+" ",1),h(s(i,{icon:"pi pi-pencil",class:"p-button-rounded p-button-text p-button-sm",onClick:E=>g(a)},null,8,["onClick"]),[[x,"edit permissions"]])])]),_:1}),s(p,{header:"Actions",style:{width:"100px"}},{body:d(({data:a})=>[s(i,{icon:"pi pi-cog",class:"p-button-rounded p-button-text p-button-sm",onClick:E=>g(a)},null,8,["onClick"])]),_:1})]),_:2},1032,["value","loading"])]),_:2},1032,["header"]))),128))]),_:1},8,["activeIndex"]),s(B,{visible:m.value,"onUpdate:visible":e[4]||(e[4]=n=>m.value=n),modal:"",header:"Update Permission Description",style:{width:"50vw"},breakpoints:{"960px":"75vw","640px":"90vw"}},{footer:d(()=>[s(i,{label:"Cancel",icon:"pi pi-times",onClick:e[3]||(e[3]=n=>m.value=!1),class:"p-button-text"}),s(i,{label:"Save",icon:"pi pi-check",onClick:T,loading:r.value,autofocus:""},null,8,["loading"])]),default:d(()=>[o("div",q,[o("div",G,[e[6]||(e[6]=o("label",{for:"permissionName"},"Permission Name",-1)),s(I,{id:"permissionName",modelValue:c.value.name,"onUpdate:modelValue":e[1]||(e[1]=n=>c.value.name=n),disabled:""},null,8,["modelValue"])]),o("div",J,[e[7]||(e[7]=o("label",{for:"description"},"Description",-1)),s(U,{id:"description",modelValue:c.value.description,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value.description=n),rows:"5",autoResize:"",placeholder:"Enter permission description..."},null,8,["modelValue"])])])]),_:1},8,["visible"])])])),[[x,"list permissions"]])}}},Y=$(Q,[["__scopeId","data-v-3e5d677e"]]);export{Y as default};
