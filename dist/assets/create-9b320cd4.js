import{u as le,f as re,G as ne,r as m,A as I,o as ie,h as f,i as de,l as ue,b as y,c as h,j as e,t as n,B as l,q as b,e as i,F as E,v as P,n as ce,D as S,s as pe,k as _e,a as U}from"./index-2ff8cefd.js";const me=["dir"],be={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ve=["onSubmit"],ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},fe={class:"space-y-2"},ye={for:"store_id",class:"block text-sm font-medium text-gray-700"},he=e("span",{class:"text-red-500"},"*",-1),xe={class:"space-y-2"},Ve={for:"category_id",class:"block text-sm font-medium text-gray-700"},ke=e("span",{class:"text-red-500"},"*",-1),we={class:"space-y-2"},Ue={for:"brand_id",class:"block text-sm font-medium text-gray-700"},De=e("span",{class:"text-red-500"},"*",-1),Le={class:"space-y-2"},Ce={for:"name_en",class:"block text-sm font-medium text-gray-700"},Fe=e("span",{class:"text-red-500"},"*",-1),Ie={class:"space-y-2"},Se={for:"name_ar",class:"block text-sm font-medium text-gray-700"},Te=e("span",{class:"text-red-500"},"*",-1),Be={class:"space-y-2"},Ne={for:"sub_name_en",class:"block text-sm font-medium text-gray-700"},je={class:"space-y-2"},Ae={for:"sub_name_ar",class:"block text-sm font-medium text-gray-700"},qe={class:"md:col-span-2 space-y-2"},Ee={for:"description_en",class:"block text-sm font-medium text-gray-700"},Pe={class:"md:col-span-2 space-y-2"},Re={for:"description_ar",class:"block text-sm font-medium text-gray-700"},Me={class:"space-y-2"},ze={for:"tax",class:"block text-sm font-medium text-gray-700"},Ge={class:"space-y-2"},Oe={for:"is_displayed",class:"block text-sm font-medium text-gray-700"},$e={class:"space-y-2"},Je={for:"base_price",class:"block text-sm font-medium text-gray-700"},He=e("span",{class:"text-red-500"},"*",-1),Ke={class:"space-y-2"},Qe={for:"cost_price",class:"block text-sm font-medium text-gray-700"},We={class:"md:col-span-2 space-y-2"},Xe={for:"hasVariants",class:"ml-2 text-sm font-medium text-gray-700"},Ye={key:1,class:"md:col-span-2 space-y-4"},Ze={class:"block text-sm font-medium text-gray-700"},et={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},tt={class:"space-y-2"},at=["for"],st=e("span",{class:"text-red-500"},"*",-1),ot={class:"space-y-2"},lt=["for"],rt=e("span",{class:"text-red-500"},"*",-1),nt={class:"space-y-2"},it=["for"],dt=e("span",{class:"text-red-500"},"*",-1),ut={class:"space-y-2"},ct=["for"],pt={class:"space-y-2"},_t=["for"],mt=e("span",{class:"text-red-500"},"*",-1),bt={class:"md:col-span-2 space-y-2"},vt={class:"block text-sm font-medium text-gray-700"},gt={class:"flex justify-center"},ft=["onDragover","onDrop"],yt={key:0,class:"p-4"},ht={class:"relative group"},xt=["src"],Vt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},kt={class:"opacity-0 group-hover:opacity-100 space-x-3 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0"},wt=["onClick","title"],Ut=e("i",{class:"pi pi-trash text-sm"},null,-1),Dt=[Ut],Lt=["title"],Ct=e("i",{class:"pi pi-pencil text-sm"},null,-1),Ft=[Ct],It={class:"mt-2 text-center text-sm text-gray-500"},St={key:1,class:"p-8 flex flex-col items-center justify-center"},Tt=e("div",{class:"bg-blue-100 p-4 rounded-full mb-4"},[e("i",{class:"pi pi-image text-blue-500 text-2xl"})],-1),Bt={class:"text-sm text-center text-gray-600 mb-1"},Nt={class:"text-blue-500 font-medium"},jt={class:"text-xs text-gray-400"},At={class:"pt-4 flex justify-center space-x-4"},qt={key:0},Et={key:1,class:"pi pi-spinner pi-spin"},Mt={setup(Pt){const T=le(),u=re(),{t:a}=ne();m();const x=m(!1),D=m(null),L=m(null),V=m(!1),B=m([]),N=m([]),j=m([]),A=m([]),v=m(!1),C=I(()=>localStorage.getItem("appLang")||"en"),k=I(()=>C.value==="en"?"name_en":"name_ar"),R=I(()=>C.value==="ar"),s=m({store_id:null,category_id:null,brand_id:null,name_en:"",name_ar:"",sub_name_en:"",sub_name_ar:"",description_en:"",description_ar:"",base_price:null,cost_price:null,tax:0,is_displayed:!0,variants:[]}),M=I(()=>A.value.map(r=>({label:C.value==="en"?r.name_en:r.name_ar,items:r.values.map(t=>({id:t.id,[k.value]:C.value==="en"?t.value_en:t.value_ar}))}))),z=async()=>{try{const r=await U.get("/api/store");B.value=r.data.data.data}catch{u.add({severity:"error",summary:a("error"),detail:a("error.storeLoad"),life:3e3})}},G=async()=>{try{const r=await U.get("/api/category");N.value=r.data.data.data}catch{u.add({severity:"error",summary:a("error"),detail:a("error.categoryLoad"),life:3e3})}},O=async()=>{try{const r=await U.get("/api/brand");j.value=r.data.data.data}catch{u.add({severity:"error",summary:a("error"),detail:a("error.brandLoad"),life:3e3})}},$=async()=>{try{const r=await U.get("/api/product/create/data");A.value=r.data.data}catch{u.add({severity:"error",summary:a("error"),detail:a("error.attributeLoad"),life:3e3})}};ie(()=>{z(),G(),O(),$()});const J=r=>{r.preventDefault(),V.value=!0},H=()=>{V.value=!1},K=r=>{if(r.size>2*1024*1024){u.add({severity:"error",summary:a("error"),detail:a("validation.imageSize"),life:3e3});return}if(!r.type.match("image.*")){u.add({severity:"error",summary:a("error"),detail:a("validation.imageInvalid"),life:3e3});return}D.value=r;const t=new FileReader;t.onload=_=>{L.value=_.target.result},t.readAsDataURL(r),V.value=!1},q=r=>{var _,c,d;const t=((_=r.target.files)==null?void 0:_[0])||((d=(c=r.dataTransfer)==null?void 0:c.files)==null?void 0:d[0]);t&&K(t)},Q=()=>{D.value=null,L.value=null},W=()=>{v.value=!v.value,v.value&&!s.value.variants.length?s.value.variants.push({sku_ar:"",sku_en:"",price:"",cost_price:null,attribute_value_ids:[]}):v.value||(s.value.variants=[])},X=()=>{s.value.variants.push({sku_ar:"",sku_en:"",price:"",cost_price:null,attribute_value_ids:[]})},Y=r=>{s.value.variants.length>1?s.value.variants.splice(r,1):u.add({severity:"warn",summary:a("error"),detail:a("validation.atLeastOneVariant"),life:3e3})},Z=async()=>{var _,c;if(["store_id","category_id","brand_id","name_en","name_ar"].some(d=>!s.value[d])){u.add({severity:"error",summary:a("error"),detail:a("validation.requiredFields"),life:3e3});return}if(v.value){if(s.value.variants.some(d=>!d.sku_en||!d.sku_ar||!d.price||!d.attribute_value_ids.length)){u.add({severity:"error",summary:a("error"),detail:a("validation.variantRequiredFields"),life:3e3});return}}else if(!s.value.base_price){u.add({severity:"error",summary:a("error"),detail:a("validation.basePriceRequired"),life:3e3});return}x.value=!0;const t=new FormData;t.append("store_id",s.value.store_id),t.append("category_id",s.value.category_id),t.append("brand_id",s.value.brand_id),t.append("name_en",s.value.name_en),t.append("name_ar",s.value.name_ar),t.append("sub_name_en",s.value.sub_name_en||""),t.append("sub_name_ar",s.value.sub_name_ar||""),t.append("description_en",s.value.description_en||""),t.append("description_ar",s.value.description_ar||""),t.append("tax",s.value.tax),t.append("is_displayed",s.value.is_displayed?1:0),v.value?t.append("variants",JSON.stringify(s.value.variants)):(t.append("base_price",s.value.base_price),t.append("cost_price",s.value.cost_price||0)),D.value&&t.append("main_image",D.value),console.log(typeof t.variants);try{await U.post("/api/product",t,{headers:{"Content-Type":"multipart/form-data"}}),T.push({name:"product"}),u.add({severity:"success",summary:a("success"),detail:a("product.createSuccess"),life:3e3})}catch(d){u.add({severity:"error",summary:a("error"),detail:((c=(_=d.response)==null?void 0:_.data)==null?void 0:c.message)||a("error.createError"),life:3e3})}finally{x.value=!1}};return(r,t)=>{const _=f("Dropdown"),c=f("InputText"),d=f("Textarea"),w=f("InputNumber"),ee=f("InputSwitch"),te=f("Checkbox"),ae=f("MultiSelect"),F=f("Button"),se=f("Toast"),oe=de("can");return ue((y(),h("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:l(R)?"rtl":"ltr"},[e("h1",be,n(l(a)("product.createTitle")),1),e("form",{onSubmit:S(Z,["prevent"]),class:"space-y-6"},[e("div",ge,[e("div",fe,[e("label",ye,[b(n(l(a)("product.store"))+" ",1),he]),i(_,{id:"store_id",modelValue:s.value.store_id,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.store_id=o),options:B.value,optionLabel:l(k),optionValue:"id",class:"w-full"},null,8,["modelValue","options","optionLabel"])]),e("div",xe,[e("label",Ve,[b(n(l(a)("product.category"))+" ",1),ke]),i(_,{id:"category_id",modelValue:s.value.category_id,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.category_id=o),options:N.value,optionLabel:l(k),optionValue:"id",class:"w-full"},null,8,["modelValue","options","optionLabel"])]),e("div",we,[e("label",Ue,[b(n(l(a)("product.brand"))+" ",1),De]),i(_,{id:"brand_id",modelValue:s.value.brand_id,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.brand_id=o),options:j.value,optionLabel:l(k),optionValue:"id",class:"w-full"},null,8,["modelValue","options","optionLabel"])]),e("div",Le,[e("label",Ce,[b(n(l(a)("product.nameEn"))+" ",1),Fe]),i(c,{id:"name_en",modelValue:s.value.name_en,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.name_en=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",Ie,[e("label",Se,[b(n(l(a)("product.nameAr"))+" ",1),Te]),i(c,{id:"name_ar",modelValue:s.value.name_ar,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.name_ar=o),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",Be,[e("label",Ne,n(l(a)("product.subNameEn")),1),i(c,{id:"sub_name_en",modelValue:s.value.sub_name_en,"onUpdate:modelValue":t[5]||(t[5]=o=>s.value.sub_name_en=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",je,[e("label",Ae,n(l(a)("product.subNameAr")),1),i(c,{id:"sub_name_ar",modelValue:s.value.sub_name_ar,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.sub_name_ar=o),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",qe,[e("label",Ee,n(l(a)("product.descriptionEn")),1),i(d,{id:"description_en",modelValue:s.value.description_en,"onUpdate:modelValue":t[7]||(t[7]=o=>s.value.description_en=o),rows:"4",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",Pe,[e("label",Re,n(l(a)("product.descriptionAr")),1),i(d,{id:"description_ar",modelValue:s.value.description_ar,"onUpdate:modelValue":t[8]||(t[8]=o=>s.value.description_ar=o),rows:"4",dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),e("div",Me,[e("label",ze,n(l(a)("product.tax"))+" (%) ",1),i(w,{id:"tax",modelValue:s.value.tax,"onUpdate:modelValue":t[9]||(t[9]=o=>s.value.tax=o),mode:"decimal",min:0,max:100,minFractionDigits:2,class:"w-full"},null,8,["modelValue"])]),e("div",Ge,[e("label",Oe,n(l(a)("product.displayStatus")),1),i(ee,{id:"is_displayed",modelValue:s.value.is_displayed,"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.is_displayed=o)},null,8,["modelValue"])]),v.value?P("",!0):(y(),h(E,{key:0},[e("div",$e,[e("label",Je,[b(n(l(a)("product.basePrice"))+" ",1),He]),i(w,{id:"base_price",modelValue:s.value.base_price,"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.base_price=o),mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["modelValue"])]),e("div",Ke,[e("label",Qe,n(l(a)("product.costPrice")),1),i(w,{id:"cost_price",modelValue:s.value.cost_price,"onUpdate:modelValue":t[12]||(t[12]=o=>s.value.cost_price=o),mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["modelValue"])])],64)),e("div",We,[i(te,{modelValue:v.value,"onUpdate:modelValue":t[13]||(t[13]=o=>v.value=o),inputId:"hasVariants",binary:!0,onClick:W},null,8,["modelValue"]),e("label",Xe,n(l(a)("product.hasVariants")),1)]),v.value?(y(),h("div",Ye,[e("label",Ze,n(l(a)("product.variants")),1),(y(!0),h(E,null,ce(s.value.variants,(o,p)=>(y(),h("div",{key:p,class:"p-4 border rounded-lg space-y-4"},[e("div",et,[e("div",tt,[e("label",{for:"sku_en_"+p,class:"block text-sm font-medium text-gray-700"},[b(n(l(a)("product.skuEn"))+" ",1),st],8,at),i(c,{id:"sku_en_"+p,modelValue:o.sku_en,"onUpdate:modelValue":g=>o.sku_en=g,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"])]),e("div",ot,[e("label",{for:"sku_ar_"+p,class:"block text-sm font-medium text-gray-700"},[b(n(l(a)("product.skuAr"))+" ",1),rt],8,lt),i(c,{id:"sku_ar_"+p,modelValue:o.sku_ar,"onUpdate:modelValue":g=>o.sku_ar=g,dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"])]),e("div",nt,[e("label",{for:"price_"+p,class:"block text-sm font-medium text-gray-700"},[b(n(l(a)("product.price"))+" ",1),dt],8,it),i(w,{id:"price_"+p,modelValue:o.price,"onUpdate:modelValue":g=>o.price=g,mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue"])]),e("div",ut,[e("label",{for:"cost_price_"+p,class:"block text-sm font-medium text-gray-700"},n(l(a)("product.costPrice")),9,ct),i(w,{id:"cost_price_"+p,modelValue:o.cost_price,"onUpdate:modelValue":g=>o.cost_price=g,mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue"])]),e("div",pt,[e("label",{for:"attributes_"+p,class:"block text-sm font-medium text-gray-700"},[b(n(l(a)("product.attributes"))+" ",1),mt],8,_t),i(ae,{id:"attributes_"+p,modelValue:o.attribute_value_ids,"onUpdate:modelValue":g=>o.attribute_value_ids=g,options:l(M),optionGroupLabel:"label",optionGroupChildren:"items",optionLabel:l(k),optionValue:"id",class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue","options","optionLabel"])])]),i(F,{type:"button",icon:"pi pi-trash",class:"p-button-danger",onClick:g=>Y(p),disabled:s.value.variants.length===1},null,8,["onClick","disabled"])]))),128)),i(F,{type:"button",label:l(a)("product.addVariant"),icon:"pi pi-plus",class:"p-button-secondary",onClick:X},null,8,["label"])])):P("",!0),e("div",bt,[e("label",vt,n(l(a)("product.image")),1),e("div",gt,[e("label",{onDragover:S(J,["prevent"]),onDragleave:H,onDrop:S(q,["prevent"]),class:pe([{"border-blue-500 bg-blue-50":V.value,"border-gray-300":!V.value},"cursor-pointer w-full max-w-md rounded-xl border-2 border-dashed transition-colors duration-300"])},[e("input",{type:"file",onChange:q,accept:"image/*",class:"hidden"},null,32),L.value?(y(),h("div",yt,[e("div",ht,[e("img",{src:L.value,alt:"Preview",class:"w-full h-64 object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,xt),e("div",Vt,[e("div",kt,[e("button",{type:"button",onClick:S(Q,["stop"]),class:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition",title:l(a)("product.deleteImage")},Dt,8,wt),e("button",{type:"button",class:"bg-white text-gray-700 p-2 rounded-full hover:bg-gray-100 transition",title:l(a)("product.editImage")},Ft,8,Lt)])])]),e("p",It,n(l(a)("product.changeImage")),1)])):(y(),h("div",St,[Tt,e("p",Bt,[e("span",Nt,n(l(a)("product.uploadClick")),1),b(" "+n(l(a)("product.uploadDrag")),1)]),e("p",jt,n(l(a)("product.imageFormat")),1)]))],42,ft)])])]),e("div",At,[i(F,{type:"button",label:l(a)("product.cancelButton"),icon:"pi pi-times",onClick:t[14]||(t[14]=o=>l(T).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:x.value},null,8,["label","disabled"]),i(F,{type:"submit",label:l(a)("product.createButton"),icon:"pi pi-plus",loading:x.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:x.value},{default:_e(()=>[x.value?(y(),h("i",Et)):(y(),h("span",qt,n(l(a)("product.createButton")),1))]),_:1},8,["label","loading","disabled"])])],40,ve),i(se)],8,me)),[[oe,"create products"]])}}};export{Mt as default};
