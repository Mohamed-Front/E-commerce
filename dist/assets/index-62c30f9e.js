import{b as K,L as O,u as ee,r as l,w as te,d as ae,V as z,o as p,e as b,f as s,g as n,i as c,j as e,z as y,c as oe,t as r,F as L,h as se,a as F,X as le,Y as v,Z as ne,$ as ie,a0 as re,a1 as _,s as D,a6 as ce,a2 as de,x as ue,B as pe,a3 as ve,a5 as _e}from"./index-b794012a.js";const he={class:"grid"},ge={class:"col-12"},me={class:"card p-4 shadow-2 border-round"},fe={class:"text-2xl font-bold"},be={class:"flex gap-2"},ye={class:"p-input-icon-left"},xe=s("i",{class:"pi pi-search"},null,-1),we={class:"card shadow-1 surface-0"},ke={class:"text-center py-4"},Ce=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1),$e={class:"text-xl"},Ve={class:"flex justify-content-center align-items-center py-4"},De={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Pe={class:"p-paginator-left-content"},Ne={class:"p-paginator-current"},Ue={class:"p-paginator-right-content"},Ee=["disabled"],Re=s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1),Te=[Re],Be=["disabled"],Se=s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1),Ie=[Se],je=["onClick"],ze={key:1,class:"p-paginator-dots"},Le=["disabled"],Fe=s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1),Me=[Fe],Ge=["disabled"],Qe=s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1),We=[Qe],Xe={class:"flex align-items-center justify-content-center"},Ye=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1),He={setup(Ze){const P=K(),C=O(),{t:o}=ee(),x=l(!0),N=l([]),h=l(!1),U=l(null),E=l(null),M=l({}),w=l("");l(null);const d=l(1),$=l(0),u=l(10),k=l(0),G=l(""),Q=l(""),R=l(""),T=l(""),B=l(0),S=l(0),I=l([]),g=()=>{x.value=!0,F.get("/api/coupon",{params:{page:d.value,limit:u.value,search:w.value||void 0}}).then(t=>{N.value=t.data.data.data,$.value=t.data.data.total,k.value=t.data.data.last_page,G.value=t.data.data.first_page_url,Q.value=t.data.data.last_page_url,R.value=t.data.data.next_page_url,T.value=t.data.data.prev_page_url,B.value=t.data.data.from,S.value=t.data.data.to,I.value=t.data.data.links,x.value=!1}).catch(t=>{C.add({severity:"error",summary:o("error"),detail:o("coupon.loadError"),life:3e3}),x.value=!1,console.error("Error fetching coupons:",t)})};te([w,u],()=>{d.value=1,g()});const m=t=>{t>=1&&t<=k.value&&(d.value=t,g())},W=t=>{u.value=t.value,d.value=1,g()},X=t=>{U.value=t,h.value=!0},Y=()=>{F.delete(`/api/coupon/${U.value}`).then(()=>{C.add({severity:"success",summary:o("success"),detail:o("coupon.deleteSuccess"),life:3e3}),g(),h.value=!1}).catch(t=>{C.add({severity:"error",summary:o("error"),detail:o("coupon.deleteError"),life:3e3}),console.error("Error deleting coupon:",t)})},Z=()=>{E.value.exportCSV()},q=()=>{P.push({name:"coupon-create"})},A=t=>{P.push({name:"coupon-update",params:{id:t}})},H=t=>t===1?"success":"info",J=t=>t?new Date(t).toLocaleDateString():o("coupon.noExpiry");return ae(()=>{g()}),(t,i)=>{const f=z("can"),j=z("tooltip");return p(),b("div",he,[s("div",ge,[s("div",me,[n(e(ne),{class:"mb-4"},{start:c(()=>[s("h2",fe,r(e(o)("coupon.managementTitle")),1)]),end:c(()=>[s("div",be,[s("span",ye,[xe,n(e(le),{modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=a=>w.value=a),placeholder:e(o)("coupon.search")},null,8,["modelValue","placeholder"])]),y(n(e(v),{label:e(o)("coupon.export"),icon:"pi pi-upload",class:"p-export",onClick:Z},null,8,["label"]),[[f,"list coupons"]]),y(n(e(v),{label:e(o)("coupon.new"),icon:"pi pi-plus",class:"p-button-success",onClick:q},null,8,["label"]),[[f,"create coupons"]])])]),_:1}),n(e(ie)),s("div",we,[y((p(),oe(e(de),{ref_key:"dt",ref:E,value:N.value,loading:x.value,"data-key":"id",paginator:!1,rows:u.value,filters:M.value,totalRecords:$.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:c(()=>[s("div",ke,[Ce,s("p",$e,r(e(o)("coupon.noData")),1)])]),loading:c(()=>[s("div",Ve,[n(e(re),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:c(()=>[n(e(_),{"selection-mode":"multiple","header-style":"width: 3rem"}),n(e(_),{field:"code",header:e(o)("coupon.code"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(a=>[D(r(a.data.code),1)]),_:1},8,["header"]),n(e(_),{field:"discount_type_description",header:e(o)("coupon.type"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(a=>[n(e(ce),{value:a.data.discount_type_description,severity:H(a.data.discount_type)},null,8,["value","severity"])]),_:1},8,["header"]),n(e(_),{field:"discount_value",header:e(o)("coupon.value"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(a=>[D(r(a.data.discount_value),1)]),_:1},8,["header"]),n(e(_),{field:"expires_at",header:e(o)("coupon.expiry"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:c(a=>[D(r(J(a.data.expires_at)),1)]),_:1},8,["header"]),n(e(_),{header:e(o)("actions"),"header-style":"width: 12rem"},{body:c(a=>[y(n(e(v),{icon:"pi pi-pencil",class:"p-detail",onClick:V=>A(a.data.id)},null,8,["onClick"]),[[f,"edit coupons"],[j,e(o)("edit"),void 0,{top:!0}]]),y(n(e(v),{icon:"pi pi-trash mx-2",class:"p-delete",onClick:V=>X(a.data.id)},null,8,["onClick"]),[[f,"delete coupons"],[j,e(o)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[f,"list coupons"]]),s("div",De,[s("div",Pe,[s("span",Ne,r(e(o)("show"))+" "+r(B.value)+" "+r(e(o)("to"))+" "+r(S.value)+" "+r(e(o)("from"))+" "+r($.value),1)]),s("div",Ue,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:d.value===1,onClick:i[1]||(i[1]=a=>m(1))},Te,8,Ee),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!T.value,onClick:i[2]||(i[2]=a=>m(d.value-1))},Ie,8,Be),(p(!0),b(L,null,se(I.value,(a,V)=>(p(),b(L,{key:V},[a.label&&!isNaN(parseInt(a.label))?(p(),b("button",{key:0,class:ue(["p-paginator-page p-paginator-element p-link",{"p-highlight":a.active}]),onClick:qe=>m(parseInt(a.label))},r(a.label),11,je)):a.label==="..."?(p(),b("span",ze,"...")):pe("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!R.value,onClick:i[3]||(i[3]=a=>m(d.value+1))},Me,8,Le),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:d.value===k.value,onClick:i[4]||(i[4]=a=>m(k.value))},We,8,Ge),n(e(ve),{filter:"",modelValue:u.value,"onUpdate:modelValue":i[5]||(i[5]=a=>u.value=a),options:[5,10,20,30],onChange:W,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),n(e(_e),{visible:h.value,"onUpdate:visible":i[7]||(i[7]=a=>h.value=a),style:{width:"450px"},header:e(o)("coupon.deleteConfirmTitle"),modal:!0},{footer:c(()=>[n(e(v),{label:e(o)("no"),icon:"pi pi-times",class:"p-button-text",onClick:i[6]||(i[6]=a=>h.value=!1)},null,8,["label"]),n(e(v),{label:e(o)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:Y},null,8,["label"])]),default:c(()=>[s("div",Xe,[Ye,s("span",null,r(e(o)("coupon.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}};export{He as default};
