import{_ as A,k as E,u as O,j as R,r as l,m as T,q,n as G,a as r,c as i,f as o,s as H,t as h,e as v,h as b,w as C,g as x,b as I,F as L,d as J,i as N}from"./index-4761cd15.js";import{p as K,S as Q,A as U,c as W,P as X}from"./ProductOffers-27d6a2d6.js";import{N as Y}from"./navigation-baba0c15.js";import{d as w}from"./banner-addtion-e4104052.js";import{C as Z}from"./CustomTaps-bff91ff2.js";const ee={class:"mx-auto bg-gradient-to mt-16 max-w-7xl"},ae={key:0,class:"flex flex-col items-center justify-center py-16 rounded-xl animate-pulse"},te={key:1,class:"text-center py-16 text-red-600"},se={class:"text-lg font-semibold"},oe={key:2},ne={class:"text-center mb-2"},re={class:"text-4xl sm:text-4xl font-extrabold text-gray-800 tracking-tight animate-fade-in"},le={key:0},ie=["src","alt"],de={class:"font-sans mt-4 mb-1 text-gray-800 font-semibold text-sm sm:text-base md:text-lg"},ce={key:1,class:"my-8"},ue={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},me=["src","alt"],_e={key:2,class:"my-8"},ge={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},fe=["src","alt"],pe={__name:"SubCategory",setup(ve){const k=E();O();const{t:_,locale:y}=R(),g=l(localStorage.getItem("defaultStoreId")),n=l({}),c=l([]),P=l({title:"",products:[]}),V=l([]);l({title:"",products:[]});const S=l(!1),d=l(null),f=a=>y.value==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar,j=a=>y.value==="ar"?"منتجات "+(a.name_ar||a.name_en):"Products "+(a.name_en||a.name_ar),$=a=>a.has_subcategories?{name:"subcategory",params:{id:a.id}}:{name:"produts_category",params:{id:a.id}},D=async()=>{try{const s=(await N.get(`/api/home/products-by-category/${k.params.id}/${g.value}`)).data.data;n.value={id:s.category.id,name_ar:s.category.name_ar,name_en:s.category.name_en,media:s.category.media||[{url:w,name:"default"}]},c.value=s.sub_categories.map(e=>({id:e.id,has_subcategories:e.has_subcategories,name_ar:e.name_ar||e.name_en,name_en:e.name_en||e.name_ar,media:e.media.length?e.media:[{url:w,name:"default"}]})),P.value={title:j(n.value),products:(s.products.data||[]).map(e=>{var u,m;return{id:e.id,name:y.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((m=(u=e.media)==null?void 0:u.find(t=>t.name==="product_main_image"))==null?void 0:m.url)||e.key_default_image||w}})}}catch(a){console.error("Error fetching category data:",a),d.value=_("category.errorLoading")||"Failed to load category data."}},M=async()=>{try{const a=c.value.map(async e=>((await N.get(`/api/home/products-by-category/${e.id}/${g.value}`)).data.data.products.data||[]).map(t=>{var p,F;return{id:t.id,name:y.value==="ar"?t.name_ar||t.name_en:t.name_en||t.name_ar,tax:t.tax||0,price:parseFloat(t.base_price||0).toFixed(2),img:((F=(p=t.media)==null?void 0:p.find(z=>z.name==="product_main_image"))==null?void 0:F.url)||t.key_default_image||w}})),s=await Promise.allSettled(a);V.value=s.filter(e=>e.status==="fulfilled").flatMap(e=>e.value)}catch(a){console.error("Error fetching subcategory products:",a),d.value=_("category.errorLoading")||"Failed to load subcategory products."}},B=()=>{S.value=!0,d.value=null,D(),c.value.length&&M(),S.value=!1};return T(()=>{k.params.id&&g.value?B():d.value=_("category.missingParams")||"Missing category or store ID."}),q(()=>k.params.id,(a,s)=>{a!==s&&a&&g.value?B():(!a||!g.value)&&(d.value=_("category.missingParams")||"Missing category or store ID.")}),(a,s)=>{var u,m;const e=G("router-link");return r(),i(L,null,[o("div",ee,[S.value?(r(),i("div",ae,s[0]||(s[0]=[o("img",{src:H,alt:"Loading Logo",class:"w-32 h-32 object-contain animate-bounce","aria-label":"Loading animation"},null,-1)]))):d.value?(r(),i("div",te,[o("p",se,h(d.value),1),o("button",{onClick:B,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},h(v(_)("category.retry")),1)])):(r(),i("div",oe,[o("div",ne,[o("h1",re,h(f(n.value)),1)]),c.value.length>=1?(r(),i("div",le,[s[2]||(s[2]=o("h2",{class:"font-bold font-sans text-gray-800 text-2xl sm:text-3xl lg:text-4xl mb-8 animate-slide-up"},null,-1)),b(v(W),{modules:[v(U),v(Y)],"slides-per-view":3,"space-between":20,loop:c.value.length>3,autoplay:{delay:3e3,disableOnInteraction:!1},speed:1e3,"grab-cursor":!0,navigation:!1,class:"mt-6",breakpoints:{320:{slidesPerView:2,spaceBetween:4},640:{slidesPerView:2,spaceBetween:12},768:{slidesPerView:2,spaceBetween:16},1024:{slidesPerView:5.5,spaceBetween:10}}},{default:C(()=>[(r(!0),i(L,null,J(c.value,t=>(r(),I(v(Q),{key:t.id,class:"group flex flex-col items-center cursor-pointer transition-all duration-300 hover:-translate-y-2"},{default:C(()=>[b(e,{to:$(t),class:"w-full h-48 overflow-hidden rounded-xl shadow-md relative"},{default:C(()=>{var p;return[o("img",{src:(p=t.media[0])==null?void 0:p.url,alt:`${f(t)} image`,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,ie),s[1]||(s[1]=o("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1))]}),_:2,__:[1]},1032,["to"]),o("h3",de,h(f(t)),1)]),_:2},1024))),128))]),_:1},8,["modules","loop"])])):x("",!0),(u=n.value.media)!=null&&u.find(t=>t.name==="banner_one_image")?(r(),i("div",ce,[o("div",ue,[o("img",{src:n.value.media.find(t=>t.name==="banner_one_image").url,alt:`${f(n.value)} banner one`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,me),s[3]||(s[3]=o("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center p-6"},null,-1))])])):x("",!0),o("section",null,[P.value.products.length?(r(),I(K,{key:0,products:P.value,title:j(n.value)},null,8,["products","title"])):x("",!0),b(X)]),(m=n.value.media)!=null&&m.find(t=>t.name==="banner_two_image")?(r(),i("div",_e,[o("div",ge,[o("img",{src:n.value.media.find(t=>t.name==="banner_two_image").url,alt:`${f(n.value)} banner two`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,fe),s[4]||(s[4]=o("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/50 flex items-center justify-center p-6"},null,-1))])])):x("",!0)]))]),b(Z)],64)}}},ke=A(pe,[["__scopeId","data-v-dfeaf98b"]]);export{ke as default};
