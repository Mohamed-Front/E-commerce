import{p as A,u as F,r,D as T,o as q,e as n,f as a,h as e,t as c,j as w,E as x,G as L,F as h,k as y,H as j,n as U,b as $,I as G,B as H,C as O,m as z}from"./index-f9345899.js";const D=_=>(H("data-v-b4b5f31c"),_=_(),O(),_),J={class:"permission-manager"},K={class:"controls"},Q={class:"name-input"},W=D(()=>e("label",{for:"roleName"},[z(" Role Name "),e("span",{class:"required"},"*")],-1)),X={key:0,class:"loading"},Y={key:0,class:"table-view"},Z=D(()=>e("thead",null,[e("tr",null,[e("th",null,"Group"),e("th",null,"Permission"),e("th",null,"Description"),e("th",null,"Select")])],-1)),N=["rowspan"],ee=["id","checked",".indeterminate","onChange"],te=["for"],se=["onClick","disabled"],le=["id","value"],oe={key:1,class:"card-view"},ne={class:"permission-groups"},ae={class:"group-header"},ie=["id","checked",".indeterminate","onChange"],de=["for"],ce={class:"permission-items"},re={class:"permission-info"},ue=["id","value"],ve=["for"],pe=["onClick","disabled"],he=["disabled"],_e={class:"modal-content"},be=D(()=>e("h3",null,"Permission Description",-1)),me={setup(_){const C=F(),v=r({}),g=r(null),b=r(!0),i=r([]),p=r(""),m=r(!1),I=r(""),f=r(!1),k=T(()=>C.params.id),M=()=>{$.get("api/role/get/permissions").then(d=>{v.value=d.data.data,k.value?R():b.value=!1})},R=()=>{$.get(`api/role/${C.params.id}`).then(d=>{g.value=d.data.data,p.value=g.value.name,i.value=g.value.permissions.map(s=>s.id),b.value=!1}).catch(()=>{b.value=!1})},S=(d,s)=>{const l=(v.value[d]||[]).map(t=>t.id);s.target.checked?i.value=[...new Set([...i.value,...l])]:i.value=i.value.filter(t=>!l.includes(t))},V=d=>{const s=v.value[d]||[];return s.length===0?!1:s.every(o=>i.value.includes(o.id))},P=d=>{const s=v.value[d]||[];if(s.length===0)return!1;const o=s.some(t=>i.value.includes(t.id)),l=s.every(t=>i.value.includes(t.id));return o&&!l},E=d=>{I.value=d||"No description available",m.value=!0},B=()=>{if(!p.value){alert("Please enter a role name");return}const d={name:p.value,permissions:i.value};$.put(`/api/role/${C.params.id}`,d).then(s=>{router.push({name:"roles"})}).catch(s=>{console.error("Error:",s)})};return q(()=>{M()}),(d,s)=>(n(),a("div",J,[e("h1",null,c(w(k)?"Edit":"Create")+" Role Permissions",1),e("div",K,[e("div",Q,[W,x(e("input",{type:"text",id:"roleName","onUpdate:modelValue":s[0]||(s[0]=o=>p.value=o),placeholder:"Enter role name",required:""},null,512),[[L,p.value]])]),e("button",{onClick:s[1]||(s[1]=o=>f.value=!f.value),class:"view-toggle"},c(f.value?"Switch to Card View":"Switch to Table View"),1)]),b.value?(n(),a("div",X,"Loading "+c(w(k)?"role data":"permissions")+"...",1)):(n(),a(h,{key:1},[f.value?(n(),a("div",Y,[e("table",null,[Z,e("tbody",null,[(n(!0),a(h,null,y(v.value,(o,l)=>(n(),a(h,{key:l},[(n(!0),a(h,null,y(o,t=>(n(),a("tr",{key:t.id},[o.indexOf(t)===0?(n(),a("td",{key:0,rowspan:o.length},[e("input",{type:"checkbox",id:`group-${l}-table`,checked:V(l),".indeterminate":P(l),onChange:u=>S(l,u)},null,40,ee),e("label",{for:`group-${l}-table`},c(l.charAt(0).toUpperCase()+l.slice(1)),9,te)],8,N)):U("",!0),e("td",null,c(t.name),1),e("td",null,[e("button",{onClick:u=>E(t.description),class:"description-btn",disabled:!t.description},c(t.description?"View":"None"),9,se)]),e("td",null,[x(e("input",{type:"checkbox",id:`permission-${t.id}-table`,value:t.id,"onUpdate:modelValue":s[2]||(s[2]=u=>i.value=u)},null,8,le),[[G,i.value]])])]))),128))],64))),128))])])])):(n(),a("div",oe,[e("div",ne,[(n(!0),a(h,null,y(v.value,(o,l)=>(n(),a("div",{key:l,class:"permission-group"},[e("div",ae,[e("input",{type:"checkbox",id:`group-${l}`,checked:V(l),".indeterminate":P(l),onChange:t=>S(l,t)},null,40,ie),e("label",{for:`group-${l}`},c(l.charAt(0).toUpperCase()+l.slice(1)),9,de)]),e("div",ce,[(n(!0),a(h,null,y(o,t=>(n(),a("div",{key:t.id,class:"permission-item"},[e("div",re,[x(e("input",{type:"checkbox",id:`permission-${t.id}`,value:t.id,"onUpdate:modelValue":s[3]||(s[3]=u=>i.value=u)},null,8,ue),[[G,i.value]]),e("label",{for:`permission-${t.id}`},c(t.name),9,ve)]),e("button",{onClick:u=>E(t.description),class:"description-btn",disabled:!t.description},c(t.description?"View Description":"No Description"),9,pe)]))),128))])]))),128))])]))],64)),e("button",{onClick:B,class:"submit-btn",disabled:i.value.length===0||!p.value},c(w(k)?"Update":"Create")+" Role with Selected Permissions ",9,he),m.value?(n(),a("div",{key:2,class:"modal-overlay",onClick:s[5]||(s[5]=j(o=>m.value=!1,["self"]))},[e("div",_e,[be,e("p",null,c(I.value),1),e("button",{onClick:s[4]||(s[4]=o=>m.value=!1),class:"close-modal"},"Close")])])):U("",!0)]))}},ke=A(me,[["__scopeId","data-v-b4b5f31c"]]);export{ke as default};
