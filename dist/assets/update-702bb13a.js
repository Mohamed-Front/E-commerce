import{u as Z,k as j,G as M,j as B,r as y,l as w,o as R,S as I,a as g,c as f,z as G,f as o,t as r,e as s,H as b,h as i,w as U,F as D,d as J,v as W,i as v,a3 as K,a9 as T,U as m,ah as P,T as E,V as h,R as Q}from"./index-68e89a44.js";import{h as q}from"./moment-fbc5633a.js";import{x as X,A as Y,O as ee}from"./index.es-d12e3be9.js";const se={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},te={class:"text-3xl font-bold text-center mb-8 text-gray-800"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"space-y-2"},ae={for:"store_id",class:"block text-sm font-medium text-gray-700"},ie={class:"space-y-4"},re={class:"flex items-center space-x-4"},ne={class:"block text-sm font-medium text-gray-700 mx-2"},de={class:"space-y-2"},ue={for:"min_amount",class:"block text-sm font-medium text-gray-700"},pe={class:"space-y-2"},ce={for:"free_amount",class:"block text-sm font-medium text-gray-700"},me={class:"space-y-4"},ge={class:"flex items-center space-x-4"},fe={class:"block text-sm font-medium text-gray-700 mx-2"},be={class:"space-y-2"},_e={for:"days",class:"block text-sm font-medium text-gray-700"},he={class:"space-y-2"},ye={for:"from",class:"block text-sm font-medium text-gray-700"},ve={class:"space-y-2"},xe={for:"to",class:"block text-sm font-medium text-gray-700"},Ve={class:"space-y-2 md:col-span-2"},Se={class:"text-xl font-semibold text-gray-800 mb-4"},Fe={class:"space-y-2 md:col-span-2"},ke={class:"block text-sm font-medium text-gray-700"},we={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ue={class:"space-y-2"},De=["for"],Te={class:"space-y-2"},Ee=["for"],qe={class:"space-y-2"},ze=["for"],$e={class:"space-y-2"},Ce=["for"],Oe={class:"space-y-2"},Ae=["for"],He={class:"flex items-center"},Le={class:"pt-4 flex justify-center space-x-4"},Ne={key:0},Ze={key:1,class:"pi pi-spinner pi-spin"},Ie={__name:"update",setup(je){const x=Z(),V=j(),_=M(),{t}=B(),c=y(!1),l=y({store_id:null,is_enabled:!1,min_amount:0,free_amount:0,express_enabled:!1,days:[],from:"",to:"",lat:31.984983325941823,long:35.900908045672196,distance:1e3,zones:[]}),z=w(()=>{const n=Number(l.value.distance)||1e3;return{center:{lat:Number(l.value.lat),lng:Number(l.value.long)},radius:n,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35}}),S=y([]),$=w(()=>[{label:t("days.sunday"),value:0},{label:t("days.monday"),value:1},{label:t("days.tuesday"),value:2},{label:t("days.wednesday"),value:3},{label:t("days.thursday"),value:4},{label:t("days.friday"),value:5},{label:t("days.saturday"),value:6}]),C=async()=>{try{const n=await v.get("/api/store");S.value=n.data.data.data.map(e=>({label:e.name_en,value:e.id}))}catch(n){console.error("Error fetching stores:",n),_.add({severity:"error",summary:t("error"),detail:t("shippingSetting.loadStoresError"),life:3e3})}},O=async()=>{c.value=!0;try{const e=(await v.get(`/api/shipping-setting/${V.params.id}`)).data.data;l.value={store_id:e.store_id,is_enabled:e.is_enabled,min_amount:parseFloat(e.min_amount),free_amount:parseFloat(e.free_amount),express_enabled:e.express_enabled,days:Array.isArray(e.days)?e.days:JSON.parse(e.days||"[]"),from:e.from?q(e.from,"H:mm").format("HH:mm"):"",to:e.to?q(e.to,"H:mm").format("HH:mm"):"",lat:parseFloat(e.lat),long:parseFloat(e.long),distance:parseFloat(e.distance||1e3),zones:e.zones.map(p=>({from:parseFloat(p.from),to:parseFloat(p.to),fee:parseFloat(p.fee),express_time:parseInt(p.express_time),express_fee:parseFloat(p.express_fee)}))}}catch(n){console.error("Error fetching shipping setting:",n),_.add({severity:"error",summary:t("error"),detail:t("shippingSetting.loadError"),life:3e3}),x.push({name:"shipping-settings"})}finally{c.value=!1}};function A(n){const e=n.latLng;l.value.lat=e.lat(),l.value.long=e.lng()}const H=()=>{l.value.zones.push({from:0,to:0,fee:0,express_time:0,express_fee:0})},L=n=>{l.value.zones.length>1?l.value.zones.splice(n,1):_.add({severity:"warn",summary:t("warning"),detail:t("shippingSetting.atLeastOneZone"),life:3e3})},N=async()=>{var n,e,p,a;c.value=!0;try{await v.post(`/api/shipping-setting/${V.params.id}`,l.value,{}),_.add({severity:"success",summary:t("success"),detail:t("shippingSetting.updatedSuccess"),life:3e3})}catch(d){console.error("Error:",d);const u=((e=(n=d.response)==null?void 0:n.data)==null?void 0:e.message)||t("shippingSetting.updateError"),F=((a=(p=d.response)==null?void 0:p.data)==null?void 0:a.errors)||{};let k=u;Object.keys(F).length>0&&(k=Object.values(F).flat().join(" ")),_.add({severity:"error",summary:t("error"),detail:k,life:5e3})}finally{c.value=!1}};return R(()=>{C(),O()}),(n,e)=>{const p=I("can");return g(),f(D,null,[G((g(),f("div",se,[o("h1",te,r(s(t)("shippingSetting.editTitle")),1),o("form",{onSubmit:W(N,["prevent"]),class:"space-y-6"},[o("div",oe,[o("div",le,[o("label",ae,[b(r(s(t)("shippingSetting.store"))+" ",1),e[9]||(e[9]=o("span",{class:"text-red-500"},"*",-1))]),i(s(K),{id:"store_id",modelValue:l.value.store_id,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.store_id=a),options:S.value,optionLabel:"label",optionValue:"value",placeholder:s(t)("shippingSetting.selectStore"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","placeholder"])]),o("div",ie,[o("div",re,[o("label",ne,r(s(t)("shippingSetting.isEnabled")),1),i(s(T),{modelValue:l.value.is_enabled,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.is_enabled=a)},null,8,["modelValue"])])]),o("div",de,[o("label",ue,[b(r(s(t)("shippingSetting.minAmount"))+" ",1),e[10]||(e[10]=o("span",{class:"text-red-500"},"*",-1))]),i(s(m),{id:"min_amount",modelValue:l.value.min_amount,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.min_amount=a),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterMinAmount"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",pe,[o("label",ce,[b(r(s(t)("shippingSetting.freeAmount"))+" ",1),e[11]||(e[11]=o("span",{class:"text-red-500"},"*",-1))]),i(s(m),{id:"free_amount",modelValue:l.value.free_amount,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.free_amount=a),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterFreeAmount"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",me,[o("div",ge,[o("label",fe,r(s(t)("shippingSetting.expressEnabled")),1),i(s(T),{modelValue:l.value.express_enabled,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.express_enabled=a)},null,8,["modelValue"])])]),o("div",be,[o("label",_e,[b(r(s(t)("shippingSetting.days"))+" ",1),e[12]||(e[12]=o("span",{class:"text-red-500"},"*",-1))]),i(s(P),{id:"days",modelValue:l.value.days,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.days=a),options:$.value,optionLabel:"label",optionValue:"value",placeholder:s(t)("shippingSetting.selectDays"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","placeholder"])]),o("div",he,[o("label",ye,[b(r(s(t)("shippingSetting.fromTime"))+" ",1),e[13]||(e[13]=o("span",{class:"text-red-500"},"*",-1))]),i(s(E),{id:"from",modelValue:l.value.from,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.from=a),type:"time",placeholder:s(t)("shippingSetting.enterFromTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",ve,[o("label",xe,[b(r(s(t)("shippingSetting.toTime"))+" ",1),e[14]||(e[14]=o("span",{class:"text-red-500"},"*",-1))]),i(s(E),{id:"to",modelValue:l.value.to,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.to=a),type:"time",placeholder:s(t)("shippingSetting.enterToTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),o("div",Ve,[o("h2",Se,r(s(t)("shippingSetting.select_location")),1),i(s(ee),{onClick:A,style:{width:"100%",height:"500px"},center:{lat:parseFloat(l.value.lat),lng:parseFloat(l.value.long)},zoom:14},{default:U(()=>[i(s(X),{options:{position:{lat:parseFloat(l.value.lat),lng:parseFloat(l.value.long)}}},null,8,["options"]),i(s(Y),{options:z.value},null,8,["options"])]),_:1},8,["center"])]),o("div",Fe,[o("label",ke,r(s(t)("shippingSetting.zones")),1),(g(!0),f(D,null,J(l.value.zones,(a,d)=>(g(),f("div",{key:d,class:"border p-4 rounded-lg mb-4"},[o("div",we,[o("div",Ue,[o("label",{for:"zone_from_"+d,class:"block text-sm font-medium text-gray-700"},r(s(t)("shippingSetting.zoneFrom")),9,De),i(s(m),{id:"zone_from_"+d,modelValue:a.from,"onUpdate:modelValue":u=>a.from=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterZoneFrom"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",Te,[o("label",{for:"zone_to_"+d,class:"block text-sm font-medium text-gray-700"},r(s(t)("shippingSetting.zoneTo")),9,Ee),i(s(m),{id:"zone_to_"+d,modelValue:a.to,"onUpdate:modelValue":u=>a.to=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterZoneTo"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",qe,[o("label",{for:"zone_fee_"+d,class:"block text-sm font-medium text-gray-700"},r(s(t)("shippingSetting.fee")),9,ze),i(s(m),{id:"zone_fee_"+d,modelValue:a.fee,"onUpdate:modelValue":u=>a.fee=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterFee"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",$e,[o("label",{for:"zone_express_time_"+d,class:"block text-sm font-medium text-gray-700"},r(s(t)("shippingSetting.expressTime")),9,Ce),i(s(m),{id:"zone_express_time_"+d,modelValue:a.express_time,"onUpdate:modelValue":u=>a.express_time=u,placeholder:s(t)("shippingSetting.enterExpressTime"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",Oe,[o("label",{for:"zone_express_fee_"+d,class:"block text-sm font-medium text-gray-700"},r(s(t)("shippingSetting.expressFee")),9,Ae),i(s(m),{id:"zone_express_fee_"+d,modelValue:a.express_fee,"onUpdate:modelValue":u=>a.express_fee=u,mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:s(t)("shippingSetting.enterExpressFee"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["id","modelValue","onUpdate:modelValue","placeholder"])]),o("div",He,[i(s(h),{icon:"pi pi-trash",class:"p-button-danger p-button-text",onClick:u=>L(d),disabled:l.value.zones.length===1},null,8,["onClick","disabled"])])])]))),128)),i(s(h),{label:s(t)("shippingSetting.addZone"),icon:"pi pi-plus",class:"p-button-outlined",onClick:H},null,8,["label"])])]),o("div",Le,[i(s(h),{type:"button",label:s(t)("cancel"),icon:"pi pi-times",onClick:e[8]||(e[8]=a=>s(x).go(-1)),class:"px-6 py-3 bg-gray-200 mx-2 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300",disabled:c.value},null,8,["label","disabled"]),i(s(h),{type:"submit",label:s(t)("shippingSetting.updateShipping"),icon:"pi pi-check",loading:c.value,class:"px-8 py-3 bg-gradient-to-r mx-2 from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300",disabled:c.value},{default:U(()=>[c.value?(g(),f("i",Ze)):(g(),f("span",Ne,r(s(t)("shippingSetting.updateShipping")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[p,"edit shipping settings"]]),i(s(Q))],64)}}};export{Ie as default};
