import{_ as Q,j as W,k as G,u as K,q as X,r as d,l as j,o as Y,i as R,a as r,c as n,g as p,t as o,f as t,F as S,d as F,e as c,x as $,h as L,z as Z,A as ee,B as P,C as te}from"./index-d6470849.js";import{P as se}from"./ProductOffers-5cad998f.js";const ae={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},le={key:0,class:"text-center"},oe={key:1,class:"text-red-500 text-center"},re={class:"flex flex-col lg:flex-row items-start gap-8"},ne={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},ie={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-2 w-full lg:w-1/4"},ue=["src","onClick"],de={class:"w-full lg:w-3/4"},ce={class:"w-full aspect-square shadow-lg rounded-md overflow-hidden"},me=["src"],ve={class:"w-full lg:w-1/2 flex flex-col justify-between p-4 bg-white rounded-md"},ge={class:"text-3xl font-bold text-gray-800 mb-2"},pe={key:0,class:"text-xl text-gray-600 mb-4"},_e={class:"mt-4 flex flex-wrap gap-2 text-center"},fe={key:2,class:"sub-tiles"},xe={class:"flex items-center gap-6 mb-4"},ye={class:"text-2xl font-bold text-blue-600"},be={class:"flex items-center gap-4 mb-4"},he={class:"flex items-center border border-gray-300 rounded-md"},we={class:"px-4 py-1 border-x border-gray-300"},ke=["disabled"],Ce={class:"bg-[#E6AC312B] px-6 pt-2 pb-12 rounded-md mt-8"},Ae={class:"leading-relaxed text-sm text-gray-700"},De={class:"mt-8 p-4 bg-white rounded-md shadow-md"},Ee={class:"flex flex-col md:flex-row justify-center items-center gap-8 mt-4"},je={class:"text-center"},Re={class:"text-5xl font-bold text-gray-800"},Se={class:"card flex justify-center my-2"},Fe={class:"text-gray-500"},Le={class:"w-full md:w-1/3"},Ne={class:"text-sm font-bold w-4"},Ve={class:"w-full relative h-2 bg-gray-200 rounded overflow-hidden"},$e={class:"text-[#A17D1C] text-sm w-8"},Pe={key:0,class:"flex flex-col justify-center items-center mt-6"},Ie=["disabled"],Me={key:0,class:"text-red-500 text-sm mt-2"},Te={key:1,class:"text-center mt-6"},qe={key:2,class:"mt-8"},Be={class:"flex items-center justify-between mb-2"},Oe={class:"flex items-center gap-2"},ze={class:"font-semibold text-gray-800"},Ue={class:"text-sm text-gray-500"},He={class:"text-gray-700"},Je={key:3,class:"text-center mt-8 py-6"},Qe={class:"mt-8"},We={__name:"product-details",setup(Ge){const{t:I,locale:_}=W(),N=G(),v=K(),w=X(),s=d({}),k=d([]),b=d(1),h=d(""),A=d(!1),D=d(null),f=d(!1),u=d([]),C=d(!1),x=d(null),i=d({rating:0,comment:""}),M=j(()=>u.value.slice(0,3)),T=j(()=>u.value.length===0?0:u.value.reduce((e,m)=>e+m.rate,0)/u.value.length),q=j(()=>{const a={5:0,4:0,3:0,2:0,1:0};return u.value.forEach(e=>{e.rate>=1&&e.rate<=5&&a[e.rate]++}),[5,4,3,2,1].map(e=>({starsNumber:e,count:a[e],percentage:u.value.length>0?Math.round(a[e]/u.value.length*100):0}))}),B=a=>{a&&(a.has_subcategories?v.push({name:"subcategory",params:{id:a.id}}):v.push({name:"produts_category",params:{id:a.id}}))},O=a=>{a&&(a.has_market?v.push({name:"stores-hasmarket"}):v.push({name:"home"}))},z=async a=>{if(!w.authenticatedweb){v.push({name:"AuthLogin"});return}if(!f.value){f.value=!0;try{const e={product_id:a.id,variant_id:a.variant_id||null,quantity:b.value},m=await R.post("/api/cart/add",e);console.log("Added to cart successfully:",m.data)}catch(e){console.error("Error adding to cart:",e),e.value="Failed to add product to cart. Please try again."}finally{f.value=!1}}},U=a=>{h.value=a},H=a=>{if(!a)return"N/A";const e={year:"numeric",month:"short",day:"numeric"};return new Date(a).toLocaleDateString(void 0,e)},J=async()=>{var a,e,m;if(!w.authenticatedweb){v.push({name:"AuthLogin"});return}if(i.value.rating===0){x.value="Please select a rating";return}if(!i.value.comment.trim()){x.value="Please write a review comment";return}C.value=!0;try{const g={model_id:N.params.id,rate:i.value.rating,type:"product",message:i.value.comment.trim()},y=await R.post("/api/review",g);if(y.data.success)u.value.unshift({id:y.data.data.id,rate:i.value.rating,message:i.value.comment.trim(),user:{name:((a=w.user)==null?void 0:a.name)||"Anonymous"},created_at:new Date().toISOString()}),i.value={rating:0,comment:""},x.value=null;else throw new Error(y.data.message||"Failed to submit review")}catch(g){console.error("Error submitting review:",g),x.value=((m=(e=g.response)==null?void 0:e.data)==null?void 0:m.message)||"Failed to submit review. Please try again."}finally{C.value=!1}};return Y(async()=>{var a;window.scrollTo(0,0),A.value=!0;try{const e=await R.get(`/api/home/product-details/${N.params.id}`);s.value=((a=e.data.data)==null?void 0:a.product)||{},k.value=s.value.media||[],h.value=k.value.length>0?k.value[0].url:s.value.key_default_image,u.value=s.value.reviews||[]}catch(e){console.error("Error fetching data:",e),D.value=I("category.errorLoading")||"Failed to load data."}finally{A.value=!1}}),(a,e)=>{var m,g,y,V;return r(),n("div",ae,[A.value?(r(),n("div",le,"Loading...")):p("",!0),D.value?(r(),n("div",oe,o(D.value),1)):p("",!0),t("header",re,[t("div",ne,[t("div",ie,[(r(!0),n(S,null,F(k.value,l=>(r(),n("img",{key:l.url,src:l.url,alt:"Thumbnail",class:$(["h-20 w-20 object-cover rounded-lg cursor-pointer border-2 transition-all duration-200",{"border-blue-500":h.value===l.url,"border-transparent":h.value!==l.url}]),onClick:E=>U(l.url)},null,10,ue))),128))]),t("div",de,[t("div",ce,[t("img",{src:h.value||s.value.key_default_image,alt:"Main product image",class:"w-full h-full object-cover"},null,8,me)])])]),t("div",ve,[t("h1",ge,o(c(_)==="en"?s.value.name_en:s.value.name_ar),1),s.value.sub_name_en||s.value.sub_name_ar?(r(),n("h2",pe,o(c(_)==="en"?s.value.sub_name_en:s.value.sub_name_ar),1)):p("",!0),t("section",_e,[s.value.store_id?(r(),n("span",{key:0,onClick:e[0]||(e[0]=l=>O(s.value.store)),class:"sub-tiles"},o(c(_)==="en"?(m=s.value.store)==null?void 0:m.name_en:((g=s.value.store)==null?void 0:g.name_ar)||"Store"),1)):p("",!0),s.value.category&&(s.value.category.name_en||s.value.category.name_ar)?(r(),n("span",{key:1,onClick:e[1]||(e[1]=l=>B(s.value.category)),class:"sub-tiles cu"},o(c(_)==="en"?s.value.category.name_en:s.value.category.name_ar),1)):p("",!0),s.value.brand_id?(r(),n("span",fe,o(c(_)==="en"?(y=s.value.brand)==null?void 0:y.name_en:((V=s.value.brand)==null?void 0:V.name_ar)||"Brand"),1)):p("",!0)]),e[11]||(e[11]=t("hr",{class:"bg-[#A17D1C] my-6 h-[1px] border-0"},null,-1)),t("section",null,[t("div",xe,[e[8]||(e[8]=t("span",{class:"text-xl font-bold text-gray-800"},"Price:",-1)),t("span",ye,o(s.value.base_price_after_discount)+" JOD",1)]),t("div",be,[e[9]||(e[9]=t("label",{class:"font-bold text-gray-700"},"Quantity:",-1)),t("div",he,[t("button",{onClick:e[2]||(e[2]=l=>b.value>1?b.value--:null),class:"px-3 py-1 text-lg font-bold hover:bg-gray-100 rounded-l-md"},"-"),t("span",we,o(b.value),1),t("button",{onClick:e[3]||(e[3]=l=>b.value++),class:"px-3 py-1 text-lg font-bold hover:bg-gray-100 rounded-r-md"},"+")])]),e[10]||(e[10]=t("p",{class:"text-gray-600 my-4"},"Delivery within: 3 H",-1)),t("button",{disabled:f.value,onClick:e[4]||(e[4]=l=>z(s.value)),class:$(["w-full py-3 text-lg font-bold bg-[var(--main-text-color)] rounded-md text-white transition-transform duration-150 ease-in-out active:scale-95 hover:shadow-lg",{"opacity-50 cursor-not-allowed":f.value}])},o(f.value?"Adding...":a.$t("product.addtocart")),11,ke)])])]),t("section",Ce,[t("p",Ae,o(c(_)==="en"?s.value.description_en:s.value.description_ar||"No description available."),1),e[12]||(e[12]=t("h3",{class:"text-[#E39F30] text-sm font-semibold mt-2 cursor-pointer"},"READ MORE",-1))]),t("section",De,[e[16]||(e[16]=t("div",{class:"flex justify-center items-center flex-col"},[t("h2",{class:"text-2xl font-bold text-gray-800 mb-4"},"Leave A Review")],-1)),t("div",Ee,[t("div",je,[t("h2",Re,o(T.value.toFixed(1)),1),t("div",Se,[L(c(P),{modelValue:i.value.rating,"onUpdate:modelValue":e[5]||(e[5]=l=>i.value.rating=l),cancel:!1},null,8,["modelValue"])]),t("p",Fe,o(u.value.length)+" "+o(u.value.length===1?"review":"reviews"),1)]),t("div",Le,[(r(!0),n(S,null,F(q.value,l=>(r(),n("div",{key:l.starsNumber,class:"flex items-center gap-2 mb-3"},[t("span",Ne,o(l.starsNumber),1),t("div",Ve,[t("div",{class:"absolute top-0 left-0 h-full bg-[#F0E3C2] transition-all duration-300",style:te({width:l.percentage+"%"})},null,4)]),t("span",$e,o(l.count),1)]))),128))])]),c(w).authenticatedweb?(r(),n("div",Pe,[Z(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>i.value.comment=l),class:"w-full md:w-1/2 h-32 bg-gray-50 border border-gray-300 rounded-md p-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-1 focus:ring-[#F0E3C2]",placeholder:"Write your review here..."},null,512),[[ee,i.value.comment]]),t("button",{onClick:J,disabled:C.value||i.value.rating===0||!i.value.comment.trim(),class:"w-full md:w-1/2 mt-4 py-2 px-4 text-lg font-bold bg-[var(--main-text-color)] rounded-md text-white transition-transform duration-150 ease-in-out active:scale-95 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"},o(C.value?"Submitting...":"Submit"),9,Ie),x.value?(r(),n("p",Me,o(x.value),1)):p("",!0)])):(r(),n("div",Te,[e[13]||(e[13]=t("p",{class:"text-gray-600 mb-4"},"Please log in to leave a review",-1)),t("button",{onClick:e[7]||(e[7]=l=>c(v).push({name:"AuthLogin"})),class:"py-2 px-6 bg-[var(--main-text-color)] text-white rounded-md hover:bg-opacity-90 transition-colors"}," Login ")])),u.value.length>0?(r(),n("div",qe,[e[14]||(e[14]=t("h3",{class:"text-xl font-bold text-gray-800 mb-4"},"Customer Reviews",-1)),(r(!0),n(S,null,F(M.value,l=>{var E;return r(),n("div",{key:l.id,class:"border-b border-gray-200 py-4"},[t("div",Be,[t("div",Oe,[t("span",ze,o(((E=l.user)==null?void 0:E.name)||"Anonymous"),1),L(c(P),{modelValue:l.rate,readonly:!0,cancel:!1,class:"text-sm"},null,8,["modelValue"])]),t("span",Ue,o(H(l.created_at)),1)]),t("p",He,o(l.message),1)])}),128))])):(r(),n("div",Je,e[15]||(e[15]=[t("p",{class:"text-gray-500"},"No reviews yet. Be the first to review this product!",-1)])))]),t("section",Qe,[L(se)])])}}},Ye=Q(We,[["__scopeId","data-v-74063b25"]]);export{Ye as default};
