import{_ as P,G as L,a as X,l as H,I as J,u as K,r as f,o as O,i as g,v as p,b as n,c as u,d as s,t as a,e as i,w as M,X as Q,F as W,p as y,z as m,g as Z}from"./index-4d7d45a7.js";import{h as T}from"./moment-fbc5633a.js";const ee={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},te={class:"text-3xl font-bold text-center mb-8 text-gray-800"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se={class:"space-y-2"},ae={for:"model_id",class:"block text-sm font-medium text-gray-700"},le={key:0,class:"text-red-500 text-xs"},de={class:"space-y-2"},re={for:"model_type",class:"block text-sm font-medium text-gray-700"},ne={key:0,class:"text-red-500 text-xs"},ue={class:"space-y-2"},ie={for:"discount_type",class:"block text-sm font-medium text-gray-700"},ce={key:0,class:"text-red-500 text-xs"},pe={class:"space-y-2"},me={for:"discount_value",class:"block text-sm font-medium text-gray-700"},_e={key:0,class:"text-gray-500 text-xs"},ye={key:1,class:"text-red-500 text-xs"},ve={class:"space-y-2"},fe={for:"expires_at",class:"block text-sm font-medium text-gray-700"},be={key:0,class:"text-red-500 text-xs"},ge={class:"pt-4 flex justify-center space-x-4"},xe={key:0},he={key:1,class:"pi pi-spinner pi-spin"},we={__name:"update",setup(Ve){const Y=L(()=>localStorage.getItem("appLang")||"en"),j=L(()=>Y.value==="en"?"name_en":"name_ar"),x=X(),h=H(),b=J(),{t:_}=K(),d=f(),c=f(!1),w=f([]),o=f({model_id:"",model_type:"",discount_type:null,discount_value:"",expires_at:""});O(()=>{E(),S()});const E=()=>{g.get("api/model").then(e=>{w.value=e.data.data.data})},S=()=>{const e=h.params.id;g.get(`/api/discount/${e}`).then(t=>{const l=t.data.data;o.value={model_id:l.model_id,model_type:l.model_type,discount_type:l.discount_type,discount_value:l.discount_value,expires_at:T(l.expires_at).toDate()}}).catch(t=>{console.error("Error fetching discount:",t),b.add({severity:"error",summary:_("error"),detail:_("discount.fetch_error"),life:3e3})})},R=async()=>{var t,l;c.value=!0,o.value.expires_at=T(o.value.expires_at).format("YYYY-MM-DD");const e=new FormData;e.append("model_id",o.value.model_id),e.append("model_type",o.value.model_type),e.append("discount_type",o.value.discount_type),e.append("discount_value",o.value.discount_value),e.append("expires_at",o.value.expires_at),e.append("_method","PUT");try{await g.post(`/api/discount/${h.params.id}`,e),x.push({name:"discount"}),b.add({severity:"success",summary:_("success"),detail:_("discount.updated_successfully"),life:3e3})}catch(v){console.error("Error:",v),b.add({severity:"error",summary:_("error"),detail:((l=(t=v.response)==null?void 0:t.data)==null?void 0:l.message)||"An error occurred",life:3e3})}finally{c.value=!1}};return(e,t)=>{const l=p("Dropdown"),v=p("InputNumber"),z=p("Calendar"),V=p("Button"),A=p("Form"),G=p("Toast");return n(),u(W,null,[s("div",ee,[s("h1",te,a(e.$t("discount.update_discount")),1),i(A,{ref_key:"form",ref:d,onSubmit:Q(R,["prevent"]),class:"space-y-6"},{default:M(()=>{var $,k,D,F,C,I,N,U,q,B;return[s("div",oe,[s("div",se,[s("label",ae,[y(a(e.$t("discount.model_id"))+" ",1),t[6]||(t[6]=s("span",{class:"text-red-500"},"*",-1))]),i(l,{filter:"",id:"model_id",modelValue:o.value.model_id,"onUpdate:modelValue":t[0]||(t[0]=r=>o.value.model_id=r),options:w.value,optionLabel:j.value,optionValue:"id",placeholder:e.$t("discount.enter_model_id"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(k=($=d.value)==null?void 0:$.errors)!=null&&k.model_id?(n(),u("small",le,a(d.value.errors.model_id[0]),1)):m("",!0)]),s("div",de,[s("label",re,[y(a(e.$t("discount.model_type"))+" ",1),t[7]||(t[7]=s("span",{class:"text-red-500"},"*",-1))]),i(l,{filter:"",id:"model_type",modelValue:o.value.model_type,"onUpdate:modelValue":t[1]||(t[1]=r=>o.value.model_type=r),options:["product","category"],placeholder:e.$t("discount.select_model_type"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"]),(F=(D=d.value)==null?void 0:D.errors)!=null&&F.model_type?(n(),u("small",ne,a(d.value.errors.model_type[0]),1)):m("",!0)]),s("div",ue,[s("label",ie,[y(a(e.$t("discount.discount_type"))+" ",1),t[8]||(t[8]=s("span",{class:"text-red-500"},"*",-1))]),i(l,{filter:"",id:"discount_type",modelValue:o.value.discount_type,"onUpdate:modelValue":t[2]||(t[2]=r=>o.value.discount_type=r),options:[{label:e.$t("discount.fixed_amount"),value:1},{label:e.$t("discount.percentage"),value:2}],optionLabel:"label",optionValue:"value",placeholder:e.$t("discount.select_discount_type"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","options","placeholder"]),(I=(C=d.value)==null?void 0:C.errors)!=null&&I.discount_type?(n(),u("small",ce,a(d.value.errors.discount_type[0]),1)):m("",!0)]),s("div",pe,[s("label",me,[y(a(e.$t("discount.discount_value"))+" ",1),t[9]||(t[9]=s("span",{class:"text-red-500"},"*",-1))]),i(v,{id:"discount_value",modelValue:o.value.discount_value,"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.discount_value=r),min:0,max:o.value.discount_type===2?100:null,placeholder:e.$t("discount.enter_discount_value"),class:"w-full px-4 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","max","placeholder"]),o.value.discount_type===2?(n(),u("small",_e,a(e.$t("discount.percentage_note")),1)):m("",!0),(U=(N=d.value)==null?void 0:N.errors)!=null&&U.discount_value?(n(),u("small",ye,a(d.value.errors.discount_value[0]),1)):m("",!0)]),s("div",ve,[s("label",fe,[y(a(e.$t("discount.expiration_date"))+" ",1),t[10]||(t[10]=s("span",{class:"text-red-500"},"*",-1))]),i(z,{id:"expires_at",modelValue:o.value.expires_at,"onUpdate:modelValue":t[4]||(t[4]=r=>o.value.expires_at=r),minDate:new Date,dateFormat:"yy-mm-dd",placeholder:e.$t("discount.select_expiration_date"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","minDate","placeholder"]),(B=(q=d.value)==null?void 0:q.errors)!=null&&B.expires_at?(n(),u("small",be,a(d.value.errors.expires_at[0]),1)):m("",!0)])]),s("div",ge,[i(V,{type:"button",label:e.$t("discount.cancel"),icon:"pi pi-times",onClick:t[5]||(t[5]=r=>Z(x).go(-1)),class:"px-6 mx-2 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:c.value},null,8,["label","disabled"]),i(V,{type:"submit",label:e.$t("discount.update_discount"),icon:"pi pi-check",loading:c.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:c.value},{default:M(()=>[c.value?(n(),u("i",he)):(n(),u("span",xe,a(e.$t("discount.update_discount")),1))]),_:1},8,["label","loading","disabled"])])]}),_:1},512)]),i(G)],64)}}},De=P(we,[["__scopeId","data-v-ab1f281e"]]);export{De as default};
