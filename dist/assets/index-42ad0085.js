import{u as Ee,G as Ve,j as Fe,r as i,q as ie,o as Le,n as j,R as ne,a as g,c as w,f as n,h as s,w as d,e as l,z as F,b as Re,t as c,F as de,d as Be,i as m,S as Te,a2 as N,$ as je,Q as Ne,a0 as h,p as L,a4 as ze,y as Ae,g as ce,ac as ue}from"./index-55cfeda2.js";const Ie={class:"grid"},Me={class:"col-12"},Oe={class:"card p-4 shadow-2 border-round"},Qe={class:"text-2xl font-bold"},qe={class:"flex gap-2 align-items-center"},Ge={class:"p-input-icon-left"},Ke={class:"card shadow-1 surface-0"},We={class:"text-center py-4"},He={class:"text-xl"},Je={class:"flex justify-content-center align-items-center py-4"},Xe={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Ye={class:"p-paginator-left-content"},Ze={class:"p-paginator-current"},et={class:"p-paginator-right-content"},tt=["disabled"],at=["disabled"],lt=["onClick"],ot={key:1,class:"p-paginator-dots"},rt=["disabled"],st=["disabled"],it={class:"flex align-items-center justify-content-center"},nt={class:"flex flex-column gap-3"},dt={key:0,class:"mt-2"},ct={class:"font-semibold"},ut={class:"flex flex-column gap-3"},bt={__name:"index",setup(pt){const G=Ee(),u=Ve(),{t}=Fe(),R=i(!0),K=i([]),x=i(!1),W=i(null),pe=i(null),me=i({}),k=i("");i(null);const C=i(!1),v=i(null),z=i(!1),H=i([]),J=i([]),X=i([]),P=i(null),S=i(null),U=i(null),Y=i(""),Z=i(""),B=i(localStorage.getItem("appLang")||"en"),$=i(!1),D=i(null),A=i(!1),p=i(1),I=i(0),y=i(10),T=i(0),ve=i(""),be=i(""),ee=i(""),te=i(""),ae=i(0),le=i(0),oe=i([]),M=async()=>{try{const a=await m.get("/api/category",{params:{search:Y.value||void 0}}),e=B.value;H.value=a.data.data.data.map(o=>({label:e==="en"?`${o.name_en} `:`${o.name_ar} `,value:o.id}))}catch(a){u.add({severity:"error",summary:t("error"),detail:t("category.loadError"),life:3e3}),console.error("Error fetching categories:",a)}},re=async()=>{try{const a=await m.get("/api/store"),e=B.value;J.value=a.data.data.data.map(o=>({label:e==="en"?`${o.name_en} `:`${o.name_ar} `,value:o.id}))}catch(a){u.add({severity:"error",summary:t("error"),detail:t("store.loadError"),life:3e3}),console.error("Error fetching stores:",a)}},O=async()=>{try{const a=await m.get("/api/market",{params:{search:Z.value||void 0}}),e=B.value;X.value=a.data.data.data.map(o=>({label:e==="en"?`${o.name_en} `:`${o.name_ar} `,value:o.id}))}catch(a){u.add({severity:"error",summary:t("error"),detail:t("market.loadError"),life:3e3}),console.error("Error fetching markets:",a)}},b=()=>{R.value=!0,m.get("/api/product",{params:{page:p.value,limit:y.value,search:k.value||void 0,category_id:P.value||void 0,store_id:S.value||void 0,market_id:U.value||void 0}}).then(a=>{K.value=a.data.data.data,I.value=a.data.data.total,T.value=a.data.data.last_page,ve.value=a.data.data.first_page_url,be.value=a.data.data.last_page_url,ee.value=a.data.data.next_page_url,te.value=a.data.data.prev_page_url,ae.value=a.data.data.from,le.value=a.data.data.to,oe.value=a.data.data.links,R.value=!1}).catch(a=>{u.add({severity:"error",summary:t("error"),detail:t("product.loadError"),life:3e3}),R.value=!1,console.error("Error fetching products:",a)})};ie([k,y,P,S,U],()=>{p.value=1,b()}),ie(B,()=>{M(),re(),O()});const fe=a=>{Y.value=a.value,M()},ge=a=>{Z.value=a.value,O()},E=a=>{a>=1&&a<=T.value&&(p.value=a,b())},he=a=>{y.value=a.value,p.value=1,b()},ye=a=>{W.value=a,x.value=!0},_e=()=>{m.delete(`/api/product/${W.value}`).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.deleteSuccess"),life:3e3}),b(),x.value=!1}).catch(a=>{u.add({severity:"error",summary:t("error"),detail:t("product.deleteError"),life:3e3}),console.error("Error deleting product:",a)})},we=()=>{const e=`/api/export/products?${new URLSearchParams({search:k.value||"",category_id:P.value||"",store_id:S.value||"",market_id:U.value||""}).toString()}`;m.get(e,{responseType:"blob"}).then(o=>{const f=new Blob([o.data],{type:"text/csv"}),_=document.createElement("a");_.href=URL.createObjectURL(f),_.download="products_export.csv",_.click(),URL.revokeObjectURL(_.href),u.add({severity:"success",summary:t("success"),detail:t("product.exportSuccess"),life:3e3})}).catch(o=>{u.add({severity:"error",summary:t("error"),detail:t("product.exportError"),life:3e3}),console.error("Error exporting products:",o)})},xe=()=>{const a=`store_id,category_id,market_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,1,Demo Product 1,منتج تجريبي 1,SKU001,1,Sub Demo 1,تجريبي فرعي 1,Description of Demo Product 1,وصف المنتج التجريبي 1,15.50,10.00,0.05
2,2,2,Demo Product 2,منتج تجريبي 2,SKU002,2,Sub Demo 2,تجريبي فرعي 2,Description of Demo Product 2,وصف المنتج التجريبي 2,22.00,15.00,0.05`,e=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(o.download!==void 0){const f=URL.createObjectURL(e);o.setAttribute("href",f),o.setAttribute("download","product_import_example.csv"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}},ke=()=>{const a=`id,price,cost_price
1,16.00,10.50
2,23.50,15.00`,e=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");if(o.download!==void 0){const f=URL.createObjectURL(e);o.setAttribute("href",f),o.setAttribute("download","product_price_update_example.csv"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}},Ce=a=>{v.value=a.files[0]},Pe=a=>{D.value=a.files[0]},Se=()=>{if(!v.value){u.add({severity:"error",summary:t("error"),detail:t("validation.fileRequired"),life:3e3});return}z.value=!0;const a=new FormData;a.append("file",v.value),m.post("/api/import/products",a).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.importSuccess"),life:3e3}),b(),C.value=!1,v.value=null}).catch(e=>{u.add({severity:"error",summary:t("error"),detail:t("product.importError"),life:3e3}),console.error("Error importing products:",e)}).finally(()=>{z.value=!1})},Ue=()=>{if(!D.value){u.add({severity:"error",summary:t("error"),detail:t("validation.fileRequired"),life:3e3});return}A.value=!0;const a=new FormData;a.append("file",D.value),m.post("/api/product/update/prices",a).then(()=>{u.add({severity:"success",summary:t("success"),detail:t("product.priceUpdateSuccess"),life:3e3}),b(),$.value=!1,D.value=null}).catch(e=>{u.add({severity:"error",summary:t("error"),detail:t("product.priceUpdateError"),life:3e3}),console.error("Error updating prices:",e)}).finally(()=>{A.value=!1})},$e=()=>{G.push({name:"product-create"})},De=a=>{G.push({name:"product-update",params:{id:a}})};return Le(()=>{Promise.all([M(),re(),O(),b()])}),(a,e)=>{const o=j("Button"),f=j("ProgressSpinner"),_=j("DataTable"),Q=j("Dialog"),V=ne("can"),se=ne("tooltip");return g(),w("div",Ie,[n("div",Me,[n("div",Oe,[s(l(je),{class:"mb-4"},{start:d(()=>[n("h2",Qe,c(l(t)("product.managementTitle")),1)]),end:d(()=>[n("div",qe,[n("span",Ge,[e[17]||(e[17]=n("i",{class:"pi pi-search"},null,-1)),s(l(Te),{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=r=>k.value=r),placeholder:l(t)("product.search")},null,8,["modelValue","placeholder"])]),s(l(N),{modelValue:P.value,"onUpdate:modelValue":e[1]||(e[1]=r=>P.value=r),options:H.value,optionLabel:"label",optionValue:"value",placeholder:l(t)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search categories",onFilter:fe},null,8,["modelValue","options","placeholder"]),s(l(N),{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=r=>S.value=r),options:J.value,optionLabel:"label",optionValue:"value",placeholder:l(t)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),s(l(N),{modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=r=>U.value=r),options:X.value,optionLabel:"label",optionValue:"value",placeholder:l(t)("product.marketFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search markets",onFilter:ge},null,8,["modelValue","options","placeholder"]),s(o,{label:l(t)("product.updatePrice"),icon:"pi pi-dollar",class:"p-button-warning p-button-outlined",onClick:e[4]||(e[4]=r=>$.value=!0)},null,8,["label"]),s(o,{label:l(t)("product.import"),icon:"pi pi-download",class:"p-import",onClick:e[5]||(e[5]=r=>C.value=!0)},null,8,["label"]),F(s(o,{label:l(t)("product.export"),icon:"pi pi-upload",class:"p-export",onClick:we},null,8,["label"]),[[V,"list products"]]),F(s(o,{label:l(t)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:$e},null,8,["label"]),[[V,"create products"]])])]),_:1}),s(l(Ne)),n("div",Ke,[F((g(),Re(_,{ref_key:"dt",ref:pe,value:K.value,loading:R.value,"data-key":"id",paginator:!1,rows:y.value,filters:me.value,totalRecords:I.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[n("div",We,[e[18]||(e[18]=n("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),n("p",He,c(l(t)("product.noData")),1)])]),loading:d(()=>[n("div",Je,[s(f,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[s(l(h),{"selection-mode":"multiple","header-style":"width: 3rem"}),e[19]||(e[19]=L(" ` ` ")),s(l(h),{field:"id",header:l(t)("id"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(r=>[L(c(r.data.id),1)]),_:1},8,["header"]),s(l(h),{field:"name_ar",header:l(t)("product.nameAr"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(r=>[L(c(r.data.name_ar),1)]),_:1},8,["header"]),s(l(h),{field:"name_en",header:l(t)("product.nameEn"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(r=>[L(c(r.data.name_en),1)]),_:1},8,["header"]),s(l(h),{field:"base_price",header:l(t)("product.basePrice"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(r=>[L(c(r.data.base_price),1)]),_:1},8,["header"]),s(l(h),{field:"is_displayed",header:l(t)("product.isDisplayed"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(r=>[s(l(ze),{value:r.data.is_displayed?l(t)("yes"):l(t)("no"),severity:r.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),s(l(h),{header:l(t)("actions"),"header-style":"width: 12rem"},{body:d(r=>[F(s(o,{icon:"pi pi-pencil",class:"p-detail",onClick:q=>De(r.data.id)},null,8,["onClick"]),[[V,"edit products"],[se,l(t)("edit"),void 0,{top:!0}]]),F(s(o,{icon:"pi pi-trash mx-2",class:"p-delete",onClick:q=>ye(r.data.id)},null,8,["onClick"]),[[V,"delete products"],[se,l(t)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1,__:[19]},8,["value","loading","rows","filters","totalRecords"])),[[V,"list products"]]),n("div",Xe,[n("div",Ye,[n("span",Ze,c(l(t)("show"))+" "+c(ae.value)+" "+c(l(t)("to"))+" "+c(le.value)+" "+c(l(t)("from"))+" "+c(I.value),1)]),n("div",et,[n("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:e[6]||(e[6]=r=>E(1))},e[20]||(e[20]=[n("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,tt),n("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!te.value,onClick:e[7]||(e[7]=r=>E(p.value-1))},e[21]||(e[21]=[n("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,at),(g(!0),w(de,null,Be(oe.value,(r,q)=>(g(),w(de,{key:q},[r.label&&!isNaN(parseInt(r.label))?(g(),w("button",{key:0,class:Ae(["p-paginator-page p-paginator-element p-link",{"p-highlight":r.active}]),onClick:mt=>E(parseInt(r.label))},c(r.label),11,lt)):r.label==="..."?(g(),w("span",ot,"...")):ce("",!0)],64))),128)),n("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!ee.value,onClick:e[8]||(e[8]=r=>E(p.value+1))},e[22]||(e[22]=[n("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,rt),n("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===T.value,onClick:e[9]||(e[9]=r=>E(T.value))},e[23]||(e[23]=[n("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,st),s(l(N),{modelValue:y.value,"onUpdate:modelValue":e[10]||(e[10]=r=>y.value=r),options:[5,10,20,30],onChange:he,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),s(Q,{visible:x.value,"onUpdate:visible":e[12]||(e[12]=r=>x.value=r),style:{width:"450px"},header:l(t)("product.deleteConfirmTitle"),modal:!0},{footer:d(()=>[s(o,{label:l(t)("no"),icon:"pi pi-times",class:"p-button-text",onClick:e[11]||(e[11]=r=>x.value=!1)},null,8,["label"]),s(o,{label:l(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:_e},null,8,["label"])]),default:d(()=>[n("div",it,[e[24]||(e[24]=n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),n("span",null,c(l(t)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),s(Q,{visible:C.value,"onUpdate:visible":e[14]||(e[14]=r=>C.value=r),style:{width:"450px"},header:l(t)("product.importTitle"),modal:!0},{footer:d(()=>[s(o,{label:l(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:e[13]||(e[13]=r=>C.value=!1)},null,8,["label"]),s(o,{label:l(t)("product.importButton"),icon:"pi pi-check",loading:z.value,disabled:!v.value,onClick:Se},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",nt,[s(o,{label:l(t)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:xe},null,8,["label"]),s(l(ue),{mode:"basic","custom-upload":!0,onSelect:Ce,maxFileSize:1e7,chooseLabel:"Select File"}),v.value?(g(),w("div",dt,[n("p",ct,c(l(t)("selectedFile"))+": "+c(v.value.name),1)])):ce("",!0)])]),_:1},8,["visible","header"]),s(Q,{visible:$.value,"onUpdate:visible":e[16]||(e[16]=r=>$.value=r),style:{width:"450px"},header:l(t)("product.updatePriceTitle"),modal:!0},{footer:d(()=>[s(o,{label:l(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:e[15]||(e[15]=r=>$.value=!1)},null,8,["label"]),s(o,{label:l(t)("product.updatePriceButton"),icon:"pi pi-check",loading:A.value,disabled:!D.value,onClick:Ue},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",ut,[s(o,{label:l(t)("product.downloadPriceExample"),icon:"pi pi-download",class:"p-button-outlined p-button-warning",onClick:ke},null,8,["label"]),s(l(ue),{mode:"basic","custom-upload":!0,onSelect:Pe,maxFileSize:1e7,chooseLabel:"Select Price File"})])]),_:1},8,["visible","header"])])])])}}};export{bt as default};
