import{_ as ce,b as ue,L as pe,u as _e,r as y,I as T,d as me,y as w,V as ve,z as be,o as h,e as x,f as e,t as r,j as l,s as g,g as d,x as f,F as E,B as H,h as J,P as U,a as D,p as ge,m as fe}from"./index-b794012a.js";const b=C=>(ge("data-v-8b5ebb5a"),C=C(),fe(),C),ye=["dir"],he={class:"text-3xl font-bold text-center mb-8 text-gray-800"},xe=["onSubmit"],Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ke={class:"space-y-2"},we={for:"store_id",class:"block text-sm font-medium text-gray-700"},Ue=b(()=>e("span",{class:"text-red-500"},"*",-1)),Ie={class:"space-y-2"},De={for:"category_id",class:"block text-sm font-medium text-gray-700"},Ce=b(()=>e("span",{class:"text-red-500"},"*",-1)),Le={class:"space-y-2"},Fe={for:"brand_id",class:"block text-sm font-medium text-gray-700"},Se=b(()=>e("span",{class:"text-red-500"},"*",-1)),$e={class:"space-y-2"},Te={for:"name_en",class:"block text-sm font-medium text-gray-700"},Ae=b(()=>e("span",{class:"text-red-500"},"*",-1)),je={class:"space-y-2"},Be={for:"name_ar",class:"block text-sm font-medium text-gray-700"},Ee=b(()=>e("span",{class:"text-red-500"},"*",-1)),Ne={class:"space-y-2"},Pe={for:"sub_name_en",class:"block text-sm font-medium text-gray-700"},Re={class:"space-y-2"},ze={for:"sub_name_ar",class:"block text-sm font-medium text-gray-700"},Me={class:"md:col-span-2 space-y-2"},qe={for:"description_en",class:"block text-sm font-medium text-gray-700"},Ge={class:"md:col-span-2 space-y-2"},Oe={for:"description_ar",class:"block text-sm font-medium text-gray-700"},He={class:"space-y-2"},Je={for:"tax",class:"block text-sm font-medium text-gray-700"},Ke={class:"space-y-2"},Qe={for:"is_displayed",class:"block text-sm font-medium text-gray-700"},We={class:"space-y-2"},Xe={for:"base_price",class:"block text-sm font-medium text-gray-700"},Ye=b(()=>e("span",{class:"text-red-500"},"*",-1)),Ze={class:"space-y-2"},et={for:"cost_price",class:"block text-sm font-medium text-gray-700"},tt={class:"md:col-span-2 space-y-2"},at={class:"flex items-center"},st={for:"hasVariants",class:"text-sm font-medium text-gray-700"},ot={key:1,class:"md:col-span-2 space-y-4"},lt={class:"border-b pb-2"},it={class:"text-lg font-semibold text-gray-800"},rt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},nt={class:"space-y-2 md:col-span-2"},dt=["for"],ct=b(()=>e("span",{class:"text-red-500"},"*",-1)),ut={class:"space-y-2"},pt=["for"],_t=b(()=>e("span",{class:"text-red-500"},"*",-1)),mt={class:"space-y-2"},vt=["for"],bt=b(()=>e("span",{class:"text-red-500"},"*",-1)),gt={class:"space-y-2"},ft=["for"],yt=b(()=>e("span",{class:"text-red-500"},"*",-1)),ht={class:"space-y-2"},xt=["for"],Vt={class:"space-y-2"},kt=["for"],wt=["for","onDrop"],Ut=["id","onChange"],It={key:0,class:"p-4"},Dt={class:"relative group"},Ct=["src"],Lt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ft=["onClick","title"],St=b(()=>e("i",{class:"pi pi-trash text-sm"},null,-1)),$t=[St],Tt={class:"mt-2 text-center text-sm text-gray-500"},At={key:1,class:"p-4 flex flex-col items-center justify-center"},jt=b(()=>e("div",{class:"bg-blue-100 p-2 rounded-full mb-2"},[e("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),Bt={class:"text-xs text-center text-gray-600"},Et={class:"text-blue-500 font-medium"},Nt={class:"text-xs text-gray-400"},Pt={class:"flex justify-end"},Rt={class:"md:col-span-2 space-y-2"},zt={class:"block text-sm font-medium text-gray-700"},Mt=["onDrop"],qt={key:0,class:"space-y-4"},Gt={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},Ot=["src"],Ht={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Jt=["onClick","title"],Kt=b(()=>e("i",{class:"pi pi-trash text-sm"},null,-1)),Qt=[Kt],Wt={class:"text-center text-sm text-gray-500"},Xt={key:1,class:"flex flex-col items-center justify-center space-y-3"},Yt=b(()=>e("div",{class:"bg-blue-100 p-3 rounded-full"},[e("i",{class:"pi pi-images text-blue-500 text-2xl"})],-1)),Zt={class:"text-sm text-center text-gray-600"},ea={class:"text-blue-500 font-medium"},ta={class:"text-xs text-gray-400"},aa={class:"pt-4 flex justify-center space-x-4"},sa={setup(C){const N=ue(),v=pe(),{t:a}=_e();y();const L=y(!1),k=y(!1),P=y([]),R=y([]),z=y([]),M=y([]),V=y(!1),A=y([]),F=y([]),S=T(()=>localStorage.getItem("appLang")||"en"),I=T(()=>S.value==="en"?"name_en":"name_ar"),K=T(()=>S.value==="ar"),s=y({store_id:null,category_id:null,brand_id:null,name_en:"",name_ar:"",sub_name_en:"",sub_name_ar:"",description_en:"",description_ar:"",base_price:null,cost_price:null,tax:0,is_displayed:!0,variants:[]}),Q=T(()=>M.value.map(i=>({label:S.value==="en"?i.name_en:i.name_ar,value:i.id,items:i.values.map(t=>({id:t.id,[I.value]:S.value==="en"?t.value_en:t.value_ar}))}))),W=async()=>{try{const i=await D.get("/api/store");P.value=i.data.data.data}catch{v.add({severity:"error",summary:a("error"),detail:a("error.storeLoad"),life:3e3})}},X=async()=>{try{const i=await D.get("/api/category");R.value=i.data.data.data}catch{v.add({severity:"error",summary:a("error"),detail:a("error.categoryLoad"),life:3e3})}},Y=async()=>{try{const i=await D.get("/api/brand");z.value=i.data.data.data}catch{v.add({severity:"error",summary:a("error"),detail:a("error.brandLoad"),life:3e3})}},Z=async()=>{try{const i=await D.get("/api/product/create/data");M.value=i.data.data}catch{v.add({severity:"error",summary:a("error"),detail:a("error.attributeLoad"),life:3e3})}};me(()=>{W(),X(),Y(),Z()});const ee=i=>{for(let t=0;t<i.length;t++){const u=i[t];if(u.size>2*1024*1024){v.add({severity:"error",summary:a("error"),detail:a("validation.imageSize"),life:3e3});continue}if(!u.type.match("image.*")){v.add({severity:"error",summary:a("error"),detail:a("validation.imageInvalid"),life:3e3});continue}const _=new FileReader;_.onload=n=>{A.value.push(u),F.value.push(n.target.result)},_.readAsDataURL(u)}k.value=!1},q=i=>{var u;const t=i.target.files||((u=i.dataTransfer)==null?void 0:u.files);t&&t.length>0&&ee(t)},te=i=>{A.value.splice(i,1),F.value.splice(i,1)},ae=(i,t)=>{if(i.size>2*1024*1024){v.add({severity:"error",summary:a("error"),detail:a("validation.imageSize"),life:3e3});return}if(!i.type.match("image.*")){v.add({severity:"error",summary:a("error"),detail:a("validation.imageInvalid"),life:3e3});return}s.value.variants[t].variant_image=i;const u=new FileReader;u.onload=_=>{s.value.variants[t].variant_image_preview=_.target.result},u.readAsDataURL(i)},G=(i,t)=>{var _,n,m;const u=((_=i.target.files)==null?void 0:_[0])||((m=(n=i.dataTransfer)==null?void 0:n.files)==null?void 0:m[0]);u&&ae(u,t)},se=i=>{s.value.variants[i].variant_image=null,s.value.variants[i].variant_image_preview=null},oe=()=>{V.value=!V.value,V.value&&!s.value.variants.length?O():V.value||(s.value.variants=[])},O=()=>{s.value.variants.push({sku_ar:"",sku_en:"",price:"",cost_price:null,attribute_value_ids:[],variant_image:null,variant_image_preview:null})},le=i=>{s.value.variants.length>1?s.value.variants.splice(i,1):v.add({severity:"warn",summary:a("error"),detail:a("validation.atLeastOneVariant"),life:3e3})},ie=async()=>{var u,_;if(["store_id","category_id","brand_id","name_en","name_ar"].some(n=>!s.value[n])){v.add({severity:"error",summary:a("error"),detail:a("validation.requiredFields"),life:3e3});return}if(V.value){if(s.value.variants.some(n=>!n.sku_en||!n.sku_ar||!n.price||n.attribute_value_ids.length===0)){v.add({severity:"error",summary:a("error"),detail:a("validation.variantRequiredFields"),life:3e3});return}}else if(!s.value.base_price){v.add({severity:"error",summary:a("error"),detail:a("validation.basePriceRequired"),life:3e3});return}L.value=!0;const t=new FormData;t.append("store_id",s.value.store_id),t.append("category_id",s.value.category_id),t.append("brand_id",s.value.brand_id),t.append("name_en",s.value.name_en),t.append("name_ar",s.value.name_ar),t.append("sub_name_en",s.value.sub_name_en||""),t.append("sub_name_ar",s.value.sub_name_ar||""),t.append("description_en",s.value.description_en||""),t.append("description_ar",s.value.description_ar||""),t.append("tax",s.value.tax),t.append("is_displayed",s.value.is_displayed?1:0),A.value.forEach((n,m)=>{t.append(`main_images[${m}]`,n)}),V.value?s.value.variants.forEach((n,m)=>{t.append(`variants[${m}][sku_en]`,n.sku_en),t.append(`variants[${m}][sku_ar]`,n.sku_ar),t.append(`variants[${m}][price]`,n.price),t.append(`variants[${m}][cost_price]`,n.cost_price||0),Array.isArray(n.attribute_value_ids)&&n.attribute_value_ids.forEach((j,B)=>{t.append(`variants[${m}][attribute_value_ids][${B}]`,j)}),n.variant_image&&t.append(`variants[${m}][variant_image]`,n.variant_image)}):(t.append("base_price",s.value.base_price),t.append("cost_price",s.value.cost_price||0));try{await D.post("/api/product",t,{headers:{"Content-Type":"multipart/form-data"}}),N.push({name:"product"}),v.add({severity:"success",summary:a("success"),detail:a("product.createSuccess"),life:3e3})}catch(n){v.add({severity:"error",summary:a("error"),detail:((_=(u=n.response)==null?void 0:u.data)==null?void 0:_.message)||a("error.createError"),life:3e3})}finally{L.value=!1}};return(i,t)=>{const u=w("Dropdown"),_=w("InputText"),n=w("Textarea"),m=w("InputNumber"),j=w("InputSwitch"),B=w("Checkbox"),re=w("MultiSelect"),$=w("Button"),ne=w("Toast"),de=ve("can");return be((h(),x("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:l(K)?"rtl":"ltr"},[e("h1",he,r(l(a)("product.createTitle")),1),e("form",{onSubmit:U(ie,["prevent"]),class:"space-y-6"},[e("div",Ve,[e("div",ke,[e("label",we,[g(r(l(a)("product.store"))+" ",1),Ue]),d(u,{filter:"",id:"store_id",modelValue:s.value.store_id,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.store_id=o),options:P.value,optionLabel:l(I),optionValue:"id",class:f(["w-full",{"p-invalid":!s.value.store_id}])},null,8,["modelValue","options","optionLabel","class"])]),e("div",Ie,[e("label",De,[g(r(l(a)("product.category"))+" ",1),Ce]),d(u,{filter:"",id:"category_id",modelValue:s.value.category_id,"onUpdate:modelValue":t[1]||(t[1]=o=>s.value.category_id=o),options:R.value,optionLabel:l(I),optionValue:"id",class:f(["w-full",{"p-invalid":!s.value.category_id}])},null,8,["modelValue","options","optionLabel","class"])]),e("div",Le,[e("label",Fe,[g(r(l(a)("product.brand"))+" ",1),Se]),d(u,{filter:"",id:"brand_id",modelValue:s.value.brand_id,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.brand_id=o),options:z.value,optionLabel:l(I),optionValue:"id",class:f(["w-full",{"p-invalid":!s.value.brand_id}])},null,8,["modelValue","options","optionLabel","class"])]),e("div",$e,[e("label",Te,[g(r(l(a)("product.nameEn"))+" ",1),Ae]),d(_,{id:"name_en",modelValue:s.value.name_en,"onUpdate:modelValue":t[3]||(t[3]=o=>s.value.name_en=o),class:f(["w-full",{"p-invalid":!s.value.name_en}])},null,8,["modelValue","class"])]),e("div",je,[e("label",Be,[g(r(l(a)("product.nameAr"))+" ",1),Ee]),d(_,{id:"name_ar",modelValue:s.value.name_ar,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.name_ar=o),dir:"rtl",class:f(["w-full",{"p-invalid":!s.value.name_ar}])},null,8,["modelValue","class"])]),e("div",Ne,[e("label",Pe,r(l(a)("product.subNameEn")),1),d(_,{id:"sub_name_en",modelValue:s.value.sub_name_en,"onUpdate:modelValue":t[5]||(t[5]=o=>s.value.sub_name_en=o),class:"w-full"},null,8,["modelValue"])]),e("div",Re,[e("label",ze,r(l(a)("product.subNameAr")),1),d(_,{id:"sub_name_ar",modelValue:s.value.sub_name_ar,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.sub_name_ar=o),dir:"rtl",class:"w-full"},null,8,["modelValue"])]),e("div",Me,[e("label",qe,r(l(a)("product.descriptionEn")),1),d(n,{id:"description_en",modelValue:s.value.description_en,"onUpdate:modelValue":t[7]||(t[7]=o=>s.value.description_en=o),rows:"4",class:"w-full"},null,8,["modelValue"])]),e("div",Ge,[e("label",Oe,r(l(a)("product.descriptionAr")),1),d(n,{id:"description_ar",modelValue:s.value.description_ar,"onUpdate:modelValue":t[8]||(t[8]=o=>s.value.description_ar=o),rows:"4",dir:"rtl",class:"w-full"},null,8,["modelValue"])]),e("div",He,[e("label",Je,r(l(a)("product.tax"))+" (%) ",1),d(m,{id:"tax",modelValue:s.value.tax,"onUpdate:modelValue":t[9]||(t[9]=o=>s.value.tax=o),mode:"decimal",min:0,max:100,minFractionDigits:2,class:"w-full"},null,8,["modelValue"])]),e("div",Ke,[e("label",Qe,r(l(a)("product.displayStatus")),1),d(j,{id:"is_displayed",modelValue:s.value.is_displayed,"onUpdate:modelValue":t[10]||(t[10]=o=>s.value.is_displayed=o)},null,8,["modelValue"])]),V.value?H("",!0):(h(),x(E,{key:0},[e("div",We,[e("label",Xe,[g(r(l(a)("product.basePrice"))+" ",1),Ye]),d(m,{id:"base_price",modelValue:s.value.base_price,"onUpdate:modelValue":t[11]||(t[11]=o=>s.value.base_price=o),mode:"decimal",minFractionDigits:2,class:f(["w-full",{"p-invalid":!s.value.base_price}])},null,8,["modelValue","class"])]),e("div",Ze,[e("label",et,r(l(a)("product.costPrice")),1),d(m,{id:"cost_price",modelValue:s.value.cost_price,"onUpdate:modelValue":t[12]||(t[12]=o=>s.value.cost_price=o),mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["modelValue"])])],64)),e("div",tt,[e("div",at,[d(B,{modelValue:V.value,"onUpdate:modelValue":t[13]||(t[13]=o=>V.value=o),inputId:"hasVariants",binary:!0,onClick:oe,class:"mr-2"},null,8,["modelValue"]),e("label",st,r(l(a)("product.hasVariants")),1)])]),V.value?(h(),x("div",ot,[e("div",lt,[e("h3",it,r(l(a)("product.variants")),1)]),(h(!0),x(E,null,J(s.value.variants,(o,c)=>(h(),x("div",{key:c,class:"p-4 border rounded-lg space-y-4 bg-gray-50"},[e("div",rt,[e("div",nt,[e("label",{for:"attributes_"+c,class:"block text-sm font-medium text-gray-700"},[g(r(l(a)("product.attributes"))+" ",1),ct],8,dt),d(re,{id:"attributes_"+c,modelValue:o.attribute_value_ids,"onUpdate:modelValue":p=>o.attribute_value_ids=p,options:l(Q),optionGroupLabel:"label",optionGroupChildren:"items",optionLabel:l(I),optionValue:"id",class:f(["w-full",{"p-invalid":o.attribute_value_ids.length===0}]),display:"chip",filter:!0,showToggleAll:!1},null,8,["id","modelValue","onUpdate:modelValue","options","optionLabel","class"])]),e("div",ut,[e("label",{for:"sku_en_"+c,class:"block text-sm font-medium text-gray-700"},[g(r(l(a)("product.skuEn"))+" ",1),_t],8,pt),d(_,{id:"sku_en_"+c,modelValue:o.sku_en,"onUpdate:modelValue":p=>o.sku_en=p,class:f(["w-full",{"p-invalid":!o.sku_en}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),e("div",mt,[e("label",{for:"sku_ar_"+c,class:"block text-sm font-medium text-gray-700"},[g(r(l(a)("product.skuAr"))+" ",1),bt],8,vt),d(_,{id:"sku_ar_"+c,modelValue:o.sku_ar,"onUpdate:modelValue":p=>o.sku_ar=p,dir:"rtl",class:f(["w-full",{"p-invalid":!o.sku_ar}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),e("div",gt,[e("label",{for:"price_"+c,class:"block text-sm font-medium text-gray-700"},[g(r(l(a)("product.price"))+" ",1),yt],8,ft),d(m,{id:"price_"+c,modelValue:o.price,"onUpdate:modelValue":p=>o.price=p,mode:"decimal",minFractionDigits:2,class:f(["w-full",{"p-invalid":!o.price}])},null,8,["id","modelValue","onUpdate:modelValue","class"])]),e("div",ht,[e("label",{for:"cost_price_"+c,class:"block text-sm font-medium text-gray-700"},r(l(a)("product.costPrice")),9,xt),d(m,{id:"cost_price_"+c,modelValue:o.cost_price,"onUpdate:modelValue":p=>o.cost_price=p,mode:"decimal",minFractionDigits:2,class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue"])]),e("div",Vt,[e("label",{for:"variant_image_"+c,class:"block text-sm font-medium text-gray-700"},r(l(a)("product.variantImage")),9,kt),e("label",{for:"variant_image_"+c,onDragover:t[14]||(t[14]=U(p=>k.value=!0,["prevent"])),onDragleave:t[15]||(t[15]=p=>k.value=!1),onDrop:U(p=>G(p,c),["prevent"]),class:f([{"border-blue-500 bg-blue-50":k.value,"border-gray-300":!k.value},"cursor-pointer w-full rounded-lg border-2 border-dashed transition-colors duration-300 block"])},[e("input",{type:"file",id:"variant_image_"+c,onChange:p=>G(p,c),accept:"image/*",class:"hidden"},null,40,Ut),o.variant_image_preview?(h(),x("div",It,[e("div",Dt,[e("img",{src:o.variant_image_preview,alt:"Variant Preview",class:"w-full h-32 object-contain rounded-lg shadow-md"},null,8,Ct),e("div",Lt,[e("button",{type:"button",onClick:U(p=>se(c),["stop"]),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition",title:l(a)("product.deleteImage")},$t,8,Ft)])]),e("p",Tt,r(l(a)("product.changeImage")),1)])):(h(),x("div",At,[jt,e("p",Bt,[e("span",Et,r(l(a)("product.uploadClick")),1),g(" "+r(l(a)("product.uploadDrag")),1)]),e("p",Nt,r(l(a)("product.imageFormat")),1)]))],42,wt)])]),e("div",Pt,[d($,{type:"button",icon:"pi pi-trash",class:"p-button-danger p-button-sm",onClick:p=>le(c),disabled:s.value.variants.length===1,label:l(a)("product.removeVariant")},null,8,["onClick","disabled","label"])])]))),128)),d($,{type:"button",label:l(a)("product.addVariant"),icon:"pi pi-plus",class:"p-button-outlined p-button-secondary",onClick:O},null,8,["label"])])):H("",!0),e("div",Rt,[e("label",zt,r(l(a)("product.images")),1),e("label",{for:"main_images_upload",onDragover:t[16]||(t[16]=U(o=>k.value=!0,["prevent"])),onDragleave:t[17]||(t[17]=o=>k.value=!1),onDrop:U(q,["prevent"]),class:f([{"border-blue-500 bg-blue-50":k.value,"border-gray-300":!k.value},"cursor-pointer w-full rounded-xl border-2 border-dashed transition-colors duration-300 p-6 block"])},[e("input",{type:"file",id:"main_images_upload",onChange:q,accept:"image/*",multiple:"",class:"hidden"},null,32),F.value.length>0?(h(),x("div",qt,[e("div",Gt,[(h(!0),x(E,null,J(F.value,(o,c)=>(h(),x("div",{key:c,class:"relative group"},[e("img",{src:o,alt:"Preview",class:"w-full h-32 object-cover rounded-lg shadow-md"},null,8,Ot),e("div",Ht,[e("button",{type:"button",onClick:U(p=>te(c),["stop"]),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition",title:l(a)("product.deleteImage")},Qt,8,Jt)])]))),128))]),e("p",Wt,r(l(a)("product.addMoreImages")),1)])):(h(),x("div",Xt,[Yt,e("p",Zt,[e("span",ea,r(l(a)("product.uploadClick")),1),g(" "+r(l(a)("product.uploadDrag")),1)]),e("p",ta,r(l(a)("product.imageFormat")),1)]))],42,Mt)])]),e("div",aa,[d($,{type:"button",label:l(a)("product.cancelButton"),icon:"pi pi-times",onClick:t[18]||(t[18]=o=>l(N).go(-1)),class:"p-button-outlined p-button-secondary",disabled:L.value},null,8,["label","disabled"]),d($,{type:"submit",label:l(a)("product.createButton"),icon:"pi pi-check",loading:L.value,class:"p-button-success"},null,8,["label","loading"])])],40,xe),d(ne)],8,ye)),[[de,"create products"]])}}},la=ce(sa,[["__scopeId","data-v-8b5ebb5a"]]);export{la as default};
