import{_ as re,j as le,k as oe,u as ne,q as ie,D as ue,r as p,l as C,i as T,o as ce,a as i,c as u,h as V,e as r,f as t,t as o,g as f,F as A,d as F,v as z,E as de,x as ve,z as me,G as pe,H as B,I as _e}from"./index-39233d5b.js";import{P as fe}from"./ProductOffers-4aae7b76.js";import{l as ge}from"./lodash-8473cdb2.js";const ye={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},he={key:0,class:"text-center"},be={class:"mt-2"},xe={key:1,class:"text-red-500 text-center"},we={key:2,class:"flex flex-col lg:flex-row items-start gap-8"},ke={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},Ce={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-2 w-full lg:w-1/4"},Oe=["src","alt","onClick"],De={class:"w-full lg:w-3/4"},Se={class:"w-full aspect-square shadow-lg rounded-md overflow-hidden"},Ee=["src","alt"],qe={class:"w-full lg:w-1/2 flex flex-col justify-between p-4 bg-white rounded-md"},je={class:"text-3xl font-bold text-gray-800 mb-2"},Re={key:0,class:"text-xl text-gray-600 mb-4"},$e={class:"mt-4 flex flex-wrap gap-2 text-center"},Te={class:"flex items-center gap-6 mb-4"},Ve={class:"text-xl font-bold text-gray-800"},Ie={class:"text-2xl font-bold text-blue-600"},Ae={class:"flex items-center gap-4 mb-4"},Fe={class:"font-bold text-gray-700"},Le={class:"flex items-center border border-gray-300 rounded-md"},Ne=["disabled","aria-label"],Me={class:"px-4 py-1 border-x border-gray-300"},Qe=["disabled","aria-label"],ze={class:"text-gray-600 my-4"},Be=["disabled","aria-label","title"],Pe={key:0,class:"flex items-center justify-center gap-2"},Ue={key:1},Ge={key:0,class:"text-red-500 text-sm mt-2"},He={key:3,class:"bg-[#E6AC312B] px-6 pt-2 pb-12 rounded-md mt-8"},Je={class:"leading-relaxed text-sm text-gray-700"},We={key:4,class:"mt-8 p-4 bg-white rounded-md shadow-md"},Ke={class:"flex justify-center items-center flex-col"},Xe={class:"text-2xl font-bold text-gray-800 mb-4"},Ye={class:"flex flex-col md:flex-row justify-center items-center gap-8 mt-4"},Ze={class:"text-center"},et={class:"text-5xl font-bold text-gray-800"},tt={class:"card flex justify-center my-2"},st={class:"text-gray-500"},at={class:"w-full md:w-1/3"},rt={class:"text-sm font-bold w-4"},lt={class:"w-full relative h-2 bg-gray-200 rounded overflow-hidden"},ot={class:"text-[#A17D1C] text-sm w-8"},nt={key:0,class:"flex flex-col justify-center items-center mt-6"},it=["placeholder"],ut=["disabled","aria-label"],ct={key:0,class:"text-red-500 text-sm mt-2"},dt={key:1,class:"text-center mt-6"},vt={class:"text-gray-600 mb-4"},mt=["aria-label"],pt={key:2,class:"mt-8"},_t={class:"text-xl font-bold text-gray-800 mb-4"},ft={class:"flex items-center justify-between mb-2"},gt={class:"flex items-center gap-2"},yt={class:"font-semibold text-gray-800"},ht={class:"text-sm text-gray-500"},bt={class:"text-gray-700"},xt={key:3,class:"text-center mt-8 py-6"},wt={class:"text-gray-500"},kt={key:5,class:"mt-8"},Ct={__name:"product-details",setup(Ot){const{t:e,locale:h}=le(),L=oe(),g=ne(),D=ie(),b=ue(),a=p({}),q=p([]),x=p(0),S=p(""),O=p(!1),y=p(null),E=p(!1),w=p(!1),_=p([]),j=p(!1),k=p(null),m=p({rating:0,comment:""}),R=p(!1),P=C(()=>_.value.slice(0,3)),U=C(()=>_.value.length===0?0:_.value.reduce((s,d)=>s+d.rate,0)/_.value.length),G=C(()=>{const l={5:0,4:0,3:0,2:0,1:0};return _.value.forEach(s=>{s.rate>=1&&s.rate<=5&&l[s.rate]++}),[5,4,3,2,1].map(s=>({starsNumber:s,count:l[s],percentage:_.value.length>0?Math.round(l[s]/_.value.length*100):0}))}),$=C(()=>h.value==="en"?a.value.description_en:a.value.description_ar||e("product.noDescription")),H=C(()=>{var l;return(l=$.value)==null?void 0:l.length}),N=C(()=>H.value>200),J=C(()=>N.value?$.value.slice(0,200)+"...":$.value),W=l=>{l&&(l.has_subcategories?g.push({name:"subcategory",params:{id:l.id}}):g.push({name:"produts_category",params:{id:l.id}}))},K=l=>{l&&g.push({name:"products-brand",params:{id:l.id}})},X=l=>{l&&(l.has_market?g.push({name:"stores-hasmarket"}):g.push({name:"home"}))},Y=async l=>{var s,d;if(!D.authenticatedweb){g.push({name:"authlog"});return}if(!(E.value||l.isOutOfStock||l.in_cart)){E.value=!0;try{const c={product_id:l.id,variant_id:l.variant_id||null,quantity:x.value};(await T.post("/api/cart/add",c)).status===200&&(a.value.in_cart=!0,b.add({severity:"success",summary:e("success"),detail:e("cart.added"),life:3e3}))}catch(c){console.error("Error adding to cart:",c),y.value=((d=(s=c.response)==null?void 0:s.data)==null?void 0:d.message)||e("cart.error"),b.add({severity:"error",summary:e("error"),detail:y.value,life:3e3})}finally{E.value=!1}}},M=async l=>{if(!D.authenticatedweb){g.push({name:"authlog"});return}if(w.value||a.value.isOutOfStock)return;const s=l==="plus"?x.value+1:x.value-1;if(!(s<1)){w.value=!0;try{const d={product_id:a.value.id,variant_id:a.value.variant_id||null,quantity:s};(await T.post("/api/cart/update",d)).status===200&&(x.value=s,a.value.in_cart||(a.value.in_cart=!0),b.add({severity:"success",summary:e("success"),detail:e(l==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:3e3}))}catch(d){console.error(`Error ${l==="plus"?"increasing":"decreasing"} quantity:`,d),b.add({severity:"error",summary:e("error"),detail:e(`cart.quantity${l==="plus"?"Increase":"Decrease"}Error`),life:3e3})}finally{w.value=!1}}},Z=l=>{S.value=l},ee=()=>{R.value=!R.value},te=l=>{if(!l)return e("reviews.na");const s={year:"numeric",month:"short",day:"numeric"};return new Date(l).toLocaleDateString(h.value,s)},se=async()=>{var l,s,d;if(!D.authenticatedweb){g.push({name:"authlog"});return}if(m.value.rating===0){k.value=e("reviews.ratingRequired");return}if(!m.value.comment.trim()){k.value=e("reviews.commentRequired");return}j.value=!0;try{const c={model_id:L.params.id,rate:m.value.rating,type:"product",message:m.value.comment.trim()},v=await T.post("/api/review",c);if(v.data.success)_.value.unshift({id:v.data.data.id,rate:m.value.rating,message:m.value.comment.trim(),user:{name:((l=D.user)==null?void 0:l.name)||e("reviews.anonymous")},created_at:new Date().toISOString()}),m.value={rating:0,comment:""},k.value=null,b.add({severity:"success",summary:e("success"),detail:e("reviews.submitSuccess"),life:3e3});else throw new Error(v.data.message||e("reviews.submitError"))}catch(c){console.error("Error submitting review:",c),k.value=((d=(s=c.response)==null?void 0:s.data)==null?void 0:d.message)||e("reviews.submitError"),b.add({severity:"error",summary:e("error"),detail:k.value,life:3e3})}finally{j.value=!1}},ae=ge.debounce(async()=>{var l,s,d;O.value=!0;try{const c=await T.get(`/api/home/product-details/${L.params.id}`);if(c.data.is_success){const v=((l=c.data.data)==null?void 0:l.product)||{};a.value={...v,in_cart:v.in_cart||!1,is_stock:v.is_stock||0,isOutOfStock:v.is_stock===0},q.value=v.media||[],S.value=q.value.length>0?q.value[0].url:a.value.key_default_image,_.value=v.reviews||[],x.value=v.in_cart&&v.quantity||1}else throw new Error(c.data.message||e("product.loadError"))}catch(c){console.error("Error fetching data:",c),y.value=((d=(s=c.response)==null?void 0:s.data)==null?void 0:d.message)||e("product.loadError"),b.add({severity:"error",summary:e("error"),detail:y.value,life:3e3})}finally{O.value=!1}},300);return ce(()=>{window.scrollTo(0,0),ae()}),(l,s)=>{var d,c,v,Q;return i(),u("div",ye,[O.value?(i(),u("div",he,[V(r(pe),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),t("p",be,o(r(e)("loading")),1)])):f("",!0),y.value?(i(),u("div",xe,o(y.value),1)):(i(),u("header",we,[t("div",ke,[t("div",Ce,[(i(!0),u(A,null,F(q.value,n=>(i(),u("img",{key:n.url,src:n.url,alt:r(e)("product.thumbnailAlt"),class:z(["h-20 w-20 object-cover rounded-lg cursor-pointer border-2 transition-all duration-200",{"border-blue-500":S.value===n.url,"border-transparent":S.value!==n.url}]),onClick:I=>Z(n.url)},null,10,Oe))),128))]),t("div",De,[t("div",Se,[t("img",{src:S.value||a.value.key_default_image,alt:r(e)("product.mainImageAlt"),class:"w-full h-full object-cover"},null,8,Ee)])])]),t("div",qe,[t("h1",je,o(r(h)==="en"?a.value.name_en:a.value.name_ar),1),a.value.sub_name_en||a.value.sub_name_ar?(i(),u("h2",Re,o(r(h)==="en"?a.value.sub_name_en:a.value.sub_name_ar),1)):f("",!0),t("section",$e,[a.value.store_id?(i(),u("span",{key:0,onClick:s[0]||(s[0]=n=>X(a.value.store)),class:"sub-tiles cursor-pointer"},o(r(h)==="en"?(d=a.value.store)==null?void 0:d.name_en:((c=a.value.store)==null?void 0:c.name_ar)||r(e)("store.default")),1)):f("",!0),a.value.category&&(a.value.category.name_en||a.value.category.name_ar)?(i(),u("span",{key:1,onClick:s[1]||(s[1]=n=>W(a.value.category)),class:"sub-tiles cursor-pointer"},o(r(h)==="en"?a.value.category.name_en:a.value.category.name_ar),1)):f("",!0),a.value.brand_id?(i(),u("span",{key:2,onClick:s[2]||(s[2]=n=>K(a.value.brand)),class:"sub-tiles cursor-pointer"},o(r(h)==="en"?(v=a.value.brand)==null?void 0:v.name_en:((Q=a.value.brand)==null?void 0:Q.name_ar)||r(e)("brand.default")),1)):f("",!0)]),s[10]||(s[10]=t("hr",{class:"bg-[#A17D1C] my-6 h-[1px] border-0"},null,-1)),t("section",null,[t("div",Te,[t("span",Ve,o(r(e)("product.price"))+":",1),t("span",Ie,o(a.value.base_price_after_discount)+" JOD",1)]),t("div",Ae,[t("label",Fe,o(r(e)("product.quantity"))+":",1),t("div",Le,[t("button",{onClick:s[3]||(s[3]=n=>M("minus")),class:"px-3 py-1 text-lg font-bold hover:bg-gray-100 rounded-l-md",disabled:x.value<=0||w.value,"aria-label":r(e)("product.decreaseQuantity")}," - ",8,Ne),t("span",Me,o(x.value),1),t("button",{onClick:s[4]||(s[4]=n=>M("plus")),class:"px-3 py-1 text-lg font-bold hover:bg-gray-100 rounded-r-md",disabled:w.value||a.value.isOutOfStock,"aria-label":r(e)("product.increaseQuantity")}," + ",8,Qe)])]),t("p",ze,o(r(e)("product.deliveryTime")),1),t("button",{disabled:E.value||a.value.isOutOfStock||a.value.in_cart&&!w.value,onClick:s[5]||(s[5]=n=>Y(a.value)),class:z(["w-full py-3 text-lg font-bold rounded-md text-white transition-transform duration-150 ease-in-out active:scale-95 hover:shadow-lg",{"bg-[var(--main-text-color)]":!a.value.in_cart&&!a.value.isOutOfStock,"bg-gray-300 text-gray-500 cursor-not-allowed":a.value.isOutOfStock||a.value.in_cart&&!w.value}]),"aria-label":a.value.in_cart?r(e)("product.inCart"):a.value.isOutOfStock?r(e)("product.outOfStock"):r(e)("product.addToCart"),title:a.value.in_cart?r(e)("product.inCart"):a.value.isOutOfStock?r(e)("product.outOfStock"):r(e)("product.addToCart")},[a.value.in_cart?(i(),u("span",Pe,[s[9]||(s[9]=t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"})],-1)),de(" "+o(r(e)("product.inCart")),1)])):(i(),u("span",Ue,o(E.value?r(e)("product.adding"):r(e)("product.addToCart")),1))],10,Be),a.value.isOutOfStock?(i(),u("p",Ge,o(r(e)("product.outOfStock")),1)):f("",!0)])])])),!O.value&&!y.value?(i(),u("section",He,[t("p",Je,o(R.value?$.value:J.value),1),N.value?(i(),u("h3",{key:0,onClick:ee,class:"text-[#E39F30] text-sm font-semibold mt-2 cursor-pointer"},o(R.value?r(e)("product.readLess"):r(e)("product.readMore")),1)):f("",!0)])):f("",!0),!O.value&&!y.value?(i(),u("section",We,[t("div",Ke,[t("h2",Xe,o(r(e)("reviews.title")),1)]),t("div",Ye,[t("div",Ze,[t("h2",et,o(U.value.toFixed(1)),1),t("div",tt,[V(r(B),{modelValue:m.value.rating,"onUpdate:modelValue":s[6]||(s[6]=n=>m.value.rating=n),cancel:!1},null,8,["modelValue"])]),t("p",st,o(_.value.length)+" "+o(_.value.length===1?r(e)("reviews.singular"):r(e)("reviews.plural")),1)]),t("div",at,[(i(!0),u(A,null,F(G.value,n=>(i(),u("div",{key:n.starsNumber,class:"flex items-center gap-2 mb-3"},[t("span",rt,o(n.starsNumber),1),t("div",lt,[t("div",{class:"absolute top-0 left-0 h-full bg-[#F0E3C2] transition-all duration-300",style:_e({width:n.percentage+"%"})},null,4)]),t("span",ot,o(n.count),1)]))),128))])]),r(D).authenticatedweb?(i(),u("div",nt,[ve(t("textarea",{"onUpdate:modelValue":s[7]||(s[7]=n=>m.value.comment=n),class:"w-full md:w-1/2 h-32 bg-gray-50 border border-gray-300 rounded-md p-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-1 focus:ring-[#F0E3C2]",placeholder:r(e)("reviews.placeholder")},null,8,it),[[me,m.value.comment]]),t("button",{onClick:se,disabled:j.value||m.value.rating===0||!m.value.comment.trim(),class:"w-full md:w-1/2 mt-4 py-2 px-4 text-lg font-bold bg-[var(--main-text-color)] rounded-md text-white transition-transform duration-150 ease-in-out active:scale-95 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed","aria-label":r(e)("reviews.submit")},o(j.value?r(e)("reviews.submitting"):r(e)("reviews.submit")),9,ut),k.value?(i(),u("p",ct,o(k.value),1)):f("",!0)])):(i(),u("div",dt,[t("p",vt,o(r(e)("reviews.loginToReview")),1),t("button",{onClick:s[8]||(s[8]=n=>r(g).push({name:"authlog"})),class:"py-2 px-6 bg-[var(--main-text-color)] text-white rounded-md hover:bg-opacity-90 transition-colors","aria-label":r(e)("reviews.login")},o(r(e)("reviews.login")),9,mt)])),_.value.length>0?(i(),u("div",pt,[t("h3",_t,o(r(e)("reviews.customerReviews")),1),(i(!0),u(A,null,F(P.value,n=>{var I;return i(),u("div",{key:n.id,class:"border-b border-gray-200 py-4"},[t("div",ft,[t("div",gt,[t("span",yt,o(((I=n.user)==null?void 0:I.name)||r(e)("reviews.anonymous")),1),V(r(B),{modelValue:n.rate,readonly:!0,cancel:!1,class:"text-sm"},null,8,["modelValue"])]),t("span",ht,o(te(n.created_at)),1)]),t("p",bt,o(n.message),1)])}),128))])):(i(),u("div",xt,[t("p",wt,o(r(e)("reviews.noReviews")),1)]))])):f("",!0),!O.value&&!y.value?(i(),u("section",kt,[V(fe)])):f("",!0)])}}},qt=re(Ct,[["__scopeId","data-v-c1577c91"]]);export{qt as default};
