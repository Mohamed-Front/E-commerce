import{_ as H,j as T,r as g,v as N,u as U,k as W,l as G,o as A,x as J,q as E,a as n,c as o,f as i,t as _,e as h,F as O,d as I,g as v,i as b,D as j,y as S}from"./index-2b849c16.js";const K={class:"mx-auto px-4 max-w-[1500px]"},Q={key:0,class:"flex justify-center items-center py-16"},X={key:1,class:"text-center py-16 text-red-600"},Y={class:"text-lg font-semibold"},Z={key:2,class:"m-auto max-w-7xl"},ee={class:"mt-6 grid gap-x-4 gap-y-8 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-5"},te=["onClick","aria-label"],ae={class:"w-full overflow-hidden rounded-xl shadow-sm relative bg-gray-100 aspect-square"},se=["src","alt"],ie=["onClick","aria-label","title"],ne={class:"p-4 w-full"},oe={class:"font-sans text-gray-800 font-medium xs:text-sm sm:text-base md:text-lg w-full truncate"},re={key:0,class:"font-sans text-gray-600 text-sm w-full truncate"},le={class:"flex items-center w-full justify-between mt-1"},de={class:"font-sans text-[#E39F30] font-semibold text-lg"},ce=["disabled","onClick","aria-label","title"],ue={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ge={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},_e={key:0,class:"flex justify-center items-center pt-8"},fe={class:"inline-flex gap-2","aria-label":"Pagination"},me=["onClick","aria-current"],he="/placeholder.jpg",ve={__name:"media-products",props:{title:{type:String,default:""}},setup(pe){const{t:u}=T(),z=g(localStorage.getItem("appLang")||"ar"),p=N(),L=g([]),k=g(!0),w=g(null),y=U(),d=W(),x=g({current_page:1,last_page:1,next_page_url:null,prev_page_url:null,links:[]}),f=g(parseInt(d.query.page)||1),P=g(!1),C=()=>{typeof window<"u"&&(P.value=window.innerWidth<768)},$=G(()=>P.value?10:20);A(()=>{C(),typeof window<"u"&&window.addEventListener("resize",C)}),J(()=>{typeof window<"u"&&window.removeEventListener("resize",C)});const m=async(a,t=1)=>{k.value=!0,w.value=null;const e=`/api/home/get-media-link/details/${d.params.id}?limit=${$.value}&page=${t}`;try{const c=(await b.get(e)).data.data,r=c.data?c:c.details||c;x.value={current_page:r.current_page,last_page:r.last_page,next_page_url:r.next_page_url,prev_page_url:r.prev_page_url,links:r.links},f.value=r.current_page,L.value=(r.data||[]).map(s=>{var F,M;return{id:s.id,name:z.value==="ar"?s.name_ar||s.name_en:s.name_en||s.name_ar,sub_name:z.value==="ar"?s.sub_name_ar||s.sub_name_en:s.sub_name_en||s.sub_name_ar,price:s.base_price,img:((M=(F=s.media)==null?void 0:F.find(V=>V.name==="product_main_image"))==null?void 0:M.url)||s.key_default_image||he,is_wished:s.is_wished||!1,in_cart:s.in_cart||!1,isOutOfStock:s.is_stock===0,variant_id:s.has_variants?s.variant_id:null}})}catch(l){console.error("Error fetching products:",l),w.value=u("error.fetchFailed")||"Failed to load products."}finally{k.value=!1,y.push({query:{...d.query}}).catch(()=>{})}},B=a=>{y.push({name:"Product-details",params:{id:a}})},q=a=>{a>=1&&a<=x.value.last_page&&m(d.params.id,a)},D=async a=>{if(!p.authenticatedweb){y.push({name:"AuthLogin"});return}if(!a.isOutOfStock)try{const t={product_id:a.id,variant_id:a.variant_id,quantity:1};(await b.post("/api/cart/add",t)).status===200&&(a.in_cart=!0,alert(u("cart.added")||"Product added to cart!"))}catch(t){console.error("Error adding to cart:",t),alert(u("cart.error")||"Failed to add product to cart.")}},R=async a=>{if(!p.authenticatedweb){y.push({name:"AuthLogin"});return}const t=a.is_wished,e=t?"delete":"post",l=t?`/api/wishlists/${a.id}`:"/api/wishlists",c={product_id:a.id};try{let r;e==="post"?r=await b.post(l,c):r=await b.delete(l,{data:c}),(r.status===200||r.status===204)&&(a.is_wished=!t,alert(u(t?"wishlist.removed":"wishlist.added")||`Product ${t?"removed from":"added to"} wishlist!`))}catch(r){console.error("Error toggling favorite status:",r),a.is_wished=t,alert(u("wishlist.error")||"Failed to update wishlist.")}};return A(()=>{m(d.params.id,f.value)}),E(()=>d.params.id,a=>{f.value=1,m(a,1)}),E($,(a,t)=>{a!==t&&(f.value=1,m(d.params.id,1))}),(a,t)=>(n(),o("div",K,[k.value?(n(),o("div",Q,t[1]||(t[1]=[i("svg",{class:"animate-spin h-8 w-8 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):w.value?(n(),o("div",X,[i("p",Y,_(w.value),1),i("button",{onClick:t[0]||(t[0]=e=>m(h(d).params.id,f.value)),class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},_(h(u)("products.retry")||"Retry"),1)])):(n(),o("div",Z,[i("div",ee,[(n(!0),o(O,null,I(L.value,e=>(n(),o("div",{key:e.id,class:"group flex flex-col items-start cursor-pointer transition-all pb-[1%] rounded-lg shadow-lg duration-300 hover:-translate-y-2 h-auto",onClick:l=>B(e.id),"aria-label":`View product ${e.name}`},[i("div",ae,[i("img",{src:e.img,alt:e.name,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,se),t[3]||(t[3]=i("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1)),h(p).authenticatedweb?(n(),o("button",{key:0,class:"absolute top-2 right-2 p-2 rounded-full bg-white text-gray-500 hover:text-red-500 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 z-10",onClick:j(l=>R(e),["stop"]),"aria-label":e.is_wished?"Remove from wishlist":"Add to wishlist",title:e.is_wished?"Remove from wishlist":"Add to wishlist"},[(n(),o("svg",{class:S(["w-5 h-5",{"text-red-500":e.is_wished}]),fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},t[2]||(t[2]=[i("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)]),2))],8,ie)):v("",!0)]),i("div",ne,[i("p",oe,_(e.name),1),e.sub_name?(n(),o("p",re,_(e.sub_name),1)):v("",!0),i("div",le,[i("span",de,_(e.price)+" "+_(h(u)("currencyLabel")),1),h(p).authenticatedweb?(n(),o("button",{key:0,class:S(["p-2 rounded-full bg-gray-100 text-[#E39F30] transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:ring-offset-2",{"hover:bg-indigo-600 hover:text-white":!e.in_cart&&!e.isOutOfStock,"bg-gray-300 text-gray-500 cursor-not-allowed":e.isOutOfStock}]),disabled:e.isOutOfStock,onClick:j(l=>D(e),["stop"]),"aria-label":e.in_cart?"In cart":e.isOutOfStock?"Out of stock":"Add to cart",title:e.in_cart?"In cart":e.isOutOfStock?"Out of stock":"Add to cart"},[e.in_cart?(n(),o("svg",ue,t[4]||(t[4]=[i("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):(n(),o("svg",ge,t[5]||(t[5]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.708.707 1.708H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)])))],10,ce)):v("",!0)])])],8,te))),128))]),x.value.last_page>1?(n(),o("div",_e,[i("nav",fe,[(n(!0),o(O,null,I(x.value.links,(e,l)=>(n(),o(O,{key:l},[e.url&&!["« Previous","Next »"].includes(e.label)?(n(),o("button",{key:0,onClick:c=>q(parseInt(e.label)),"aria-current":e.active?"page":void 0,class:S(["px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200",e.active?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-indigo-100 hover:text-indigo-700"])},_(e.label),11,me)):v("",!0)],64))),128))])])):v("",!0)]))]))}},ye=H(ve,[["__scopeId","data-v-127eec9d"]]);export{ye as default};
