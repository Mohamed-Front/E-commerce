import{_ as Ve,u as Fe,G as Le,j as Re,r as i,q as ie,o as Be,n as N,R as ne,a as g,c as w,f as n,h as s,w as d,e as l,z as x,b as Te,t as c,F as de,d as je,i as v,S as Ne,a2 as I,$ as Ie,Q as ze,p as k,a0 as h,a4 as Ae,y as Me,g as ce,ac as ue}from"./index-23dc13f5.js";const Oe={class:"grid"},Qe={class:"col-12"},qe={class:"card p-4 shadow-2 border-round"},Ge={class:"text-2xl font-bold"},Ke={class:"flex gap-2 align-items-center"},We={class:"p-input-icon-left"},He={class:"card shadow-1 surface-0"},Je={class:"text-center py-4"},Xe={class:"text-xl"},Ye={class:"flex justify-content-center align-items-center py-4"},Ze={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},et={class:"p-paginator-left-content"},tt={class:"p-paginator-current"},at={class:"p-paginator-right-content"},lt=["disabled"],ot=["disabled"],rt=["onClick"],st={key:1,class:"p-paginator-dots"},it=["disabled"],nt=["disabled"],dt={class:"flex align-items-center justify-content-center"},ct={class:"flex flex-column gap-3"},ut={key:0,class:"mt-2"},pt={class:"font-semibold"},vt={class:"flex flex-column gap-3"},mt={__name:"index",setup(bt){const z=Fe(),u=Le(),{t:e}=Re(),R=i(!0),W=i([]),C=i(!1),H=i(null),pe=i(null),ve=i({}),S=i("");i(null);const P=i(!1),m=i(null),A=i(!1),J=i([]),X=i([]),Y=i([]),$=i(null),U=i(null),D=i(null),Z=i(""),ee=i(""),B=i(localStorage.getItem("appLang")||"en"),E=i(!1),V=i(null),M=i(!1),p=i(1),O=i(0),_=i(10),T=i(0),me=i(""),be=i(""),te=i(""),ae=i(""),le=i(0),oe=i(0),re=i([]),Q=async()=>{try{const a=await v.get("/api/category",{params:{search:Z.value||void 0}}),t=B.value;J.value=a.data.data.data.map(r=>({label:t==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(a){u.add({severity:"error",summary:e("error"),detail:e("category.loadError"),life:3e3}),console.error("Error fetching categories:",a)}},se=async()=>{try{const a=await v.get("/api/store"),t=B.value;X.value=a.data.data.data.map(r=>({label:t==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(a){u.add({severity:"error",summary:e("error"),detail:e("store.loadError"),life:3e3}),console.error("Error fetching stores:",a)}},fe=a=>{z.push({name:"product-shipping-settings",params:{id:a}})},q=async()=>{try{const a=await v.get("/api/market",{params:{search:ee.value||void 0}}),t=B.value;Y.value=a.data.data.data.map(r=>({label:t==="en"?`${r.name_en} `:`${r.name_ar} `,value:r.id}))}catch(a){u.add({severity:"error",summary:e("error"),detail:e("market.loadError"),life:3e3}),console.error("Error fetching markets:",a)}},b=()=>{R.value=!0,v.get("/api/product",{params:{page:p.value,limit:_.value,search:S.value||void 0,category_id:$.value||void 0,store_id:U.value||void 0,market_id:D.value||void 0}}).then(a=>{W.value=a.data.data.data,O.value=a.data.data.total,T.value=a.data.data.last_page,me.value=a.data.data.first_page_url,be.value=a.data.data.last_page_url,te.value=a.data.data.next_page_url,ae.value=a.data.data.prev_page_url,le.value=a.data.data.from,oe.value=a.data.data.to,re.value=a.data.data.links,R.value=!1}).catch(a=>{u.add({severity:"error",summary:e("error"),detail:e("product.loadError"),life:3e3}),R.value=!1,console.error("Error fetching products:",a)})};ie([S,_,$,U,D],()=>{p.value=1,b()}),ie(B,()=>{Q(),se(),q()});const ge=a=>{Z.value=a.value,Q()},he=a=>{ee.value=a.value,q()},F=a=>{a>=1&&a<=T.value&&(p.value=a,b())},_e=a=>{_.value=a.value,p.value=1,b()},ye=a=>{H.value=a,C.value=!0},we=()=>{v.delete(`/api/product/${H.value}`).then(()=>{u.add({severity:"success",summary:e("success"),detail:e("product.deleteSuccess"),life:3e3}),b(),C.value=!1}).catch(a=>{u.add({severity:"error",summary:e("error"),detail:e("product.deleteError"),life:3e3}),console.error("Error deleting product:",a)})},xe=()=>{const t=`/api/export/products?${new URLSearchParams({search:S.value||"",category_id:$.value||"",store_id:U.value||"",market_id:D.value||""}).toString()}`;v.get(t,{responseType:"blob"}).then(r=>{const f=new Blob([r.data],{type:"text/csv"}),y=document.createElement("a");y.href=URL.createObjectURL(f),y.download="products_export.csv",y.click(),URL.revokeObjectURL(y.href),u.add({severity:"success",summary:e("success"),detail:e("product.exportSuccess"),life:3e3})}).catch(r=>{u.add({severity:"error",summary:e("error"),detail:e("product.exportError"),life:3e3}),console.error("Error exporting products:",r)})},ke=()=>{const a=`store_id,category_id,market_id,name_en,name_ar,sku,brand_id,sub_name_en,sub_name_ar,description_en,description_ar,base_price,cost_price,tax
1,1,1,Demo Product 1,منتج تجريبي 1,SKU001,1,Sub Demo 1,تجريبي فرعي 1,Description of Demo Product 1,وصف المنتج التجريبي 1,15.50,10.00,0.05
2,2,2,Demo Product 2,منتج تجريبي 2,SKU002,2,Sub Demo 2,تجريبي فرعي 2,Description of Demo Product 2,وصف المنتج التجريبي 2,22.00,15.00,0.05`,t=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const f=URL.createObjectURL(t);r.setAttribute("href",f),r.setAttribute("download","product_import_example.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},Ce=()=>{const a=`id,price,cost_price
1,16.00,10.50
2,23.50,15.00`,t=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(r.download!==void 0){const f=URL.createObjectURL(t);r.setAttribute("href",f),r.setAttribute("download","product_price_update_example.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},Se=a=>{m.value=a.files[0]},Pe=a=>{V.value=a.files[0]},$e=()=>{if(!m.value){u.add({severity:"error",summary:e("error"),detail:e("validation.fileRequired"),life:3e3});return}A.value=!0;const a=new FormData;a.append("file",m.value),v.post("/api/import/products",a).then(()=>{u.add({severity:"success",summary:e("success"),detail:e("product.importSuccess"),life:3e3}),b(),P.value=!1,m.value=null}).catch(t=>{u.add({severity:"error",summary:e("error"),detail:e("product.importError"),life:3e3}),console.error("Error importing products:",t)}).finally(()=>{A.value=!1})},Ue=()=>{if(!V.value){u.add({severity:"error",summary:e("error"),detail:e("validation.fileRequired"),life:3e3});return}M.value=!0;const a=new FormData;a.append("file",V.value),v.post("/api/product/update/prices",a).then(()=>{u.add({severity:"success",summary:e("success"),detail:e("product.priceUpdateSuccess"),life:3e3}),b(),E.value=!1,V.value=null}).catch(t=>{u.add({severity:"error",summary:e("error"),detail:e("product.priceUpdateError"),life:3e3}),console.error("Error updating prices:",t)}).finally(()=>{M.value=!1})},De=()=>{z.push({name:"product-create"})},Ee=a=>{z.push({name:"product-update",params:{id:a}})};return Be(()=>{Promise.all([Q(),se(),q(),b()])}),(a,t)=>{const r=N("Button"),f=N("ProgressSpinner"),y=N("DataTable"),G=N("Dialog"),L=ne("can"),K=ne("tooltip");return g(),w("div",Oe,[n("div",Qe,[n("div",qe,[s(l(Ie),{class:"mb-4"},{start:d(()=>[n("h2",Ge,c(l(e)("product.managementTitle")),1)]),end:d(()=>[n("div",Ke,[n("span",We,[t[17]||(t[17]=n("i",{class:"pi pi-search"},null,-1)),s(l(Ne),{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=o=>S.value=o),placeholder:l(e)("product.search")},null,8,["modelValue","placeholder"])]),s(l(I),{modelValue:$.value,"onUpdate:modelValue":t[1]||(t[1]=o=>$.value=o),options:J.value,optionLabel:"label",optionValue:"value",placeholder:l(e)("product.categoryFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search categories",onFilter:ge},null,8,["modelValue","options","placeholder"]),s(l(I),{modelValue:U.value,"onUpdate:modelValue":t[2]||(t[2]=o=>U.value=o),options:X.value,optionLabel:"label",optionValue:"value",placeholder:l(e)("product.storeFilter"),class:"w-12rem",showClear:!0},null,8,["modelValue","options","placeholder"]),s(l(I),{modelValue:D.value,"onUpdate:modelValue":t[3]||(t[3]=o=>D.value=o),options:Y.value,optionLabel:"label",optionValue:"value",placeholder:l(e)("product.marketFilter"),class:"w-12rem",showClear:!0,filter:"",filterPlaceholder:"Search markets",onFilter:he},null,8,["modelValue","options","placeholder"]),s(r,{label:l(e)("product.updatePrice"),icon:"pi pi-dollar",class:"p-button-warning p-button-outlined",onClick:t[4]||(t[4]=o=>E.value=!0)},null,8,["label"]),s(r,{label:l(e)("product.import"),icon:"pi pi-download",class:"p-import",onClick:t[5]||(t[5]=o=>P.value=!0)},null,8,["label"]),x(s(r,{label:l(e)("product.export"),icon:"pi pi-upload",class:"p-export",onClick:xe},null,8,["label"]),[[L,"list products"]]),x(s(r,{label:l(e)("product.new"),icon:"pi pi-plus",class:"p-button-success",onClick:De},null,8,["label"]),[[L,"create products"]])])]),_:1}),s(l(ze)),n("div",He,[x((g(),Te(y,{ref_key:"dt",ref:pe,value:W.value,loading:R.value,"data-key":"id",paginator:!1,rows:_.value,filters:ve.value,totalRecords:O.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[n("div",Je,[t[18]||(t[18]=n("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),n("p",Xe,c(l(e)("product.noData")),1)])]),loading:d(()=>[n("div",Ye,[s(f,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[t[19]||(t[19]=k(" ` ` ")),s(l(h),{field:"id",header:l(e)("id"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(o=>[k(c(o.data.id),1)]),_:1},8,["header"]),s(l(h),{field:"name_ar",header:l(e)("product.nameAr"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(o=>[k(c(o.data.name_ar),1)]),_:1},8,["header"]),s(l(h),{field:"name_en",header:l(e)("product.nameEn"),sortable:!0,"header-style":"width:14%; min-width:13rem;"},{body:d(o=>[k(c(o.data.name_en),1)]),_:1},8,["header"]),s(l(h),{field:"base_price",header:l(e)("product.basePrice"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(o=>[k(c(o.data.base_price),1)]),_:1},8,["header"]),s(l(h),{field:"total_discounts_value",header:l(e)("product.Price after discount"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(o=>[k(c(o.data.base_price-o.data.total_discounts_value),1)]),_:1},8,["header"]),s(l(h),{field:"is_displayed",header:l(e)("product.isDisplayed"),sortable:!0,"header-style":"width:7%; min-width:7rem;"},{body:d(o=>[s(l(Ae),{value:o.data.is_displayed?l(e)("yes"):l(e)("no"),severity:o.data.is_displayed?"success":"info"},null,8,["value","severity"])]),_:1},8,["header"]),s(l(h),{header:l(e)("actions"),"header-style":"width:16rem"},{body:d(o=>[x(s(r,{icon:"pi pi-pencil",class:"p-detail",onClick:j=>Ee(o.data.id)},null,8,["onClick"]),[[L,"edit products"],[K,l(e)("edit"),void 0,{top:!0}]]),x(s(r,{icon:"pi pi-trash mx-2",class:"p-delete",onClick:j=>ye(o.data.id)},null,8,["onClick"]),[[L,"delete products"],[K,l(e)("delete"),void 0,{top:!0}]]),x(s(r,{icon:"pi pi-truck",class:"p-button-warning mx-1",onClick:j=>fe(o.data.id)},null,8,["onClick"]),[[K,l(e)("store.shippingSettings"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1,__:[19]},8,["value","loading","rows","filters","totalRecords"])),[[L,"list products"]]),n("div",Ze,[n("div",et,[n("span",tt,c(l(e)("show"))+" "+c(le.value)+" "+c(l(e)("to"))+" "+c(oe.value)+" "+c(l(e)("from"))+" "+c(O.value),1)]),n("div",at,[n("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:t[6]||(t[6]=o=>F(1))},t[20]||(t[20]=[n("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,lt),n("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!ae.value,onClick:t[7]||(t[7]=o=>F(p.value-1))},t[21]||(t[21]=[n("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,ot),(g(!0),w(de,null,je(re.value,(o,j)=>(g(),w(de,{key:j},[o.label&&!isNaN(parseInt(o.label))?(g(),w("button",{key:0,class:Me(["p-paginator-page p-paginator-element p-link",{"p-highlight":o.active}]),onClick:ft=>F(parseInt(o.label))},c(o.label),11,rt)):o.label==="..."?(g(),w("span",st,"...")):ce("",!0)],64))),128)),n("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!te.value,onClick:t[8]||(t[8]=o=>F(p.value+1))},t[22]||(t[22]=[n("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,it),n("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===T.value,onClick:t[9]||(t[9]=o=>F(T.value))},t[23]||(t[23]=[n("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,nt),s(l(I),{modelValue:_.value,"onUpdate:modelValue":t[10]||(t[10]=o=>_.value=o),options:[5,10,20,30],onChange:_e,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),s(G,{visible:C.value,"onUpdate:visible":t[12]||(t[12]=o=>C.value=o),style:{width:"450px"},header:l(e)("product.deleteConfirmTitle"),modal:!0},{footer:d(()=>[s(r,{label:l(e)("no"),icon:"pi pi-times",class:"p-button-text",onClick:t[11]||(t[11]=o=>C.value=!1)},null,8,["label"]),s(r,{label:l(e)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:we},null,8,["label"])]),default:d(()=>[n("div",dt,[t[24]||(t[24]=n("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),n("span",null,c(l(e)("product.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),s(G,{visible:P.value,"onUpdate:visible":t[14]||(t[14]=o=>P.value=o),style:{width:"450px"},header:l(e)("product.importTitle"),modal:!0},{footer:d(()=>[s(r,{label:l(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:t[13]||(t[13]=o=>P.value=!1)},null,8,["label"]),s(r,{label:l(e)("product.importButton"),icon:"pi pi-check",loading:A.value,disabled:!m.value,onClick:$e},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",ct,[s(r,{label:l(e)("product.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:ke},null,8,["label"]),s(l(ue),{mode:"basic","custom-upload":!0,onSelect:Se,maxFileSize:1e7,chooseLabel:"Select File"}),m.value?(g(),w("div",ut,[n("p",pt,c(l(e)("selectedFile"))+": "+c(m.value.name),1)])):ce("",!0)])]),_:1},8,["visible","header"]),s(G,{visible:E.value,"onUpdate:visible":t[16]||(t[16]=o=>E.value=o),style:{width:"450px"},header:l(e)("product.updatePriceTitle"),modal:!0},{footer:d(()=>[s(r,{label:l(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:t[15]||(t[15]=o=>E.value=!1)},null,8,["label"]),s(r,{label:l(e)("product.updatePriceButton"),icon:"pi pi-check",loading:M.value,disabled:!V.value,onClick:Ue},null,8,["label","loading","disabled"])]),default:d(()=>[n("div",vt,[s(r,{label:l(e)("product.downloadPriceExample"),icon:"pi pi-download",class:"p-button-outlined p-button-warning",onClick:Ce},null,8,["label"]),s(l(ue),{mode:"basic","custom-upload":!0,onSelect:Pe,maxFileSize:1e7,chooseLabel:"Select Price File"})])]),_:1},8,["visible","header"])])])])}}},ht=Ve(mt,[["__scopeId","data-v-41912dbe"]]);export{ht as default};
