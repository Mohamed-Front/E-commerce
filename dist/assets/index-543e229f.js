import{_ as ie,u as re,A as de,j as ue,r as n,m as ce,n as pe,o as ve,P as O,a as g,c as $,f as s,h as i,w as u,e,C as h,b as me,t as r,F as q,d as ye,i as V,Y as fe,R as Q,T as m,Z as be,O as _e,E as ge,$ as x,B as P,a0 as he,x as xe,g as ke,a1 as z,a2 as G}from"./index-f1b27aeb.js";const we={class:"grid"},Ce={class:"col-12"},$e={class:"card p-4 shadow-2 border-round"},Ve={class:"text-2xl font-bold"},Ee={class:"flex gap-2"},Se={class:"p-input-icon-left"},Ue={class:"card shadow-1 surface-0"},Ne={class:"text-center py-4"},Pe={class:"text-xl"},Re={class:"flex justify-content-center align-items-center py-4"},Te={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Be={class:"p-paginator-left-content"},De={class:"p-paginator-current"},Le={class:"p-paginator-right-content"},Ie=["disabled"],Me=["disabled"],je=["onClick"],Fe={key:1,class:"p-paginator-dots"},Ae=["disabled"],Oe=["disabled"],qe={class:"flex align-items-center justify-content-center"},Qe={class:"p-fluid"},ze={class:"field"},Ge={for:"name"},We={class:"field"},Ye={for:"store_id"},Ze={__name:"index",setup(He){const W=re(),p=de(),{t}=ue(),E=n(!0),B=n("");n({});const R=n(null),b=n(!1);n(!1);const k=n(!1);n(null);const Y=n(null),D=n({}),S=n(""),v=n({id:null,name:"",store_id:null}),y=n(!1),L=n([]),f=n(1),T=n(0),w=n(10),U=n(0),Z=n(""),H=n(""),I=n(""),M=n(""),j=n(0),F=n(0),A=n([]),J=async()=>{try{const l=await V.get("/api/store");L.value=l.data.data.data}catch(l){p.add({severity:"error",summary:t("error"),detail:t("store.loadStoresError"),life:3e3}),console.error("Error fetching stores:",l)}},K=()=>{V.get("/api/export/inventory",{responseType:"blob"}).then(l=>{const a=new Blob([l.data],{type:"text/csv"}),d=window.URL.createObjectURL(a),c=document.createElement("a");c.href=d,c.setAttribute("download","inventory_export.csv"),document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(d),p.add({severity:"success",summary:t("success"),detail:t("inventory.exportSuccess"),life:3e3})}).catch(l=>{p.add({severity:"error",summary:t("error"),detail:t("inventory.exportError"),life:3e3}),console.error("Error exporting inventory:",l)})},X=l=>{B.value=l,k.value=!0},ee=()=>{V.delete(`/api/inventory/${B.value}`).then(()=>{_(),k.value=!1,p.add({severity:"success",summary:t("success"),detail:t("inventory.deletedSuccess"),life:3e3})}).catch(()=>{p.add({severity:"error",summary:t("error"),detail:t("inventory.deleteError"),life:3e3})})},te=()=>{D.value={global:{value:null,matchMode:fe.CONTAINS}}};ce(()=>{te()});const _=()=>{E.value=!0,V.get("/api/inventory",{params:{page:f.value,limit:w.value,search:S.value}}).then(l=>{E.value=!1,R.value=l.data.data.data,T.value=l.data.data.total,U.value=l.data.data.last_page,Z.value=l.data.data.first_page_url,H.value=l.data.data.last_page_url,I.value=l.data.data.next_page_url,M.value=l.data.data.prev_page_url,j.value=l.data.data.from,F.value=l.data.data.to,A.value=l.data.data.links}).catch(l=>{E.value=!1,p.add({severity:"error",summary:t("error"),detail:t("inventory.loadError"),life:3e3}),console.error("Error fetching data:",l)})};pe(S,l=>{f.value=1,_()});const C=l=>{l>=1&&l<=U.value&&(f.value=l,_())},ae=l=>{w.value=l.value,f.value=1,_()};ve(()=>{_(),J()});const le=()=>{v.value={id:null,name:"",store_id:null},y.value=!1,b.value=!0},oe=l=>{var d;const a=(d=R.value)==null?void 0:d.find(c=>c.id===l);if(!a){p.add({severity:"error",summary:t("error"),detail:t("inventory.loadError"),life:3e3});return}v.value={id:a.id,name:a.name,store_id:a.store_id},y.value=!0,b.value=!0},se=()=>{if(!v.value.name||!v.value.store_id){p.add({severity:"warn",summary:t("warning"),detail:t("inventory.formIncomplete"),life:3e3});return}const l=y.value?`/api/inventory/${v.value.id}`:"/api/inventory",a=y.value?"put":"post";V[a](l,v.value).then(()=>{_(),b.value=!1,p.add({severity:"success",summary:t("success"),detail:y.value?t("inventory.updatedSuccess"):t("inventory.createdSuccess"),life:3e3})}).catch(d=>{p.add({severity:"error",summary:t("error"),detail:y.value?t("inventory.updateError"):t("inventory.createError"),life:3e3}),console.error("Error saving inventory:",d)})},ne=l=>{W.push({name:"inventory-quantity",params:{id:l}})};return(l,a)=>{const d=O("can"),c=O("tooltip");return g(),$("div",we,[s("div",Ce,[s("div",$e,[i(e(be),{class:"mb-4"},{start:u(()=>[s("h2",Ve,r(e(t)("inventory.managementTitle")),1)]),end:u(()=>[s("div",Ee,[s("span",Se,[a[12]||(a[12]=s("i",{class:"pi pi-search"},null,-1)),i(e(Q),{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=o=>S.value=o),placeholder:e(t)("inventory.search")},null,8,["modelValue","placeholder"])]),h(i(e(m),{label:e(t)("inventory.export"),icon:"pi pi-upload",class:"p-export",onClick:K},null,8,["label"]),[[d,"list inventory"]]),h(i(e(m),{label:e(t)("inventory.new"),icon:"pi pi-plus",class:"p-button-success",onClick:le},null,8,["label"]),[[d,"create inventory"]])])]),_:1}),i(e(_e)),s("div",Ue,[h((g(),me(e(he),{ref_key:"dt",ref:Y,value:R.value,loading:E.value,"data-key":"id",paginator:!1,rows:w.value,filters:D.value,totalRecords:T.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:u(()=>[s("div",Ne,[a[13]||(a[13]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",Pe,r(e(t)("inventory.noData")),1)])]),loading:u(()=>[s("div",Re,[i(e(ge),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:u(()=>[i(e(x),{"selection-mode":"multiple","header-style":"width: 3rem"}),i(e(x),{field:"name",header:e(t)("inventory.name"),sortable:!0},{body:u(o=>[P(r(o.data.name),1)]),_:1},8,["header"]),i(e(x),{field:"store.name_en",header:e(t)("inventory.storeNameEn"),sortable:!0},{body:u(o=>[P(r(o.data.store.name_en),1)]),_:1},8,["header"]),i(e(x),{field:"store.name_ar",header:e(t)("inventory.storeNameAr"),sortable:!0},{body:u(o=>[P(r(o.data.store.name_ar),1)]),_:1},8,["header"]),i(e(x),{field:"total_products",header:e(t)("inventory.total_products"),sortable:!0},{body:u(o=>[P(r(o.data.total_products),1)]),_:1},8,["header"]),i(e(x),{header:e(t)("actions"),headerStyle:"width: 15rem"},{body:u(o=>[h(i(e(m),{icon:"pi pi-pencil",class:"p-detail",onClick:N=>oe(o.data.id)},null,8,["onClick"]),[[d,"edit inventory"],[c,e(t)("edit"),void 0,{top:!0}]]),h(i(e(m),{icon:"pi pi-trash",class:"p-delete mx-2",onClick:N=>X(o.data.id)},null,8,["onClick"]),[[d,"delete inventory"],[c,e(t)("delete"),void 0,{top:!0}]]),h(i(e(m),{icon:"pi pi-plus-circle",class:"p-button-info",onClick:N=>ne(o.data.id)},null,8,["onClick"]),[[d,"edit inventory"],[c,e(t)("inventory.increaseQuantity"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[d,"list inventory"]]),s("div",Te,[s("div",Be,[s("span",De,r(e(t)("show"))+" "+r(j.value)+" "+r(e(t)("to"))+" "+r(F.value)+" "+r(e(t)("from"))+" "+r(T.value),1)]),s("div",Le,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:f.value===1,onClick:a[1]||(a[1]=o=>C(1))},a[14]||(a[14]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Ie),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!M.value,onClick:a[2]||(a[2]=o=>C(f.value-1))},a[15]||(a[15]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Me),(g(!0),$(q,null,ye(A.value,(o,N)=>(g(),$(q,{key:N},[o.label&&!isNaN(o.label)?(g(),$("button",{key:0,class:xe(["p-paginator-page p-paginator-element p-link",{"p-highlight":o.active}]),onClick:Je=>C(parseInt(o.label))},r(o.label),11,je)):o.label==="..."?(g(),$("span",Fe,"...")):ke("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!I.value,onClick:a[3]||(a[3]=o=>C(f.value+1))},a[16]||(a[16]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Ae),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:f.value===U.value,onClick:a[4]||(a[4]=o=>C(U.value))},a[17]||(a[17]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Oe),i(e(z),{filter:"",modelValue:w.value,"onUpdate:modelValue":a[5]||(a[5]=o=>w.value=o),options:[5,10,20,30],optionLabel:"",onChange:ae,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),i(e(G),{visible:k.value,"onUpdate:visible":a[7]||(a[7]=o=>k.value=o),style:{width:"450px"},header:e(t)("inventory.deleteConfirmTitle"),modal:!0},{footer:u(()=>[i(e(m),{label:e(t)("no"),icon:"pi pi-times",class:"p-button-text",onClick:a[6]||(a[6]=o=>k.value=!1)},null,8,["label"]),i(e(m),{label:e(t)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:ee},null,8,["label"])]),default:u(()=>[s("div",qe,[a[18]||(a[18]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,r(e(t)("inventory.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),i(e(G),{visible:b.value,"onUpdate:visible":a[11]||(a[11]=o=>b.value=o),style:{width:"450px"},header:y.value?e(t)("inventory.editTitle"):e(t)("inventory.createTitle"),modal:!0},{footer:u(()=>[i(e(m),{label:e(t)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[10]||(a[10]=o=>b.value=!1)},null,8,["label"]),i(e(m),{label:y.value?e(t)("update"):e(t)("create"),icon:"pi pi-check",class:"p-button-text p-button-success",onClick:se},null,8,["label"])]),default:u(()=>[s("div",Qe,[s("div",ze,[s("label",Ge,r(e(t)("inventory.name")),1),i(e(Q),{id:"name",modelValue:v.value.name,"onUpdate:modelValue":a[8]||(a[8]=o=>v.value.name=o),required:""},null,8,["modelValue"])]),s("div",We,[s("label",Ye,r(e(t)("inventory.store")),1),i(e(z),{id:"store_id",modelValue:v.value.store_id,"onUpdate:modelValue":a[9]||(a[9]=o=>v.value.store_id=o),options:L.value,optionLabel:"name_en",optionValue:"id",placeholder:e(t)("inventory.selectStore"),required:""},null,8,["modelValue","options","placeholder"])])])]),_:1},8,["visible","header"])])])])}}},Xe=ie(Ze,[["__scopeId","data-v-67749262"]]);export{Xe as default};
