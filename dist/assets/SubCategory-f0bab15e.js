import{_ as E,k as O,u as R,j as T,r as i,m as q,n as G,a as l,c as d,f as s,p as H,t as y,e as f,h as S,w as $,g as h,b as I,F as L,d as J,i as N}from"./index-a1d3f478.js";import{p as K,S as Q,A as U,a as W,P as X}from"./ProductOffers-54d70744.js";import{N as Y}from"./navigation-6848d1d2.js";import{d as b}from"./banner-addtion-e4104052.js";import{C as Z}from"./CustomTaps-2296f2a0.js";const ee={class:"mx-auto bg-gradient-to mt-16 max-w-7xl"},ae={key:0,class:"flex flex-col items-center justify-center py-16 rounded-xl animate-pulse"},te={key:1,class:"text-center py-16 text-red-600"},se={class:"text-lg font-semibold"},oe={key:2},ne={class:"text-center mb-2"},re={class:"text-4xl sm:text-4xl font-extrabold text-gray-800 tracking-tight animate-fade-in"},le={key:0},ie={class:"w-full h-48 overflow-hidden rounded-xl shadow-md relative"},de=["src","alt"],ce={class:"font-sans mt-4 mb-1 text-gray-800 font-semibold text-sm sm:text-base md:text-lg"},ue={key:1,class:"my-8"},me={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},ge=["src","alt"],_e={key:2,class:"my-8"},pe={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},fe=["src","alt"],ve={__name:"SubCategory",setup(ye){const x=O(),C=R(),{t:g,locale:v}=T(),_=i(localStorage.getItem("defaultStoreId")),r=i({}),u=i([]),w=i({title:"",products:[]}),V=i([]);i({title:"",products:[]});const k=i(!1),c=i(null),p=e=>v.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,B=e=>v.value==="ar"?"منتجات "+(e.name_ar||e.name_en):"Products "+(e.name_en||e.name_ar),D=e=>{console.log(e),e.has_subcategories?C.push({name:"subcategory",params:{id:e.id}}):C.push({name:"produts_category",params:{id:e.id}})},M=async()=>{try{const t=(await N.get(`/api/home/products-by-category/${x.params.id}/${_.value}`)).data.data;r.value={id:t.category.id,name_ar:t.category.name_ar,name_en:t.category.name_en,media:t.category.media||[{url:b,name:"default"}]},u.value=t.sub_categories.map(a=>({id:a.id,name_ar:a.name_ar||a.name_en,name_en:a.name_en||a.name_ar,media:a.media.length?a.media:[{url:b,name:"default"}]})),w.value={title:B(r.value),products:(t.products.data||[]).map(a=>{var m,o;return{id:a.id,name:v.value==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar,tax:a.tax||0,price:parseFloat(a.base_price||0).toFixed(2),img:((o=(m=a.media)==null?void 0:m.find(n=>n.name==="product_main_image"))==null?void 0:o.url)||a.key_default_image||b}})}}catch(e){console.error("Error fetching category data:",e),c.value=g("category.errorLoading")||"Failed to load category data."}},z=async()=>{try{const e=u.value.map(async a=>((await N.get(`/api/home/products-by-category/${a.id}/${_.value}`)).data.data.products.data||[]).map(n=>{var j,F;return{id:n.id,name:v.value==="ar"?n.name_ar||n.name_en:n.name_en||n.name_ar,tax:n.tax||0,price:parseFloat(n.base_price||0).toFixed(2),img:((F=(j=n.media)==null?void 0:j.find(A=>A.name==="product_main_image"))==null?void 0:F.url)||n.key_default_image||b}})),t=await Promise.allSettled(e);V.value=t.filter(a=>a.status==="fulfilled").flatMap(a=>a.value)}catch(e){console.error("Error fetching subcategory products:",e),c.value=g("category.errorLoading")||"Failed to load subcategory products."}},P=async()=>{k.value=!0,c.value=null,await Promise.allSettled([M()]),u.value.length&&await z(),k.value=!1};return q(()=>{x.params.id&&_.value?P():c.value=g("category.missingParams")||"Missing category or store ID."}),G(()=>x.params.id,(e,t)=>{e!==t&&e&&_.value?P():(!e||!_.value)&&(c.value=g("category.missingParams")||"Missing category or store ID.")}),(e,t)=>{var a,m;return l(),d(L,null,[s("div",ee,[k.value?(l(),d("div",ae,t[0]||(t[0]=[s("img",{src:H,alt:"Loading Logo",class:"w-32 h-32 object-contain animate-bounce","aria-label":"Loading animation"},null,-1)]))):c.value?(l(),d("div",te,[s("p",se,y(c.value),1),s("button",{onClick:P,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},y(f(g)("category.retry")),1)])):(l(),d("div",oe,[s("div",ne,[s("h1",re,y(p(r.value)),1)]),u.value.length>=1?(l(),d("div",le,[t[2]||(t[2]=s("h2",{class:"font-bold font-sans text-gray-800 text-2xl sm:text-3xl lg:text-4xl mb-8 animate-slide-up"},null,-1)),S(f(W),{modules:[f(U),f(Y)],"slides-per-view":3,"space-between":20,loop:u.value.length>3,autoplay:{delay:3e3,disableOnInteraction:!1},speed:1e3,"grab-cursor":!0,navigation:!1,class:"mt-6",breakpoints:{320:{slidesPerView:2,spaceBetween:4},640:{slidesPerView:2,spaceBetween:12},768:{slidesPerView:2,spaceBetween:16},1024:{slidesPerView:5.5,spaceBetween:10}}},{default:$(()=>[(l(!0),d(L,null,J(u.value,o=>(l(),I(f(Q),{key:o.id,class:"group flex flex-col items-center cursor-pointer transition-all duration-300 hover:-translate-y-2",onClick:n=>D(o)},{default:$(()=>{var n;return[s("div",ie,[s("img",{src:(n=o.media[0])==null?void 0:n.url,alt:`${p(o)} image`,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,de),t[1]||(t[1]=s("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1))]),s("h3",ce,y(p(o)),1)]}),_:2},1032,["onClick"]))),128))]),_:1},8,["modules","loop"])])):h("",!0),(a=r.value.media)!=null&&a.find(o=>o.name==="banner_one_image")?(l(),d("div",ue,[s("div",me,[s("img",{src:r.value.media.find(o=>o.name==="banner_one_image").url,alt:`${p(r.value)} banner one`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,ge),t[3]||(t[3]=s("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center p-6"},null,-1))])])):h("",!0),s("section",null,[w.value.products.length?(l(),I(K,{key:0,products:w.value,title:B(r.value)},null,8,["products","title"])):h("",!0),S(X)]),(m=r.value.media)!=null&&m.find(o=>o.name==="banner_two_image")?(l(),d("div",_e,[s("div",pe,[s("img",{src:r.value.media.find(o=>o.name==="banner_two_image").url,alt:`${p(r.value)} banner two`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,fe),t[4]||(t[4]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/50 flex items-center justify-center p-6"},null,-1))])])):h("",!0)]))]),S(Z)],64)}}},Pe=E(ve,[["__scopeId","data-v-2d927e4b"]]);export{Pe as default};
