import{u as Y,D as Z,j as ee,r as n,n as te,o as ae,R as z,a as p,c as _,f as s,h as i,w as d,e,x as y,b as le,t as r,F,d as oe,i as G,S as se,U as v,$ as ne,Q as ie,G as re,a0 as g,E as V,a5 as de,a1 as ue,v as ce,g as pe,a2 as ve,a3 as ge}from"./index-ce4de016.js";const me={class:"grid"},he={class:"col-12"},fe={class:"card p-4 shadow-2 border-round"},be={class:"text-2xl font-bold"},_e={class:"flex gap-2"},ye={class:"p-input-icon-left"},xe={class:"card shadow-1 surface-0"},we={class:"text-center py-4"},ke={class:"text-xl"},Ce={class:"flex justify-content-center align-items-center py-4"},$e={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},De={class:"p-paginator-left-content"},Ve={class:"p-paginator-current"},Pe={class:"p-paginator-right-content"},Ue=["disabled"],Ee=["disabled"],Ne=["onClick"],Re={key:1,class:"p-paginator-dots"},Se=["disabled"],Te=["disabled"],Be={class:"flex align-items-center justify-content-center"},Fe={__name:"index",setup(Ie){const P=Y(),C=Z(),{t:o}=ee(),x=n(!0),U=n([]),m=n(!1),E=n(null),N=n(null),L=n({}),w=n("");n(null);const u=n(1),$=n(0),c=n(10),k=n(0),M=n(""),Q=n(""),R=n(""),S=n(""),T=n(0),B=n(0),I=n([]),h=()=>{x.value=!0,G.get("/api/coupon",{params:{page:u.value,limit:c.value,search:w.value||void 0}}).then(t=>{U.value=t.data.data.data,$.value=t.data.data.total,k.value=t.data.data.last_page,M.value=t.data.data.first_page_url,Q.value=t.data.data.last_page_url,R.value=t.data.data.next_page_url,S.value=t.data.data.prev_page_url,T.value=t.data.data.from,B.value=t.data.data.to,I.value=t.data.data.links,x.value=!1}).catch(t=>{C.add({severity:"error",summary:o("error"),detail:o("coupon.loadError"),life:3e3}),x.value=!1,console.error("Error fetching coupons:",t)})};te([w,c],()=>{u.value=1,h()});const f=t=>{t>=1&&t<=k.value&&(u.value=t,h())},W=t=>{c.value=t.value,u.value=1,h()},q=t=>{E.value=t,m.value=!0},A=()=>{G.delete(`/api/coupon/${E.value}`).then(()=>{C.add({severity:"success",summary:o("success"),detail:o("coupon.deleteSuccess"),life:3e3}),h(),m.value=!1}).catch(t=>{C.add({severity:"error",summary:o("error"),detail:o("coupon.deleteError"),life:3e3}),console.error("Error deleting coupon:",t)})},H=()=>{N.value.exportCSV()},J=()=>{P.push({name:"coupon-create"})},K=t=>{P.push({name:"coupon-update",params:{id:t}})},O=t=>t===1?"success":"info",X=t=>t?new Date(t).toLocaleDateString():o("coupon.noExpiry");return ae(()=>{h()}),(t,a)=>{const b=z("can"),j=z("tooltip");return p(),_("div",me,[s("div",he,[s("div",fe,[i(e(ne),{class:"mb-4"},{start:d(()=>[s("h2",be,r(e(o)("coupon.managementTitle")),1)]),end:d(()=>[s("div",_e,[s("span",ye,[a[8]||(a[8]=s("i",{class:"pi pi-search"},null,-1)),i(e(se),{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=l=>w.value=l),placeholder:e(o)("coupon.search")},null,8,["modelValue","placeholder"])]),y(i(e(v),{label:e(o)("coupon.export"),icon:"pi pi-upload",class:"p-export",onClick:H},null,8,["label"]),[[b,"list coupons"]]),y(i(e(v),{label:e(o)("coupon.new"),icon:"pi pi-plus",class:"p-button-success",onClick:J},null,8,["label"]),[[b,"create coupons"]])])]),_:1}),i(e(ie)),s("div",xe,[y((p(),le(e(ue),{ref_key:"dt",ref:N,value:U.value,loading:x.value,"data-key":"id",paginator:!1,rows:c.value,filters:L.value,totalRecords:$.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[s("div",we,[a[9]||(a[9]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",ke,r(e(o)("coupon.noData")),1)])]),loading:d(()=>[s("div",Ce,[i(e(re),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[i(e(g),{"selection-mode":"multiple","header-style":"width: 3rem"}),i(e(g),{field:"code",header:e(o)("coupon.code"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(l=>[V(r(l.data.code),1)]),_:1},8,["header"]),i(e(g),{field:"discount_type_description",header:e(o)("coupon.type"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(l=>[i(e(de),{value:l.data.discount_type_description,severity:O(l.data.discount_type)},null,8,["value","severity"])]),_:1},8,["header"]),i(e(g),{field:"discount_value",header:e(o)("coupon.value"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(l=>[V(r(l.data.discount_value),1)]),_:1},8,["header"]),i(e(g),{field:"expires_at",header:e(o)("coupon.expiry"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(l=>[V(r(X(l.data.expires_at)),1)]),_:1},8,["header"]),i(e(g),{header:e(o)("actions"),"header-style":"width: 12rem"},{body:d(l=>[y(i(e(v),{icon:"pi pi-pencil",class:"p-detail",onClick:D=>K(l.data.id)},null,8,["onClick"]),[[b,"edit coupons"],[j,e(o)("edit"),void 0,{top:!0}]]),y(i(e(v),{icon:"pi pi-trash mx-2",class:"p-delete",onClick:D=>q(l.data.id)},null,8,["onClick"]),[[b,"delete coupons"],[j,e(o)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[b,"list coupons"]]),s("div",$e,[s("div",De,[s("span",Ve,r(e(o)("show"))+" "+r(T.value)+" "+r(e(o)("to"))+" "+r(B.value)+" "+r(e(o)("from"))+" "+r($.value),1)]),s("div",Pe,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:u.value===1,onClick:a[1]||(a[1]=l=>f(1))},a[10]||(a[10]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Ue),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!S.value,onClick:a[2]||(a[2]=l=>f(u.value-1))},a[11]||(a[11]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,Ee),(p(!0),_(F,null,oe(I.value,(l,D)=>(p(),_(F,{key:D},[l.label&&!isNaN(parseInt(l.label))?(p(),_("button",{key:0,class:ce(["p-paginator-page p-paginator-element p-link",{"p-highlight":l.active}]),onClick:je=>f(parseInt(l.label))},r(l.label),11,Ne)):l.label==="..."?(p(),_("span",Re,"...")):pe("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!R.value,onClick:a[3]||(a[3]=l=>f(u.value+1))},a[12]||(a[12]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Se),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:u.value===k.value,onClick:a[4]||(a[4]=l=>f(k.value))},a[13]||(a[13]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,Te),i(e(ve),{filter:"",modelValue:c.value,"onUpdate:modelValue":a[5]||(a[5]=l=>c.value=l),options:[5,10,20,30],onChange:W,class:"ml-2",style:{width:"80px"}},null,8,["modelValue"])])])]),i(e(ge),{visible:m.value,"onUpdate:visible":a[7]||(a[7]=l=>m.value=l),style:{width:"450px"},header:e(o)("coupon.deleteConfirmTitle"),modal:!0},{footer:d(()=>[i(e(v),{label:e(o)("no"),icon:"pi pi-times",class:"p-button-text",onClick:a[6]||(a[6]=l=>m.value=!1)},null,8,["label"]),i(e(v),{label:e(o)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:A},null,8,["label"])]),default:d(()=>[s("div",Be,[a[14]||(a[14]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,r(e(o)("coupon.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])}}};export{Fe as default};
