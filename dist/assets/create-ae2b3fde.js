import{_ as W,G as Y,a as X,I as Z,u as ee,r as _,m as j,o as te,v as p,Q as oe,b as d,c as u,x as se,d as s,t as l,e as n,w as T,K as le,F as ae,i as x,p as v,z as c,g as re}from"./index-9af6414e.js";import{h as de}from"./moment-fbc5633a.js";const ue={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},ne={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ie={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ce={class:"space-y-2"},pe={for:"model_type",class:"block text-sm font-medium text-gray-700"},me={key:0,class:"text-red-500 text-xs"},_e={class:"space-y-2"},ve={for:"model_ids",class:"block text-sm font-medium text-gray-700"},ye={key:0,class:"text-red-500 text-xs"},fe={key:0,class:"space-y-2"},ge={for:"product_id",class:"block text-sm font-medium text-gray-700"},be={key:0,class:"text-red-500 text-xs"},xe={class:"space-y-2"},he={for:"discount_type",class:"block text-sm font-medium text-gray-700"},we={key:0,class:"text-red-500 text-xs"},Ve={class:"space-y-2"},ke={for:"discount_value",class:"block text-sm font-medium text-gray-700"},$e={key:0,class:"text-gray-500 text-xs"},De={key:1,class:"text-red-500 text-xs"},Ce={class:"space-y-2"},Fe={for:"expires_at",class:"block text-sm font-medium text-gray-700"},Le={key:0,class:"text-red-500 text-xs"},qe={class:"pt-4 flex justify-center space-x-4"},Me={key:0},Ne={key:1,class:"pi pi-spinner pi-spin"},Ue={__name:"create",setup(Be){const z=Y(()=>localStorage.getItem("appLang")||"en"),w=Y(()=>z.value==="en"?"name_en":"name_ar"),V=X(),g=Z(),{t:i}=ee(),a=_(),m=_(!1),G=_([]),h=_([]),b=_([]),o=_({products:"",model_ids:"",model_type:"",discount_type:null,discount_value:"",expires_at:""}),k=async()=>{try{const e=await x.get("api/category");h.value=e.data.data.data}catch(e){console.error("Error fetching categories:",e),g.add({severity:"error",summary:i("error"),detail:i("error_fetching_categories"),life:3e3})}},K=async e=>{try{const t=await x.post("api/category/products",{ids:e});b.value=t.data.data}catch(t){console.error("Error fetching products:",t)}};j(()=>o.value.model_type,e=>{o.value.model_ids="",b.value=[],(e==="category"||e==="product")&&k()}),j(()=>o.value.model_ids,e=>{o.value.model_type==="product"&&e?K(e):b.value=[]});const P=async()=>{try{const e=await x.get("api/model");G.value=e.data.data.data}catch(e){console.error("Error fetching models:",e),g.add({severity:"error",summary:i("error"),detail:i("error_fetching_models"),life:3e3})}},Q=async()=>{var t,y;m.value=!0;const e={};o.value.expires_at=de(o.value.expires_at).format("YYYY-MM-DD"),e.expires_at=o.value.expires_at,e.discount_value=o.value.discount_value,e.discount_type=o.value.discount_type,e.model_type=o.value.model_type,o.value.model_type=="product"?e.model_ids=o.value.products:e.model_ids=o.value.model_ids;try{await x.post("/api/discount",e),V.push({name:"discount"}),g.add({severity:"success",summary:i("success"),detail:i("discount.created_successfully"),life:3e3})}catch(f){console.error("Error:",f),g.add({severity:"error",summary:i("error"),detail:((y=(t=f.response)==null?void 0:t.data)==null?void 0:y.message)||i("error_occurred"),life:3e3})}finally{m.value=!1}};return te(()=>{P()}),(e,t)=>{const y=p("Dropdown"),f=p("MultiSelect"),R=p("InputNumber"),A=p("Calendar"),$=p("Button"),H=p("Form"),J=p("Toast"),O=oe("can");return d(),u(ae,null,[se((d(),u("div",ue,[s("h1",ne,l(e.$t("discount.create_new_discount")),1),n(H,{ref_key:"form",ref:a,onSubmit:le(Q,["prevent"]),class:"space-y-6"},{default:T(()=>{var D,C,F,L,q,M,N,U,B,E,I,S;return[s("div",ie,[s("div",ce,[s("label",pe,[v(l(e.$t("discount.model_type"))+" ",1),t[7]||(t[7]=s("span",{class:"text-red-500"},"*",-1))]),n(y,{filter:"",id:"model_type",modelValue:o.value.model_type,"onUpdate:modelValue":t[0]||(t[0]=r=>o.value.model_type=r),options:["product","category"],placeholder:e.$t("discount.select_model_type"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"]),(C=(D=a.value)==null?void 0:D.errors)!=null&&C.model_type?(d(),u("small",me,l(a.value.errors.model_type[0]),1)):c("",!0)]),s("div",_e,[s("label",ve,[v(l(e.$t(o.value.model_type==="product"?"discount.select_category":"discount.select_model"))+" ",1),t[8]||(t[8]=s("span",{class:"text-red-500"},"*",-1))]),n(f,{filter:"",id:"model_ids",modelValue:o.value.model_ids,"onUpdate:modelValue":t[1]||(t[1]=r=>o.value.model_ids=r),options:(o.value.model_type==="product",h.value),optionLabel:w.value,optionValue:"id",placeholder:e.$t(o.value.model_type==="product"?"discount.select_category":"discount.select_model"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(L=(F=a.value)==null?void 0:F.errors)!=null&&L.model_ids?(d(),u("small",ye,l(a.value.errors.model_ids[0]),1)):c("",!0)]),o.value.model_type==="product"?(d(),u("div",fe,[s("label",ge,[v(l(e.$t("discount.select_product"))+" ",1),t[9]||(t[9]=s("span",{class:"text-red-500"},"*",-1))]),n(f,{filter:"",id:"product_id",modelValue:o.value.products,"onUpdate:modelValue":t[2]||(t[2]=r=>o.value.products=r),options:b.value,optionLabel:w.value,optionValue:"id",placeholder:e.$t("discount.select_product"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(M=(q=a.value)==null?void 0:q.errors)!=null&&M.model_ids?(d(),u("small",be,l(a.value.errors.model_ids[0]),1)):c("",!0)])):c("",!0),s("div",xe,[s("label",he,[v(l(e.$t("discount.discount_type"))+" ",1),t[10]||(t[10]=s("span",{class:"text-red-500"},"*",-1))]),n(y,{filter:"",id:"discount_type",modelValue:o.value.discount_type,"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.discount_type=r),options:[{label:e.$t("discount.fixed_amount"),value:1},{label:e.$t("discount.percentage"),value:2}],optionLabel:"label",optionValue:"value",placeholder:e.$t("discount.select_discount_type"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","options","placeholder"]),(U=(N=a.value)==null?void 0:N.errors)!=null&&U.discount_type?(d(),u("small",we,l(a.value.errors.discount_type[0]),1)):c("",!0)]),s("div",Ve,[s("label",ke,[v(l(e.$t("discount.discount_value"))+" ",1),t[11]||(t[11]=s("span",{class:"text-red-500"},"*",-1))]),n(R,{id:"discount_value",modelValue:o.value.discount_value,"onUpdate:modelValue":t[4]||(t[4]=r=>o.value.discount_value=r),min:0,max:o.value.discount_type===2?100:null,placeholder:e.$t("discount.enter_discount_value"),class:"w-full px-4 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","max","placeholder"]),o.value.discount_type===2?(d(),u("small",$e,l(e.$t("discount.percentage_note")),1)):c("",!0),(E=(B=a.value)==null?void 0:B.errors)!=null&&E.discount_value?(d(),u("small",De,l(a.value.errors.discount_value[0]),1)):c("",!0)]),s("div",Ce,[s("label",Fe,[v(l(e.$t("discount.expiration_date"))+" ",1),t[12]||(t[12]=s("span",{class:"text-red-500"},"*",-1))]),n(A,{id:"expires_at",modelValue:o.value.expires_at,"onUpdate:modelValue":t[5]||(t[5]=r=>o.value.expires_at=r),minDate:new Date,dateFormat:"yy-mm-dd",placeholder:e.$t("discount.select_expiration_date"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","minDate","placeholder"]),(S=(I=a.value)==null?void 0:I.errors)!=null&&S.expires_at?(d(),u("small",Le,l(a.value.errors.expires_at[0]),1)):c("",!0)])]),s("div",qe,[n($,{type:"button",label:e.$t("discount.cancel"),icon:"pi pi-times",onClick:t[6]||(t[6]=r=>re(V).go(-1)),class:"px-6 mx-2 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:m.value},null,8,["label","disabled"]),n($,{type:"submit",label:e.$t("discount.create_discount"),icon:"pi pi-plus",loading:m.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:m.value},{default:T(()=>[m.value?(d(),u("i",Ne)):(d(),u("span",Me,l(e.$t("discount.create_discount")),1))]),_:1},8,["label","loading","disabled"])])]}),_:1},512)])),[[O,"create discounts"]]),n(J)],64)}}},Se=W(Ue,[["__scopeId","data-v-bcc6d658"]]);export{Se as default};
