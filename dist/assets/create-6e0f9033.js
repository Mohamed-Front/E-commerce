import{_ as ee,I as P,b as te,L as oe,u as se,r as m,w as z,d as le,y as p,V as ae,o as d,e as u,z as re,f as s,t as l,g as n,i as R,P as de,F as ue,a as w,s as y,B as c,j as k,p as ne,m as ie}from"./index-b794012a.js";import{h as ce}from"./moment-fbc5633a.js";const v=b=>(ne("data-v-633e9fa6"),b=b(),ie(),b),pe={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},_e={class:"text-3xl font-bold text-center mb-8 text-gray-800"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={class:"space-y-2"},ve={for:"model_type",class:"block text-sm font-medium text-gray-700"},fe=v(()=>s("span",{class:"text-red-500"},"*",-1)),ge={key:0,class:"text-red-500 text-xs"},be={class:"space-y-2"},xe={for:"model_ids",class:"block text-sm font-medium text-gray-700"},he=v(()=>s("span",{class:"text-red-500"},"*",-1)),we={key:0,class:"text-red-500 text-xs"},Ve={key:0,class:"space-y-2"},ke={for:"product_id",class:"block text-sm font-medium text-gray-700"},$e=v(()=>s("span",{class:"text-red-500"},"*",-1)),De={key:0,class:"text-red-500 text-xs"},Se={class:"space-y-2"},Ie={for:"discount_type",class:"block text-sm font-medium text-gray-700"},Le=v(()=>s("span",{class:"text-red-500"},"*",-1)),Ce={key:0,class:"text-red-500 text-xs"},Fe={class:"space-y-2"},qe={for:"discount_value",class:"block text-sm font-medium text-gray-700"},Be=v(()=>s("span",{class:"text-red-500"},"*",-1)),Me={key:0,class:"text-gray-500 text-xs"},Ne={key:1,class:"text-red-500 text-xs"},Ue={class:"space-y-2"},Ee={for:"expires_at",class:"block text-sm font-medium text-gray-700"},je=v(()=>s("span",{class:"text-red-500"},"*",-1)),Ye={key:0,class:"text-red-500 text-xs"},Te={class:"pt-4 flex justify-center space-x-4"},Pe={key:0},ze={key:1,class:"pi pi-spinner pi-spin"},Re={setup(b){const A=P(()=>localStorage.getItem("appLang")||"en"),$=P(()=>A.value==="en"?"name_en":"name_ar"),D=te(),x=oe(),{t:i}=se(),a=m(),_=m(!1),G=m([]),V=m([]),h=m([]),t=m({products:"",model_ids:"",model_type:"",discount_type:null,discount_value:"",expires_at:""}),S=async()=>{try{const e=await w.get("api/category");V.value=e.data.data.data}catch(e){console.error("Error fetching categories:",e),x.add({severity:"error",summary:i("error"),detail:i("error_fetching_categories"),life:3e3})}},H=async e=>{try{const o=await w.post("api/category/products",{ids:e});h.value=o.data.data}catch(o){console.error("Error fetching products:",o)}};z(()=>t.value.model_type,e=>{t.value.model_ids="",h.value=[],(e==="category"||e==="product")&&S()}),z(()=>t.value.model_ids,e=>{t.value.model_type==="product"&&e?H(e):h.value=[]});const J=async()=>{try{const e=await w.get("api/model");G.value=e.data.data.data}catch(e){console.error("Error fetching models:",e),x.add({severity:"error",summary:i("error"),detail:i("error_fetching_models"),life:3e3})}},K=async()=>{var o,f;_.value=!0;const e={};t.value.expires_at=ce(t.value.expires_at).format("YYYY-MM-DD"),e.expires_at=t.value.expires_at,e.discount_value=t.value.discount_value,e.discount_type=t.value.discount_type,e.model_type=t.value.model_type,t.value.model_type=="product"?e.model_ids=t.value.products:e.model_ids=t.value.model_ids;try{await w.post("/api/discount",e),D.push({name:"discount"}),x.add({severity:"success",summary:i("success"),detail:i("discount.created_successfully"),life:3e3})}catch(g){console.error("Error:",g),x.add({severity:"error",summary:i("error"),detail:((f=(o=g.response)==null?void 0:o.data)==null?void 0:f.message)||i("error_occurred"),life:3e3})}finally{_.value=!1}};return le(()=>{J()}),(e,o)=>{const f=p("Dropdown"),g=p("MultiSelect"),O=p("InputNumber"),Q=p("Calendar"),I=p("Button"),W=p("Form"),X=p("Toast"),Z=ae("can");return d(),u(ue,null,[re((d(),u("div",pe,[s("h1",_e,l(e.$t("discount.create_new_discount")),1),n(W,{ref_key:"form",ref:a,onSubmit:de(K,["prevent"]),class:"space-y-6"},{default:R(()=>{var L,C,F,q,B,M,N,U,E,j,Y,T;return[s("div",me,[s("div",ye,[s("label",ve,[y(l(e.$t("discount.model_type"))+" ",1),fe]),n(f,{filter:"",id:"model_type",modelValue:t.value.model_type,"onUpdate:modelValue":o[0]||(o[0]=r=>t.value.model_type=r),options:["product","category"],placeholder:e.$t("discount.select_model_type"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"]),(C=(L=a.value)==null?void 0:L.errors)!=null&&C.model_type?(d(),u("small",ge,l(a.value.errors.model_type[0]),1)):c("",!0)]),s("div",be,[s("label",xe,[y(l(e.$t((t.value.model_type==="product","discount.select_category")))+" ",1),he]),n(g,{filter:"",id:"model_ids",modelValue:t.value.model_ids,"onUpdate:modelValue":o[1]||(o[1]=r=>t.value.model_ids=r),options:(t.value.model_type==="product",V.value),optionLabel:k($),optionValue:"id",placeholder:e.$t((t.value.model_type==="product","discount.select_category")),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(q=(F=a.value)==null?void 0:F.errors)!=null&&q.model_ids?(d(),u("small",we,l(a.value.errors.model_ids[0]),1)):c("",!0)]),t.value.model_type==="product"?(d(),u("div",Ve,[s("label",ke,[y(l(e.$t("discount.select_product"))+" ",1),$e]),n(g,{filter:"",id:"product_id",modelValue:t.value.products,"onUpdate:modelValue":o[2]||(o[2]=r=>t.value.products=r),options:h.value,optionLabel:k($),optionValue:"id",placeholder:e.$t("discount.select_product"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(M=(B=a.value)==null?void 0:B.errors)!=null&&M.model_ids?(d(),u("small",De,l(a.value.errors.model_ids[0]),1)):c("",!0)])):c("",!0),s("div",Se,[s("label",Ie,[y(l(e.$t("discount.discount_type"))+" ",1),Le]),n(f,{filter:"",id:"discount_type",modelValue:t.value.discount_type,"onUpdate:modelValue":o[3]||(o[3]=r=>t.value.discount_type=r),options:[{label:e.$t("discount.fixed_amount"),value:1},{label:e.$t("discount.percentage"),value:2}],optionLabel:"label",optionValue:"value",placeholder:e.$t("discount.select_discount_type"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","options","placeholder"]),(U=(N=a.value)==null?void 0:N.errors)!=null&&U.discount_type?(d(),u("small",Ce,l(a.value.errors.discount_type[0]),1)):c("",!0)]),s("div",Fe,[s("label",qe,[y(l(e.$t("discount.discount_value"))+" ",1),Be]),n(O,{id:"discount_value",modelValue:t.value.discount_value,"onUpdate:modelValue":o[4]||(o[4]=r=>t.value.discount_value=r),min:0,max:t.value.discount_type===2?100:null,placeholder:e.$t("discount.enter_discount_value"),class:"w-full px-4 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","max","placeholder"]),t.value.discount_type===2?(d(),u("small",Me,l(e.$t("discount.percentage_note")),1)):c("",!0),(j=(E=a.value)==null?void 0:E.errors)!=null&&j.discount_value?(d(),u("small",Ne,l(a.value.errors.discount_value[0]),1)):c("",!0)]),s("div",Ue,[s("label",Ee,[y(l(e.$t("discount.expiration_date"))+" ",1),je]),n(Q,{id:"expires_at",modelValue:t.value.expires_at,"onUpdate:modelValue":o[5]||(o[5]=r=>t.value.expires_at=r),minDate:new Date,dateFormat:"yy-mm-dd",placeholder:e.$t("discount.select_expiration_date"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","minDate","placeholder"]),(T=(Y=a.value)==null?void 0:Y.errors)!=null&&T.expires_at?(d(),u("small",Ye,l(a.value.errors.expires_at[0]),1)):c("",!0)])]),s("div",Te,[n(I,{type:"button",label:e.$t("discount.cancel"),icon:"pi pi-times",onClick:o[6]||(o[6]=r=>k(D).go(-1)),class:"px-6 mx-2 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},null,8,["label","disabled"]),n(I,{type:"submit",label:e.$t("discount.create_discount"),icon:"pi pi-plus",loading:_.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:_.value},{default:R(()=>[_.value?(d(),u("i",ze)):(d(),u("span",Pe,l(e.$t("discount.create_discount")),1))]),_:1},8,["label","loading","disabled"])])]}),_:1},8,["onSubmit"])])),[[Z,"create discounts"]]),n(X)],64)}}},He=ee(Re,[["__scopeId","data-v-633e9fa6"]]);export{He as default};
