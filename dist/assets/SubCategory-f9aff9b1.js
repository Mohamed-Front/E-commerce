import{_ as E,k as O,u as R,j as T,r as i,m as q,n as G,a as l,c as d,f as t,t as f,e as _,h as S,w as j,g as b,b as I,F as N,d as H,i as V}from"./index-8ddd7ad9.js";import{p as J,S as K,A as Q,a as U,P as W}from"./ProductOffers-ae322d8f.js";import{N as X}from"./navigation-cdc7316c.js";import{d as h}from"./banner-addtion-e4104052.js";import{C as Y}from"./CustomTaps-36031ba6.js";const Z={class:"mx-auto bg-gradient-to mt-16 max-w-7xl"},ee={key:0,class:"py-16"},ae={class:"flex flex-col items-center justify-center space-y-4"},te={class:"text-indigo-600 text-xl font-semibold animate-pulse"},se={key:1,class:"text-center py-16 text-red-600"},oe={class:"text-lg font-semibold"},re={key:2},ne={class:"text-center mb-2"},le={class:"text-4xl sm:text-4xl font-extrabold text-gray-800 tracking-tight animate-fade-in"},ie={key:0},de={class:"w-full h-48 overflow-hidden rounded-xl shadow-md relative"},ce=["src","alt"],ue={class:"font-sans mt-4 mb-1 text-gray-800 font-semibold text-sm sm:text-base md:text-lg"},me={key:1,class:"my-8"},ge={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},_e=["src","alt"],pe={key:2,class:"my-8"},ve={class:"relative overflow-hidden rounded-2xl shadow-lg animate-banner-slide"},fe=["src","alt"],ye={__name:"SubCategory",setup(be){const x=O(),C=R(),{t:u,locale:y}=T(),p=i(localStorage.getItem("defaultStoreId")),n=i({}),m=i([]),w=i({title:"",products:[]}),D=i([]);i({title:"",products:[]});const k=i(!1),c=i(null),v=a=>y.value==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar,B=a=>y.value==="ar"?"منتجات "+(a.name_ar||a.name_en):"Products "+(a.name_en||a.name_ar),L=a=>{a.has_subcategories>0?C.push({name:"subcategory",params:{id:a.id}}):C.push({name:"produts_category",params:{id:a.id}})},M=async()=>{try{const s=(await V.get(`/api/home/products-by-category/${x.params.id}/${p.value}`)).data.data;n.value={id:s.category.id,name_ar:s.category.name_ar,name_en:s.category.name_en,media:s.category.media||[{url:h,name:"default"}]},m.value=s.sub_categories.map(e=>({id:e.id,name_ar:e.name_ar||e.name_en,name_en:e.name_en||e.name_ar,media:e.media.length?e.media:[{url:h,name:"default"}]})),w.value={title:B(n.value),products:(s.products.data||[]).map(e=>{var g,o;return{id:e.id,name:y.value==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar,tax:e.tax||0,price:parseFloat(e.base_price||0).toFixed(2),img:((o=(g=e.media)==null?void 0:g.find(r=>r.name==="product_main_image"))==null?void 0:o.url)||e.key_default_image||h}})}}catch(a){console.error("Error fetching category data:",a),c.value=u("category.errorLoading")||"Failed to load category data."}},z=async()=>{try{const a=m.value.map(async e=>((await V.get(`/api/home/products-by-category/${e.id}/${p.value}`)).data.data.products.data||[]).map(r=>{var F,$;return{id:r.id,name:y.value==="ar"?r.name_ar||r.name_en:r.name_en||r.name_ar,tax:r.tax||0,price:parseFloat(r.base_price||0).toFixed(2),img:(($=(F=r.media)==null?void 0:F.find(A=>A.name==="product_main_image"))==null?void 0:$.url)||r.key_default_image||h}})),s=await Promise.allSettled(a);D.value=s.filter(e=>e.status==="fulfilled").flatMap(e=>e.value)}catch(a){console.error("Error fetching subcategory products:",a),c.value=u("category.errorLoading")||"Failed to load subcategory products."}},P=async()=>{k.value=!0,c.value=null,await Promise.allSettled([M()]),m.value.length&&await z(),k.value=!1};return q(()=>{x.params.id&&p.value?P():c.value=u("category.missingParams")||"Missing category or store ID."}),G(()=>x.params.id,(a,s)=>{a!==s&&a&&p.value?P():(!a||!p.value)&&(c.value=u("category.missingParams")||"Missing category or store ID.")}),(a,s)=>{var e,g;return l(),d(N,null,[t("div",Z,[k.value?(l(),d("div",ee,[t("div",ae,[s[0]||(s[0]=t("div",{class:"relative w-24 h-24"},[t("div",{class:"absolute inset-0 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin"}),t("div",{class:"absolute inset-4 rounded-full border-4 border-pink-500 border-b-transparent animate-spin animation-delay-200"}),t("div",{class:"absolute inset-8 rounded-full border-4 border-purple-500 border-l-transparent animate-spin animation-delay-400"})],-1)),t("p",te,f(_(u)("category.loading")),1),s[1]||(s[1]=t("div",{class:"w-1/2 h-2 bg-gray-200 rounded-full overflow-hidden"},[t("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-pink-500 animate-progress"})],-1))])])):c.value?(l(),d("div",se,[t("p",oe,f(c.value),1),t("button",{onClick:P,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded"},f(_(u)("category.retry")),1)])):(l(),d("div",re,[t("div",ne,[t("h1",le,f(v(n.value)),1)]),m.value.length>=1?(l(),d("div",ie,[s[3]||(s[3]=t("h2",{class:"font-bold font-sans text-gray-800 text-2xl sm:text-3xl lg:text-4xl mb-8 animate-slide-up"},null,-1)),S(_(U),{modules:[_(Q),_(X)],"slides-per-view":3,"space-between":20,loop:m.value.length>3,autoplay:{delay:3e3,disableOnInteraction:!1},speed:1e3,"grab-cursor":!0,navigation:!1,class:"mt-6",breakpoints:{320:{slidesPerView:1,spaceBetween:8},640:{slidesPerView:2,spaceBetween:12},768:{slidesPerView:2,spaceBetween:16},1024:{slidesPerView:5.5,spaceBetween:20}}},{default:j(()=>[(l(!0),d(N,null,H(m.value,o=>(l(),I(_(K),{key:o.id,class:"group flex flex-col items-center cursor-pointer transition-all duration-300 hover:-translate-y-2",onClick:r=>L(o)},{default:j(()=>{var r;return[t("div",de,[t("img",{src:(r=o.media[0])==null?void 0:r.url,alt:`${v(o)} image`,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",loading:"lazy"},null,8,ce),s[2]||(s[2]=t("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-300"},null,-1))]),t("h3",ue,f(v(o)),1)]}),_:2},1032,["onClick"]))),128))]),_:1},8,["modules","loop"])])):b("",!0),(e=n.value.media)!=null&&e.find(o=>o.name==="banner_one_image")?(l(),d("div",me,[t("div",ge,[t("img",{src:n.value.media.find(o=>o.name==="banner_one_image").url,alt:`${v(n.value)} banner one`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,_e),s[4]||(s[4]=t("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent flex items-end justify-center p-6"},null,-1))])])):b("",!0),t("section",null,[w.value.products.length?(l(),I(J,{key:0,products:w.value,title:B(n.value)},null,8,["products","title"])):b("",!0),S(W)]),(g=n.value.media)!=null&&g.find(o=>o.name==="banner_two_image")?(l(),d("div",pe,[t("div",ve,[t("img",{src:n.value.media.find(o=>o.name==="banner_two_image").url,alt:`${v(n.value)} banner two`,class:"w-full h-64 sm:h-70 md:h-76 object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,fe),s[5]||(s[5]=t("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/50 flex items-center justify-center p-6"},null,-1))])])):b("",!0)]))]),S(Y)],64)}}},Se=E(ye,[["__scopeId","data-v-85998937"]]);export{Se as default};
