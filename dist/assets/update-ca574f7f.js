import{_ as N,j as R,u as q,E as M,Q as O,r as k,B as C,k as P,H as f,I as H,o as c,c as p,J,e as s,a as t,t as _,g as Q,L as D,O as z,m as h,b as i,F as $,d as G,w as K,D as B,p as W,i as X}from"./index-d54862d3.js";const x=g=>(W("data-v-6126faf1"),g=g(),X(),g),Y=["dir"],Z={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ee=["onSubmit"],te={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ae={class:"space-y-2"},se={for:"name_en",class:"block text-sm font-medium text-gray-700"},re=x(()=>t("span",{class:"text-red-500"},"*",-1)),le={class:"space-y-2"},oe={for:"name_ar",class:"block text-sm font-medium text-gray-700"},ne=x(()=>t("span",{class:"text-red-500"},"*",-1)),ie={class:"space-y-4"},ue={class:"text-lg font-semibold text-gray-700 border-b pb-2"},de={class:"space-y-2"},ce=["for"],me=x(()=>t("span",{class:"text-red-500"},"*",-1)),pe={class:"flex space-x-2"},_e={class:"space-y-2"},ve=["for"],be=x(()=>t("span",{class:"text-red-500"},"*",-1)),fe={class:"flex space-x-2"},ge={class:"pt-2"},ye={class:"pt-4 flex justify-center space-x-4"},he={key:0},xe={key:1,class:"pi pi-spinner pi-spin"},Ve={setup(g){const I=R(),V=q(),m=M(),{t:e}=O(),v=k(!1),w=k(!0),E=C(()=>localStorage.getItem("appLang")||"en"),S=C(()=>E.value==="ar"),a=k({name_en:"",name_ar:"",values:[{id:null,value_en:"",value_ar:""}]});P(async()=>{var n,r;try{const l=(await B.get(`/api/attribute/${I.params.id}`)).data.data;a.value={name_en:l.name_en,name_ar:l.name_ar,values:l.values.map(o=>({id:o.id,value_en:o.value_en,value_ar:o.value_ar}))},a.value.values.length===0&&a.value.values.push({id:null,value_en:"",value_ar:""})}catch(d){console.error("Error fetching attribute:",d),m.add({severity:"error",summary:e("error"),detail:((r=(n=d.response)==null?void 0:n.data)==null?void 0:r.message)||e("error.fetchError"),life:3e3}),V.push({name:"attribute"})}finally{w.value=!1}});const T=()=>{a.value.values.push({id:null,value_en:"",value_ar:""})},F=async n=>{const r=a.value.values[n].id;r?confirm.require({message:e("attribute.confirmDeleteValue"),header:e("common.confirmation"),icon:"pi pi-exclamation-triangle",accept:async()=>{var d,l;try{await B.delete(`/api/attribute-value/${r}`),a.value.values.splice(n,1),m.add({severity:"success",summary:e("success"),detail:e("attribute.valueDeleted"),life:3e3})}catch(o){console.error("Error deleting value:",o),m.add({severity:"error",summary:e("error"),detail:((l=(d=o.response)==null?void 0:d.data)==null?void 0:l.message)||e("error.deleteError"),life:3e3})}}}):a.value.values.length>1?a.value.values.splice(n,1):m.add({severity:"warn",summary:e("warning"),detail:e("attribute.minOneValue"),life:3e3})},U=async()=>{if(!a.value.name_en||!a.value.name_ar){m.add({severity:"error",summary:e("error"),detail:e("validation.requiredFields"),life:3e3});return}for(const n of a.value.values)if(!n.value_en||!n.value_ar){m.add({severity:"error",summary:e("error"),detail:e("attribute.valueRequired"),life:3e3});return}v.value=!0;try{await B.put(`/api/attribute/${I.params.id}`,a.value),m.add({severity:"success",summary:e("success"),detail:e("attribute.updateSuccess"),life:3e3}),V.push({name:"attribute"})}finally{v.value=!1}};return(n,r)=>{const d=f("ProgressBar"),l=f("InputText"),o=f("Button"),L=f("ConfirmDialog"),j=f("Toast"),A=H("can");return c(),p($,null,[J((c(),p("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:s(S)?"rtl":"ltr"},[t("h1",Z,_(s(e)("attribute.updateTitle")),1),w.value?(c(),Q(d,{key:0,mode:"indeterminate",class:"h-1"})):D("",!0),w.value?D("",!0):(c(),p("form",{key:1,onSubmit:z(U,["prevent"]),class:"space-y-6"},[t("div",te,[t("div",ae,[t("label",se,[h(_(s(e)("attribute.nameEn"))+" ",1),re]),i(l,{id:"name_en",modelValue:a.value.name_en,"onUpdate:modelValue":r[0]||(r[0]=u=>a.value.name_en=u),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),t("div",le,[t("label",oe,[h(_(s(e)("attribute.nameAr"))+" ",1),ne]),i(l,{id:"name_ar",modelValue:a.value.name_ar,"onUpdate:modelValue":r[1]||(r[1]=u=>a.value.name_ar=u),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])])]),t("div",ie,[t("h3",ue,_(s(e)("attribute.values")),1),(c(!0),p($,null,G(a.value.values,(u,b)=>(c(),p("div",{key:b,class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},[t("div",de,[t("label",{for:`value_en_${b}`,class:"block text-sm font-medium text-gray-700"},[h(_(s(e)("attribute.valueEn"))+" ",1),me],8,ce),t("div",pe,[i(l,{id:`value_en_${b}`,modelValue:u.value_en,"onUpdate:modelValue":y=>u.value_en=y,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"])])]),t("div",_e,[t("label",{for:`value_ar_${b}`,class:"block text-sm font-medium text-gray-700"},[h(_(s(e)("attribute.valueAr"))+" ",1),be],8,ve),t("div",fe,[i(l,{id:`value_ar_${b}`,modelValue:u.value_ar,"onUpdate:modelValue":y=>u.value_ar=y,dir:"rtl",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"]),i(o,{type:"button",icon:"pi pi-trash",severity:"danger",onClick:y=>F(b),class:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",title:s(e)("attribute.removeValue")},null,8,["onClick","title"])])])]))),128)),t("div",ge,[i(o,{type:"button",label:s(e)("attribute.addValue"),icon:"pi pi-plus",onClick:T,class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition"},null,8,["label"])])]),t("div",ye,[i(o,{type:"button",label:s(e)("attribute.cancelButton"),icon:"pi pi-times",onClick:r[2]||(r[2]=u=>s(V).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:v.value},null,8,["label","disabled"]),i(o,{type:"submit",label:s(e)("attribute.updateButton"),icon:"pi pi-check",loading:v.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:v.value},{default:K(()=>[v.value?(c(),p("i",xe)):(c(),p("span",he,_(s(e)("attribute.updateButton")),1))]),_:1},8,["label","loading","disabled"])])],40,ee)),i(L)],8,Y)),[[A,"edit attributes"]]),i(j)],64)}}},Be=N(Ve,[["__scopeId","data-v-6126faf1"]]);export{Be as default};
