import{_ as ne,j as ie,k as ue,u as ce,v as de,G as ve,r as v,l as h,o as pe,a as n,c as i,h as F,e as o,f as t,t as r,g as c,F as j,d as L,p as _e,x as G,y as ge,A as me,i as $,H as he,I as T,J as fe}from"./index-e346ff8d.js";import{P as xe}from"./ProductOffers-df3fc715.js";const ye={class:"product-page max-w-7xl mx-auto p-4 lg:p-8"},be={key:0,class:"text-center py-20"},we={class:"mt-4 text-gray-600"},ke={key:1,class:"text-red-500 text-center py-10 text-lg"},Oe={key:2,class:"flex flex-col lg:flex-row items-start gap-8 lg:gap-12"},Se={class:"w-full lg:w-1/2 flex flex-col-reverse lg:flex-row items-center gap-4"},Ce={class:"flex lg:flex-col flex-row items-center justify-center lg:justify-start gap-3 w-full lg:w-1/4 order-2 lg:order-1"},De=["src","alt","onClick"],Fe={class:"w-full lg:w-3/4 order-1 lg:order-2"},Re={class:"relative w-full aspect-square shadow-xl rounded-2xl overflow-hidden bg-gray-50"},Ve={key:0,class:"absolute top-4 left-4 z-10 bg-black text-white text-xs font-bold px-4 py-2 rounded-full uppercase tracking-wider shadow-lg"},Ae={key:1,class:"absolute top-4 right-4 z-10 bg-green-600 text-white text-xs font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-lg"},Be=["src","alt"],$e={class:"w-full lg:w-1/2"},qe={class:"bg-white rounded-2xl shadow-lg p-6 lg:p-8"},Ee={class:"flex flex-wrap gap-3 mb-6"},je={class:"text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"},Le={key:0,class:"text-xl text-gray-600 mb-6"},Te={class:"flex items-center gap-3 mb-6"},ze={class:"text-gray-600"},Ie={class:"mb-8"},Me={class:"flex items-baseline gap-4 flex-wrap"},Ne={class:"text-4xl font-bold text-gray-900"},Pe={key:0,class:"text-2xl font-bold text-[#0b3baa] line-through opacity-80"},Ue={class:"flex items-center gap-6 mb-8"},Qe={class:"font-bold text-gray-700 text-lg"},Ge={class:"flex items-center border-2 border-gray-300 rounded-xl overflow-hidden"},He=["disabled"],Je={class:"px-8 py-3 font-semibold text-lg border-x-2 border-gray-300 min-w-20 text-center"},We=["disabled"],Ke=["disabled"],Xe={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},Ye={key:1},Ze={key:2},et={key:3},tt={key:1,class:"text-red-600 font-semibold text-center mt-4"},st={key:3,class:"bg-[#E6AC312B] px-8 py-10 rounded-2xl mt-12"},at={class:"text-gray-700 leading-relaxed text-base"},lt={key:4,class:"mt-12 p-8 bg-white rounded-2xl shadow-xl"},ot={class:"text-3xl font-bold text-center text-gray-800 mb-10"},rt={class:"grid md:grid-cols-3 gap-8"},nt={class:"text-center"},it={class:"text-6xl font-bold text-gray-800"},ut={class:"text-gray-500"},ct={class:"md:col-span-2"},dt={class:"w-4 text-sm font-bold"},vt={class:"flex-1 bg-gray-200 rounded-full h-3 relative overflow-hidden"},pt={class:"text-sm text-gray-600 w-12 text-right"},_t={class:"mt-12"},gt={class:"text-xl font-bold mb-6 text-center"},mt={key:0,class:"max-w-2xl mx-auto"},ht=["placeholder"],ft=["disabled"],xt={key:0,class:"text-red-500 text-center mt-3"},yt={key:1,class:"text-center py-8"},bt={class:"text-gray-600 mb-6"},wt={key:0,class:"mt-12 space-y-8"},kt={class:"text-2xl font-bold text-gray-800"},Ot={class:"flex items-center justify-between mb-3"},St={class:"flex items-center gap-3"},Ct={class:"font-semibold"},Dt={class:"text-sm text-gray-500"},Ft={class:"text-gray-700 leading-relaxed"},Rt={key:1,class:"text-center py-12 text-gray-500"},Vt={key:5,class:"mt-12"},At={__name:"product-details",setup(Bt){const{t:l,locale:f}=ie(),z=ue(),y=ce(),R=de(),k=ve(),e=v({}),q=v([]),O=v(""),x=v(1),b=v(!0),w=v(null),S=v(!1),C=v(!1),d=v([]),V=v(!1),A=v(!1),D=v(null),I=v(0),g=v({rating:0,comment:""});h(()=>{const a=parseFloat(e.value.price||0),s=parseFloat(e.value.total_discounts_value||0);return(a-s).toFixed(2)});const H=h(()=>parseFloat(e.value.total_discounts_value||0)>0);h(()=>{const a=parseFloat(e.value.price||0),s=parseFloat(e.value.total_discounts_value||0);return a?Math.round(s/a*100):0});const M=a=>parseFloat(a||0).toFixed(2),B=h(()=>f.value==="en"?e.value.description_en:e.value.description_ar||l("product.noDescription")),N=h(()=>B.value.length>300),J=h(()=>N.value?B.value.slice(0,300)+"...":B.value),P=h(()=>d.value.length?d.value.reduce((s,p)=>s+p.rate,0)/d.value.length:0),W=h(()=>{const a={5:0,4:0,3:0,2:0,1:0};return d.value.forEach(s=>a[s.rate]++),[5,4,3,2,1].map(s=>({stars:s,count:a[s],percentage:d.value.length?Math.round(a[s]/d.value.length*100):0}))}),K=h(()=>d.value.slice(0,5)),X=a=>O.value=a,Y=()=>V.value=!V.value,Z=a=>a?new Date(a).toLocaleDateString(f.value==="ar"?"ar-EG":"en-US",{year:"numeric",month:"short",day:"numeric"}):"",ee=async()=>{var a,s;if(!R.authenticatedweb)return y.push({name:"authlog"});if(!(e.value.isOutOfStock||S.value)){S.value=!0;try{await $.post("/api/cart/add",{product_id:e.value.id,variant_id:e.value.variant_id||null,quantity:1}),e.value.in_cart=!0,x.value=1,k.add({severity:"success",summary:l("success"),detail:l("cart.added"),life:3e3})}catch(p){k.add({severity:"error",detail:((s=(a=p.response)==null?void 0:a.data)==null?void 0:s.message)||l("cart.error"),life:3e3})}finally{S.value=!1}}},U=async a=>{if(!R.authenticatedweb)return y.push({name:"authlog"});if(C.value||e.value.isOutOfStock)return;const s=a==="plus"?x.value+1:x.value-1;if(!(s<1)){C.value=!0;try{await $.post("/api/cart/update",{product_id:e.value.id,variant_id:e.value.variant_id||null,quantity:s}),x.value=s,e.value.in_cart=!0,k.add({severity:"success",detail:l(a==="plus"?"cart.quantityIncreased":"cart.quantityDecreased"),life:2e3})}catch{k.add({severity:"error",detail:l("cart.quantityError"),life:3e3})}finally{C.value=!1}}},te=()=>{e.value.in_cart||ee()},se=async()=>{var a,s,p;if(g.value.rating===0||!g.value.comment.trim()){D.value=l("reviews.requiredFields");return}A.value=!0,D.value=null;try{const m={model_id:z.params.id,rate:g.value.rating,type:"product",message:g.value.comment.trim()},{data:_}=await $.post("/api/review",m);_.is_success&&(d.value.unshift({id:_.data.id,rate:g.value.rating,message:g.value.comment.trim(),user:{name:((a=R.user)==null?void 0:a.name)||l("reviews.anonymous")},created_at:new Date().toISOString()}),g.value={rating:0,comment:""},k.add({severity:"success",detail:l("reviews.submitSuccess"),life:3e3}))}catch(m){D.value=((p=(s=m.response)==null?void 0:s.data)==null?void 0:p.message)||l("reviews.submitError")}finally{A.value=!1}},ae=a=>a&&y.push(a.has_subcategories?{name:"subcategory",params:{id:a.id}}:{name:"produts_category",params:{id:a.id}}),le=a=>a&&y.push({name:"products-brand",params:{id:a.id}}),oe=a=>a&&y.push(a.has_market?{name:"stores-hasmarket"}:{name:"home"}),re=async()=>{var a,s,p;b.value=!0;try{const{data:m}=await $.get(`/api/home/product-details/${z.params.id}`);if(m.is_success){const _=m.data.product;e.value={..._,in_cart:_.in_cart||!1,isOutOfStock:_.is_stock===0},q.value=_.media||[],O.value=((a=q.value[0])==null?void 0:a.url)||e.value.key_default_image,d.value=_.reviews||[],x.value=e.value.in_cart&&_.quantity||1}}catch(m){w.value=((p=(s=m.response)==null?void 0:s.data)==null?void 0:p.message)||l("product.loadError")}finally{b.value=!1}};return pe(()=>{window.scrollTo(0,0),re()}),(a,s)=>{var p,m,_,Q;return n(),i("div",ye,[b.value?(n(),i("div",be,[F(o(he),{style:{width:"50px",height:"50px"},strokeWidth:"4"}),t("p",we,r(o(l)("loading")),1)])):c("",!0),w.value?(n(),i("div",ke,r(w.value),1)):(n(),i("header",Oe,[t("div",Se,[t("div",Ce,[(n(!0),i(j,null,L(q.value,u=>(n(),i("img",{key:u.url,src:u.url,alt:o(l)("product.thumbnailAlt"),class:G(["h-20 w-20 object-cover rounded-lg cursor-pointer border-2 transition-all duration-200 hover:border-blue-500",{"border-blue-500 opacity-100":O.value===u.url,"border-gray-300 opacity-70":O.value!==u.url}]),onClick:E=>X(u.url)},null,10,De))),128))]),t("div",Fe,[t("div",Re,[e.value.is_best_seller?(n(),i("div",Ve," Best Seller ")):c("",!0),e.value.is_free_shipping?(n(),i("div",Ae,[s[8]||(s[8]=t("i",{class:"pi pi-truck"},null,-1)),_e(" "+r(o(l)("products.Free_Delivery")),1)])):c("",!0),t("img",{src:O.value||e.value.key_default_image,alt:o(f)==="en"?e.value.name_en:e.value.name_ar,class:"w-full h-full object-cover transition-transform duration-700 hover:scale-105",loading:"lazy"},null,8,Be)])])]),t("div",$e,[t("div",qe,[t("section",Ee,[e.value.store_id?(n(),i("span",{key:0,onClick:s[0]||(s[0]=u=>oe(e.value.store)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?(p=e.value.store)==null?void 0:p.name_en:((m=e.value.store)==null?void 0:m.name_ar)||o(l)("store.default")),1)):c("",!0),e.value.category?(n(),i("span",{key:1,onClick:s[1]||(s[1]=u=>ae(e.value.category)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?e.value.category.name_en:e.value.category.name_ar),1)):c("",!0),e.value.brand_id?(n(),i("span",{key:2,onClick:s[2]||(s[2]=u=>le(e.value.brand)),class:"sub-tiles cursor-pointer hover:bg-opacity-80 transition"},r(o(f)==="en"?(_=e.value.brand)==null?void 0:_.name_en:((Q=e.value.brand)==null?void 0:Q.name_ar)||o(l)("brand.default")),1)):c("",!0)]),t("h1",je,r(o(f)==="en"?e.value.name_en:e.value.name_ar),1),e.value.sub_name_en||e.value.sub_name_ar?(n(),i("h2",Le,r(o(f)==="en"?e.value.sub_name_en:e.value.sub_name_ar),1)):c("",!0),t("div",Te,[F(o(T),{modelValue:P.value,readonly:!0,cancel:!1,class:"text-lg"},null,8,["modelValue"]),t("span",ze,"("+r(d.value.length)+" "+r(d.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural"))+")",1)]),s[10]||(s[10]=t("hr",{class:"bg-gradient-to-r from-transparent via-[#A17D1C] to-transparent h-0.5 my-8"},null,-1)),t("div",Ie,[t("div",Me,[t("span",Ne,r(M(e.value.base_price_after_discount))+" "+r(a.$t("currencyLabel")),1),H.value?(n(),i("span",Pe,r(M(e.value.base_price))+" "+r(a.$t("currencyLabel")),1)):c("",!0)])]),t("div",Ue,[t("label",Qe,r(o(l)("product.quantity"))+":",1),t("div",Ge,[t("button",{onClick:s[3]||(s[3]=u=>U("minus")),disabled:x.value<=1||C.value||e.value.isOutOfStock,class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 transition"},"âˆ’",8,He),t("span",Je,r(x.value),1),t("button",{onClick:s[4]||(s[4]=u=>U("plus")),disabled:C.value||e.value.isOutOfStock,class:"px-5 py-3 text-2xl font-bold hover:bg-gray-100 transition"},"+",8,We)])]),t("button",{onClick:te,disabled:S.value||e.value.isOutOfStock,class:G(["w-full py-5 text-xl font-bold rounded-2xl text-white transition-all duration-300 shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3",{"bg-[#A6853B] hover:bg-[#8f702c]":!e.value.in_cart&&!e.value.isOutOfStock,"bg-[#0b3baa]":e.value.in_cart,"bg-gray-400 cursor-not-allowed":e.value.isOutOfStock}])},[e.value.in_cart?(n(),i("svg",Xe,s[9]||(s[9]=[t("path",{d:"M9 16.2l-3.5-3.5a.984.984 0 0 0-1.4 0 .984.984 0 0 0 0 1.4l4.2 4.2c.39.39 1.01.39 1.4 0l8.4-8.4a.984.984 0 0 0 0-1.4.984.984 0 0 0-1.4 0L9 16.2z"},null,-1)]))):c("",!0),e.value.in_cart?(n(),i("span",Ye,r(o(l)("product.inCart")),1)):e.value.isOutOfStock?(n(),i("span",Ze,r(o(l)("product.outOfStock")),1)):(n(),i("span",et,r(S.value?o(l)("product.adding")+"...":o(l)("product.addToCart")),1))],10,Ke),e.value.isOutOfStock?(n(),i("p",tt,r(o(l)("product.outOfStock")),1)):c("",!0)])])])),!b.value&&!w.value?(n(),i("section",st,[t("p",at,r(V.value?B.value:J.value),1),N.value?(n(),i("button",{key:0,onClick:Y,class:"mt-4 text-[#E39F30] font-bold text-sm hover:underline"},r(V.value?o(l)("product.readLess"):o(l)("product.readMore")),1)):c("",!0)])):c("",!0),!b.value&&!w.value?(n(),i("section",lt,[t("h2",ot,r(o(l)("reviews.title")),1),t("div",rt,[t("div",nt,[t("div",it,r(P.value.toFixed(1)),1),F(o(T),{modelValue:I.value,"onUpdate:modelValue":s[5]||(s[5]=u=>I.value=u),readonly:!0,cancel:!1,class:"my-3 justify-center text-3xl"},null,8,["modelValue"]),t("p",ut,r(d.value.length)+" "+r(d.value.length===1?o(l)("reviews.singular"):o(l)("reviews.plural")),1)]),t("div",ct,[(n(!0),i(j,null,L(W.value,u=>(n(),i("div",{key:u.stars,class:"flex items-center gap-3 mb-4"},[t("span",dt,r(u.stars),1),t("div",vt,[t("div",{class:"absolute top-0 left-0 h-full bg-[#F0E3C2] transition-all duration-500",style:fe({width:u.percentage+"%"})},null,4)]),t("span",pt,r(u.count),1)]))),128))])]),t("div",_t,[t("h3",gt,r(o(l)("reviews.writeReview")),1),o(R).authenticatedweb?(n(),i("div",mt,[ge(t("textarea",{"onUpdate:modelValue":s[6]||(s[6]=u=>g.value.comment=u),rows:"5",class:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#A6853B] focus:border-transparent outline-none resize-none",placeholder:o(l)("reviews.placeholder")},null,8,ht),[[me,g.value.comment]]),t("button",{onClick:se,disabled:A.value||g.value.rating===0||!g.value.comment.trim(),class:"mt-4 w-full py-4 bg-[#A6853B] hover:bg-[#8f702c] text-white font-bold rounded-xl transition disabled:opacity-50 disabled:cursor-not-allowed"},r(A.value?o(l)("reviews.submitting"):o(l)("reviews.submit")),9,ft),D.value?(n(),i("p",xt,r(D.value),1)):c("",!0)])):(n(),i("div",yt,[t("p",bt,r(o(l)("reviews.loginToReview")),1),t("button",{onClick:s[7]||(s[7]=u=>o(y).push({name:"authlog"})),class:"px-8 py-4 bg-[#A6853B] text-white font-bold rounded-xl hover:bg-[#8f702c] transition"},r(o(l)("reviews.login")),1)]))]),d.value.length?(n(),i("div",wt,[t("h3",kt,r(o(l)("reviews.customerReviews")),1),(n(!0),i(j,null,L(K.value,u=>{var E;return n(),i("div",{key:u.id,class:"border-b pb-6"},[t("div",Ot,[t("div",St,[t("span",Ct,r(((E=u.user)==null?void 0:E.name)||o(l)("reviews.anonymous")),1),F(o(T),{modelValue:u.rate,readonly:!0,cancel:!1},null,8,["modelValue"])]),t("span",Dt,r(Z(u.created_at)),1)]),t("p",Ft,r(u.message),1)])}),128))])):(n(),i("div",Rt,r(o(l)("reviews.noReviews")),1))])):c("",!0),!b.value&&!w.value?(n(),i("section",Vt,[F(xe)])):c("",!0)])}}},Et=ne(At,[["__scopeId","data-v-50b33b42"]]);export{Et as default};
