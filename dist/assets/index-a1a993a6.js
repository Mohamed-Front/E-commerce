import{_ as ne,u as de,M as ce,j as ue,r as i,n as pe,o as me,P as ve,a as h,c as _,f as s,h as r,w as d,e as a,t as n,F as O,d as ge,i as k,R as be,a1 as z,T as u,Z as ye,N as fe,C as he,$ as b,O as $,A as M,a0 as _e,x as xe,g as q,a2 as G,a5 as we}from"./index-dfefc3a0.js";const Ce={class:"grid"},ke={class:"col-12"},$e={class:"card p-4 shadow-2 border-round"},Ee={class:"text-2xl font-bold"},Ue={class:"flex gap-2"},Pe={class:"p-input-icon-left"},Re={class:"card shadow-1 surface-0"},De={class:"text-center py-4"},Le={class:"text-xl"},Se={class:"flex justify-content-center align-items-center py-4"},Ve={class:"p-paginator p-component p-unselectable-text p-paginator-bottom"},Ne={class:"p-paginator-left-content"},Fe={class:"p-paginator-current"},Te={class:"p-paginator-right-content"},Ie=["disabled"],je=["disabled"],Ae=["onClick","aria-label"],Be={key:1,class:"p-paginator-dots"},Oe=["disabled"],ze=["disabled"],Me={class:"flex align-items-center justify-content-center"},qe={class:"flex flex-column gap-3"},Ge={key:0,class:"mt-2"},Qe={class:"font-semibold"},We={__name:"index",setup(Ze){const V=de(),v=ce(),{t:l}=ue(),E=i(!0),N=i([]),x=i(!1),L=i(null),Q=i(null),W=i({}),U=i("");i(null);const w=i(!1),g=i(null),P=i(!1),F=i([]),R=i(null),p=i(1),S=i(0),y=i(10),D=i(0),Z=i(""),H=i(""),T=i(""),I=i(""),j=i(0),A=i(0),B=i([]),J=i([{id:"شفت 7",arabic_name:"Shift7",english_name:"الأحذية",Top_Parent:"shift7"}]),K=()=>{k.get("/api/store").then(o=>{F.value=o.data.data.data}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("store.loadError"),life:3e3}),console.error("Error fetching stores:",o)})},f=()=>{var o;E.value=!0,k.get("/api/category",{params:{page:p.value,limit:y.value,search:U.value||void 0,store_id:((o=R.value)==null?void 0:o.id)||void 0}}).then(e=>{N.value=e.data.data.data,S.value=e.data.data.total,D.value=e.data.data.last_page,Z.value=e.data.data.first_page_url,H.value=e.data.data.last_page_url,T.value=e.data.data.next_page_url,I.value=e.data.data.prev_page_url,j.value=e.data.data.from,A.value=e.data.data.to,B.value=e.data.data.links,p.value=e.data.data.current_page,E.value=!1}).catch(e=>{v.add({severity:"error",summary:l("error"),detail:l("category.loadError"),life:3e3}),E.value=!1,console.error("Error fetching categories:",e)})};pe([U,y,R],()=>{p.value=1,f()});const C=o=>{o>=1&&o<=D.value&&(p.value=o,f())},X=o=>{y.value=o.value,p.value=1,f()},Y=o=>{L.value=o,x.value=!0},ee=()=>{k.delete(`/api/category/${L.value}`).then(()=>{v.add({severity:"success",summary:l("success"),detail:l("category.deleteSuccess"),life:3e3}),f(),x.value=!1,L.value=null}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("category.deleteError"),life:3e3}),console.error("Error deleting category:",o)})},ae=()=>{k.get("/api/export/category",{responseType:"blob"}).then(o=>{const e=new Blob([o.data],{type:"text/csv"}),c=window.URL.createObjectURL(e),t=document.createElement("a");t.href=c,t.setAttribute("download","categories_export.csv"),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(c)}).catch(o=>{v.add({severity:"error",summary:l("error"),detail:l("category.exportError"),life:3e3}),console.error("Error exporting categories:",o)})},te=()=>{const o=`id,Arabic Name,English Name,Top Parent / Store
`+J.value.map(t=>`"${t.id}","${t.arabic_name}","${t.english_name}","${t.Top_Parent}",`).join(`
`),e=new Blob([o],{type:"text/csv;charset=utf-8;"}),c=document.createElement("a");if(c.download!==void 0){const t=URL.createObjectURL(e);c.setAttribute("href",t),c.setAttribute("download","category_import_example.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(t)}},le=()=>{w.value=!0,g.value=null},oe=o=>{g.value=o.files[0]},se=()=>{if(!g.value){v.add({severity:"warn",summary:l("warning"),detail:l("category.importNoFile"),life:3e3});return}P.value=!0;const o=new FormData;o.append("file",g.value),k.post("/api/import/store",o).then(()=>{v.add({severity:"success",summary:l("success"),detail:l("category.importSuccess"),life:3e3}),f(),w.value=!1,g.value=null;const e=document.querySelector('.p-fileupload input[type="file"]');e&&(e.value="")}).catch(e=>{v.add({severity:"error",summary:l("error"),detail:l("category.importError"),life:3e3}),console.error("Error importing categories:",e)}).finally(()=>{P.value=!1})},re=()=>{V.push({name:"category-create"})},ie=o=>{V.push({name:"category-update",params:{id:o}})};return me(()=>{K(),f()}),(o,e)=>{const c=ve("tooltip");return h(),_("div",Ce,[s("div",ke,[s("div",$e,[r(a(ye),{class:"mb-4"},{start:d(()=>[s("h2",Ee,n(a(l)("category.managementTitle")),1)]),end:d(()=>[s("div",Ue,[s("span",Pe,[e[11]||(e[11]=s("i",{class:"pi pi-search"},null,-1)),r(a(be),{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=t=>U.value=t),placeholder:a(l)("category.search")},null,8,["modelValue","placeholder"])]),r(a(z),{modelValue:R.value,"onUpdate:modelValue":e[1]||(e[1]=t=>R.value=t),options:F.value,optionLabel:"name_en",placeholder:a(l)("category.selectStore"),class:"w-12rem",showClear:!0,"aria-label":"Filter by store"},null,8,["modelValue","options","placeholder"]),r(a(u),{label:a(l)("category.import"),icon:"pi pi-download",class:"exite",onClick:le,"aria-label":"Import categories"},null,8,["label"]),r(a(u),{label:a(l)("category.export"),icon:"pi pi-upload",class:"exite",onClick:ae,"aria-label":"Export categories"},null,8,["label"]),r(a(u),{label:a(l)("category.new"),icon:"pi pi-plus",class:"p-button-success",onClick:re,"aria-label":"Create new category"},null,8,["label"])])]),_:1}),r(a(fe)),s("div",Re,[r(a(_e),{ref_key:"dt",ref:Q,value:N.value,loading:E.value,"data-key":"id",paginator:!1,rows:y.value,filters:W.value,totalRecords:S.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:d(()=>[s("div",De,[e[12]||(e[12]=s("i",{class:"pi pi-exclamation-circle text-2xl mb-2"},null,-1)),s("p",Le,n(a(l)("category.noData")),1)])]),loading:d(()=>[s("div",Se,[r(a(he),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:d(()=>[r(a(b),{"selection-mode":"multiple","header-style":"width: 3rem"}),r(a(b),{field:"id",header:a(l)("id"),sortable:!0,"header-style":"width:5%; min-width:5rem;"},{body:d(t=>[$(n(t.data.id),1)]),_:1},8,["header"]),r(a(b),{field:"name_en",header:a(l)("category.nameEn"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>[$(n(t.data.name_en),1)]),_:1},8,["header"]),r(a(b),{field:"name_ar",header:a(l)("category.nameAr"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>[$(n(t.data.name_ar),1)]),_:1},8,["header"]),r(a(b),{field:"parent.name_en",header:a(l)("category.parent"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>{var m;return[$(n(((m=t.data.parent)==null?void 0:m.name_en)||a(l)("category.noParent")),1)]}),_:1},8,["header"]),r(a(b),{field:"store.name_en",header:a(l)("category.store"),sortable:!0,"header-style":"width:14%; min-width:10rem;"},{body:d(t=>{var m;return[$(n(((m=t.data.store)==null?void 0:m.name_en)||a(l)("category.noStore")),1)]}),_:1},8,["header"]),r(a(b),{header:a(l)("actions"),"header-style":"width:12rem;"},{body:d(t=>[M(r(a(u),{icon:"pi pi-pencil",class:"p-detail",onClick:m=>ie(t.data.id),"aria-label":"Edit category"},null,8,["onClick"]),[[c,a(l)("edit"),void 0,{top:!0}]]),M(r(a(u),{icon:"pi pi-trash",class:"p-delete",onClick:m=>Y(t.data.id),"aria-label":"Delete category"},null,8,["onClick"]),[[c,a(l)("delete"),void 0,{top:!0}]])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"]),s("div",Ve,[s("div",Ne,[s("span",Fe,n(a(l)("show"))+" "+n(j.value)+" "+n(a(l)("to"))+" "+n(A.value)+" "+n(a(l)("from"))+" "+n(S.value),1)]),s("div",Te,[s("button",{class:"p-paginator-first p-paginator-element p-link",disabled:p.value===1,onClick:e[2]||(e[2]=t=>C(1)),"aria-label":"First page"},e[13]||(e[13]=[s("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)]),8,Ie),s("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:!I.value,onClick:e[3]||(e[3]=t=>C(p.value-1)),"aria-label":"Previous page"},e[14]||(e[14]=[s("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)]),8,je),(h(!0),_(O,null,ge(B.value,(t,m)=>(h(),_(O,{key:m},[t.label&&!isNaN(parseInt(t.label))?(h(),_("button",{key:0,class:xe(["p-paginator-page p-paginator-element p-link",{"p-highlight":t.active}]),onClick:He=>C(parseInt(t.label)),"aria-label":`Page ${t.label}`},n(t.label),11,Ae)):t.label==="..."?(h(),_("span",Be,"...")):q("",!0)],64))),128)),s("button",{class:"p-paginator-next p-paginator-element p-link",disabled:!T.value,onClick:e[4]||(e[4]=t=>C(p.value+1)),"aria-label":"Next page"},e[15]||(e[15]=[s("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)]),8,Oe),s("button",{class:"p-paginator-last p-paginator-element p-link",disabled:p.value===D.value,onClick:e[5]||(e[5]=t=>C(D.value)),"aria-label":"Last page"},e[16]||(e[16]=[s("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)]),8,ze),r(a(z),{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=t=>y.value=t),options:[5,10,20,30],onChange:X,class:"ml-2",style:{width:"80px"},"aria-label":"Rows per page"},null,8,["modelValue"])])])]),r(a(G),{visible:x.value,"onUpdate:visible":e[8]||(e[8]=t=>x.value=t),style:{width:"450px"},header:a(l)("category.deleteConfirmTitle"),modal:!0},{footer:d(()=>[r(a(u),{label:a(l)("cancel"),icon:"pi pi-times",text:"",onClick:e[7]||(e[7]=t=>x.value=!1),"aria-label":"Cancel delete"},null,8,["label"]),r(a(u),{label:a(l)("yes"),icon:"pi pi-check",text:"",severity:"danger",onClick:ee,"aria-label":"Confirm delete"},null,8,["label"])]),default:d(()=>[s("div",Me,[e[17]||(e[17]=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),s("span",null,n(a(l)("category.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"]),r(a(G),{visible:w.value,"onUpdate:visible":e[10]||(e[10]=t=>w.value=t),style:{width:"500px"},header:a(l)("category.importInstructions"),modal:!0},{footer:d(()=>[r(a(u),{label:a(l)("cancel"),icon:"pi pi-times",text:"",onClick:e[9]||(e[9]=t=>w.value=!1),"aria-label":"Cancel import"},null,8,["label"]),r(a(u),{label:a(l)("import"),icon:"pi pi-check",class:"p-button-success",onClick:se,disabled:!g.value,loading:P.value,"aria-label":"Import categories"},null,8,["label","disabled","loading"])]),default:d(()=>[s("div",qe,[s("div",null,[r(a(u),{label:a(l)("category.downloadExample"),icon:"pi pi-download",class:"p-button-outlined",onClick:te,"aria-label":"Download example CSV"},null,8,["label"])]),r(a(we),{mode:"basic",name:"file",accept:".xlsx,.xls,.csv",maxFileSize:1e7,chooseLabel:a(l)("category.chooseFile"),onSelect:oe,auto:!1,disabled:P.value,class:"mb-3"},null,8,["chooseLabel","disabled"]),g.value?(h(),_("div",Ge,[s("p",Qe,n(a(l)("selectedFile"))+": "+n(g.value.name),1)])):q("",!0)])]),_:1},8,["visible","header"])])])])}}},Ke=ne(We,[["__scopeId","data-v-004a8f1c"]]);export{Ke as default};
