import{_ as N,k as q,u as M,G as P,j as z,r as w,l as D,o as G,n as f,R as O,a as n,c as d,z as E,f as r,t as v,e as l,b as T,g as h,D as H,p as x,h as u,F as U,d as J,w as K,i as B,B as Q}from"./index-4761cd15.js";const W=["dir"],X={class:"text-3xl font-bold text-center mb-8 text-gray-800"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z={class:"space-y-2"},ee={for:"name_en",class:"block text-sm font-medium text-gray-700"},te={class:"space-y-2"},ae={for:"name_ar",class:"block text-sm font-medium text-gray-700"},se={class:"space-y-2"},re={for:"is_color",class:"block text-sm font-medium text-gray-700"},le={class:"space-y-4"},oe={class:"text-lg font-semibold text-gray-700 border-b pb-2"},ne={class:"space-y-2"},ie=["for"],ue={class:"flex space-x-2"},de=["id","onUpdate:modelValue"],ce={key:0,class:"space-y-2"},me=["for"],_e={class:"flex space-x-2"},pe={key:1,class:"space-y-2"},ve={class:"pt-2"},be={class:"pt-4 flex justify-center space-x-4"},ge={key:0},fe={key:1,class:"pi pi-spinner pi-spin"},ye={__name:"update",setup(he){const C=q(),V=M(),_=P(),{t:e}=z(),g=w(!1),k=w(!0),I=D(()=>localStorage.getItem("appLang")||"en"),F=D(()=>I.value==="ar"),t=w({name_en:"",name_ar:"",is_color:!1,values:[{id:null,value_en:"",value_ar:""}]});G(async()=>{var c,a;try{const s=(await B.get(`/api/attribute/${C.params.id}`)).data.data;t.value={name_en:s.name_en,name_ar:s.name_ar,is_color:!!s.is_color,values:s.values.length>0?s.values.map(p=>({id:p.id,value_en:p.value_en,value_ar:p.value_ar})):[{id:null,value_en:"",value_ar:""}]}}catch(i){console.error("Error fetching attribute:",i),_.add({severity:"error",summary:e("error"),detail:((a=(c=i.response)==null?void 0:c.data)==null?void 0:a.message)||e("error.fetchError"),life:3e3}),V.push({name:"attributes"})}finally{k.value=!1}});const S=()=>{t.value.values.push({id:null,value_en:"",value_ar:""})},$=async c=>{const a=t.value.values[c].id;a?confirm.require({message:e("attribute.confirmDeleteValue"),header:e("common.confirmation"),icon:"pi pi-exclamation-triangle",accept:async()=>{var i,s;try{await B.delete(`/api/attribute-value/${a}`),t.value.values.splice(c,1),_.add({severity:"success",summary:e("success"),detail:e("attribute.valueDeleted"),life:3e3})}catch(p){console.error("Error deleting value:",p),_.add({severity:"error",summary:e("error"),detail:((s=(i=p.response)==null?void 0:i.data)==null?void 0:s.message)||e("error.deleteError"),life:3e3})}}}):t.value.values.length>1?t.value.values.splice(c,1):_.add({severity:"warn",summary:e("warning"),detail:e("attribute.minOneValue"),life:3e3})},R=async()=>{var a,i;if(!t.value.name_en||!t.value.name_ar){_.add({severity:"error",summary:e("error"),detail:e("validation.requiredFields"),life:3e3});return}for(const s of t.value.values)if(!s.value_en||!t.value.is_color&&!s.value_ar){_.add({severity:"error",summary:e("error"),detail:e("attribute.valueRequired"),life:3e3});return}g.value=!0;const c={name_en:t.value.name_en,name_ar:t.value.name_ar,is_color:t.value.is_color,values:t.value.is_color?t.value.values.map(s=>({id:s.id,value_en:s.value_en,value_ar:s.value_en})):t.value.values};try{await B.put(`/api/attribute/${C.params.id}`,c),_.add({severity:"success",summary:e("success"),detail:e("attribute.updateSuccess"),life:3e3}),V.push({name:"attributes"})}catch(s){console.error("Error updating attribute:",s),_.add({severity:"error",summary:e("error"),detail:((i=(a=s.response)==null?void 0:a.data)==null?void 0:i.message)||e("error.updateError"),life:3e3})}finally{g.value=!1}};return(c,a)=>{const i=f("ProgressBar"),s=f("InputText"),p=f("InputSwitch"),y=f("Button"),j=f("ConfirmDialog"),A=f("Toast"),L=O("can");return n(),d(U,null,[E((n(),d("div",{class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg",dir:F.value?"rtl":"ltr"},[r("h1",X,v(l(e)("attribute.updateTitle")),1),k.value?(n(),T(i,{key:0,mode:"indeterminate",class:"h-1"})):h("",!0),k.value?h("",!0):(n(),d("form",{key:1,onSubmit:H(R,["prevent"]),class:"space-y-6"},[r("div",Y,[r("div",Z,[r("label",ee,[x(v(l(e)("attribute.nameEn"))+" ",1),a[4]||(a[4]=r("span",{class:"text-red-500"},"*",-1))]),u(s,{id:"name_en",modelValue:t.value.name_en,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.name_en=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),r("div",te,[r("label",ae,[x(v(l(e)("attribute.nameAr"))+" ",1),a[5]||(a[5]=r("span",{class:"text-red-500"},"*",-1))]),u(s,{id:"name_ar",modelValue:t.value.name_ar,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.name_ar=o),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue"])]),r("div",se,[r("label",re,v(l(e)("attribute.isColor")),1),u(p,{id:"is_color",modelValue:t.value.is_color,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.is_color=o),class:"mt-2"},null,8,["modelValue"])])]),r("div",le,[r("h3",oe,v(l(e)("attribute.values")),1),(n(!0),d(U,null,J(t.value.values,(o,m)=>(n(),d("div",{key:m,class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},[r("div",ne,[r("label",{for:`value_en_${m}`,class:"block text-sm font-medium text-gray-700"},[x(v(l(e)("attribute.valueEn"))+" ",1),a[6]||(a[6]=r("span",{class:"text-red-500"},"*",-1))],8,ie),r("div",ue,[t.value.is_color?E((n(),d("input",{key:1,type:"color",id:`value_en_${m}`,"onUpdate:modelValue":b=>o.value_en=b,class:"flex-1 h-10 border border-gray-300 rounded-lg"},null,8,de)),[[Q,o.value_en]]):(n(),T(s,{key:0,id:`value_en_${m}`,modelValue:o.value_en,"onUpdate:modelValue":b=>o.value_en=b,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"]))])]),t.value.is_color?h("",!0):(n(),d("div",ce,[r("label",{for:`value_ar_${m}`,class:"block text-sm font-medium text-gray-700"},[x(v(l(e)("attribute.valueAr"))+" ",1),a[7]||(a[7]=r("span",{class:"text-red-500"},"*",-1))],8,me),r("div",_e,[u(s,{id:`value_ar_${m}`,modelValue:o.value_ar,"onUpdate:modelValue":b=>o.value_ar=b,dir:"rtl",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["id","modelValue","onUpdate:modelValue"]),u(y,{type:"button",icon:"pi pi-trash",severity:"danger",onClick:b=>$(m),class:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",title:l(e)("attribute.removeValue")},null,8,["onClick","title"])])])),t.value.is_color&&m>0?(n(),d("div",pe,[u(y,{type:"button",icon:"pi pi-trash",severity:"danger",onClick:b=>$(m),class:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition",title:l(e)("attribute.removeValue")},null,8,["onClick","title"])])):h("",!0)]))),128)),r("div",ve,[u(y,{type:"button",label:l(e)("attribute.addValue"),icon:"pi pi-plus",onClick:S,class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition"},null,8,["label"])])]),r("div",be,[u(y,{type:"button",label:l(e)("attribute.cancelButton"),icon:"pi pi-times",onClick:a[3]||(a[3]=o=>l(V).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:g.value},null,8,["label","disabled"]),u(y,{type:"submit",label:l(e)("attribute.updateButton"),icon:"pi pi-check",loading:g.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:g.value},{default:K(()=>[g.value?(n(),d("i",fe)):(n(),d("span",ge,v(l(e)("attribute.updateButton")),1))]),_:1},8,["label","loading","disabled"])])],32)),u(j)],8,W)),[[L,"edit attributes"]]),u(A)],64)}}},ke=N(ye,[["__scopeId","data-v-4299cd7b"]]);export{ke as default};
