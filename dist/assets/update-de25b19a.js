import{v as A,r as n,u as R,x as U,D as C,o as S,b as w,d as h,e as P,J as B,w as F,h as _,H as N,i as y,f as x,t as L,n as O,j as M}from"./index-f9345899.js";import{r as V,v as k,p as W,a as G}from"./filepond-plugin-image-preview.esm-ae7c8229.js";import{s as $}from"./editor.esm-f7ba64ca.js";/*!
 * FilePondPluginFileEncode 2.1.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const z=function(){self.onmessage=u=>{p(u.data.message,o=>{self.postMessage({id:u.data.id,message:o})})};const p=(u,o)=>{const{file:f}=u,m=new FileReader;m.onloadend=()=>{o(m.result.replace("data:","").replace(/^.+,/,""))},m.readAsDataURL(f)}},I=({addFilter:p,utils:u})=>{const{Type:o,createWorker:f,createRoute:m,isFile:b}=u,l=({name:e,file:s})=>new Promise(c=>{const t=f(z);t.post({file:s},a=>{c({name:e,data:a}),t.terminate()})}),r=[];return p("DID_CREATE_ITEM",(e,{query:s})=>{s("GET_ALLOW_FILE_ENCODE")&&(e.extend("getFileEncodeBase64String",()=>r[e.id]&&r[e.id].data),e.extend("getFileEncodeDataURL",()=>`data:${e.fileType};base64,${r[e.id].data}`))}),p("SHOULD_PREPARE_OUTPUT",(e,{query:s})=>new Promise(c=>{c(s("GET_ALLOW_FILE_ENCODE"))})),p("COMPLETE_PREPARE_OUTPUT",(e,{item:s,query:c})=>new Promise(t=>{if(!c("GET_ALLOW_FILE_ENCODE")||!b(e)&&!Array.isArray(e))return t(e);r[s.id]={metadata:s.getMetadata(),data:null},Promise.all((e instanceof Blob?[{name:null,file:e}]:e).map(l)).then(a=>{r[s.id].data=e instanceof Blob?a[0].data:a,t(e)})})),p("CREATE_VIEW",e=>{const{is:s,view:c,query:t}=e;!s("file-wrapper")||!t("GET_ALLOW_FILE_ENCODE")||c.registerWriter(m({DID_PREPARE_OUTPUT:({root:a,action:d})=>{if(t("IS_ASYNC"))return;const i=t("GET_ITEM",d.id);if(!i)return;const v=r[i.id],E=v.metadata,T=v.data,g=JSON.stringify({id:i.id,name:i.file.name,type:i.file.type,size:i.file.size,metadata:E,data:T});a.ref.data?a.ref.data.value=g:a.dispatch("DID_DEFINE_VALUE",{id:i.id,value:g})},DID_REMOVE_ITEM:({action:a})=>{const d=t("GET_ITEM",a.id);d&&delete r[d.id]}}))}),{options:{allowFileEncode:[!0,o.BOOLEAN]}}},j=typeof window<"u"&&typeof window.document<"u";j&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:I}));const H={class:"flex justify-center"},J=["onSubmit"],q=_("h2",{class:"pb-4 text-center va-text-bold"}," Update Page ",-1),Q={class:""},Y=_("label",{for:"password"},"Title ",-1),K={key:0,class:"mt-1 mb-5 text-red-500"},X={class:""},Z=_("label",{for:"password"},"Description ",-1),ee={key:0,class:"mt-1 mb-5 text-red-500"},oe={setup(p){V(I),k(G,W);const u=A(),o=n({title:"",description:""});n(null);const f=n([]),m=R(),b=n(0);n(""),n([]);const l=n({});n(0),n(0);const r=n([]);n([{name:"en",value:"gb"},{name:"ar",value:"sa"},{name:"az",value:"az"},{name:"ge",value:"ge"},{name:"ru",value:"ru"},{name:"tr",value:"tr"}]);const e=n("gb"),s=n(""),c=()=>{const t=new FormData;for(let a=0;a<r.value.length;a++)t.append("images[]",r.value[a]);t.append("title",o.value.title),t.append("description",o.value.description),w.defaults.headers.common.local=e.value,w.post(`/api/pages/${l.value.id}/update`,t).then(a=>{s.value=[],b.value=1;let d=l.value.media;l.value=a.data.page,l.value.media=d,u.add({severity:"success",summary:"Successful",detail:"Page Updated",life:3e3})}).catch(a=>{s.value=a.response.data.errors,console.log(s.value)})};return U(e,async(t,a)=>{var d,i,v,E;console.log(l.value),o.value.title=((d=l.value)==null?void 0:d.title[t])==null?"":(i=l.value)==null?void 0:i.title[t],o.value.description=((v=l.value)==null?void 0:v.description[t])==null?"":(E=l.value)==null?void 0:E.description[t]}),C(()=>f.value),S(()=>{w.get(`/api/pages/${m.params.id}`).then(t=>{o.value.title=t.data.page.title[e.value],o.value.description=t.data.page.description[e.value],l.value=t.data.page})}),(t,a)=>{const d=h("InputText"),i=h("Button"),v=h("Toast"),E=h("va-card");return P(),B(E,{class:"card"},{default:F(()=>{var T,g;return[_("div",H,[_("form",{onSubmit:N(c,["prevent"]),class:"flex flex-col w-3/4 py-9"},[q,_("div",Q,[Y,y(d,{modelValue:o.value.title,"onUpdate:modelValue":a[0]||(a[0]=D=>o.value.title=D),type:"text",class:"mt-3 w-full mb-3"},null,8,["modelValue"]),(T=s.value)!=null&&T.title?(P(),x("div",K,L(s.value.title[0]),1)):O("",!0)]),_("div",X,[Z,y(M($),{modelValue:o.value.description,"onUpdate:modelValue":a[1]||(a[1]=D=>o.value.description=D),editorStyle:"height: 150px",class:"my-2"},null,8,["modelValue"]),(g=s.value)!=null&&g.description?(P(),x("div",ee,L(s.value.description[0]),1)):O("",!0)]),y(i,{type:"submit",label:"Submit",class:"mt-3"})],40,J)]),y(v)]}),_:1})}}};export{oe as default};
