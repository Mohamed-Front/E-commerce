import{_ as A,u as I,k as j,r as f,n as T,o as L,a as l,c as r,f as t,L as N,F as m,d as x,e as u,g as _,t as y,N as k,z as U,A as b,B as w,O as D}from"./index-deb4792e.js";import{u as F}from"./WebAuth-e4839337.js";const K={class:"bg-gray-900 min-h-screen flex items-start justify-center p-4 overflow-hidden",dir:"rtl"},M={class:"bg-white rounded-3xl shadow-2xl p-6 w-full max-w-sm sm:max-w-lg my-8 text-center"},$={class:"space-y-6"},z={key:0},H={class:"flex justify-center space-x-2 space-x-reverse"},q=["onUpdate:modelValue","onInput","onKeydown","aria-label"],G={key:0,class:"text-red-500 text-sm text-right"},J=["disabled"],Q={class:"text-center text-sm text-gray-500 mt-4"},W={key:1},X={class:"space-y-4"},Y={key:0,class:"text-red-500 text-sm text-right"},Z=["disabled"],ee={__name:"ChnagePassword",props:{email:String,phone:String,otp_type:String},setup(P){const O=I();j();const s=F(),i=f(["","","","","",""]),g=f([]),h=f(!1),p=f(""),v=f(""),n=P;T(h,a=>{a&&(console.log("OTP verification successful, isOtpVerified is now true"),s.clearErrors("verifyOtp"))}),L(()=>{console.log("Change Password Page Props:",{email:n.email,phone:n.phone,otp_type:n.otp_type}),g.value.length>0&&g.value[0].focus()});const C=(a,e)=>{const o=e.target.value;o.length>1?i.value[a]=o.slice(0,1):i.value[a]=o,o&&a<i.value.length-1&&g.value[a+1].focus()},E=a=>{a>0&&i.value[a]===""&&g.value[a-1].focus()},V=async()=>{const a=i.value.join("");if(a.length!==6){s.authErrors.verifyOtp=["الرجاء إدخال رمز تحقق مكون من 6 أرقام"];return}await s.verifyOtp({email:n.email,phone:n.phone,otp:a}),h.value=s.verify},B=async()=>{s.clearErrors("resendOtp"),await s.resendOtp({email:n.email,phone:n.phone,otp_type:n.otp_type})},R=async()=>{if(!p.value||p.value.length<8){s.authErrors.completePasswordReset=["كلمة المرور يجب أن تكون 8 أحرف على الأقل"];return}if(p.value!==v.value){s.authErrors.completePasswordReset=["كلمة المرور وتأكيدها غير متطابقتين"];return}await s.completePasswordReset({email:n.email,phone:n.phone,otp:i.value.join(""),password:p.value})},S=()=>{O.push({name:"authlog"})};return(a,e)=>(l(),r("div",K,[t("div",M,[e[8]||(e[8]=t("div",{class:"flex flex-col items-center mb-8"},[t("img",{src:N,alt:"SHIFT7 Logo",class:"h-16 w-16 object-contain"})],-1)),t("div",$,[h.value?(l(),r("div",W,[e[5]||(e[5]=t("h2",{class:"text-2xl font-bold text-gray-800"},"إعادة تعيين كلمة المرور",-1)),e[6]||(e[6]=t("p",{class:"text-sm text-gray-500"}," أدخل كلمة المرور الجديدة وتأكيدها ",-1)),t("div",X,[b(t("input",{type:"password","onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o),placeholder:"أدخل كلمة المرور الجديدة","aria-label":"كلمة المرور الجديدة",class:"w-full px-4 py-3 rounded-xl bg-gray-100 placeholder-gray-400 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow text-right"},null,512),[[w,p.value]]),b(t("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=o=>v.value=o),placeholder:"تأكيد كلمة المرور","aria-label":"تأكيد كلمة المرور",class:"w-full px-4 py-3 rounded-xl bg-gray-100 placeholder-gray-400 text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow text-right"},null,512),[[w,v.value]]),u(s).getErrorsByAction("completePasswordReset").length?(l(),r("div",Y,[(l(!0),r(m,null,x(u(s).getErrorsByAction("completePasswordReset"),o=>(l(),r("p",{key:o},y(o),1))),128))])):_("",!0)]),t("button",{onClick:R,disabled:u(s).loading,class:"w-full mt-6 py-3 bg-blue-700 text-white font-bold rounded-xl shadow-lg hover:bg-blue-800 transition-colors duration-300 disabled:bg-gray-400"},y(u(s).loading?"جاري إعادة التعيين...":"إعادة تعيين كلمة المرور"),9,Z)])):(l(),r("div",z,[e[3]||(e[3]=t("h2",{class:"text-2xl font-bold text-gray-800"},"ادخل الرمز المرسل",-1)),e[4]||(e[4]=t("p",{class:"text-sm text-gray-500 my-3"}," تم إرسال رمز التحقق المكون من 6 أرقام ",-1)),t("div",H,[(l(!0),r(m,null,x(i.value,(o,d)=>b((l(),r("input",{key:d,type:"tel",maxlength:"1",class:"w-12 h-12 text-center text-xl font-bold rounded-xl bg-gray-100 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow","onUpdate:modelValue":c=>i.value[d]=c,onInput:c=>C(d,c),onKeydown:D(c=>E(d),["backspace"]),ref_for:!0,ref:c=>{c&&(g.value[d]=c)},"aria-label":`رقم التحقق ${d+1}`},null,40,q)),[[w,i.value[d]]])),128))]),u(s).getErrorsByAction("verifyOtp").length?(l(),r("div",G,[(l(!0),r(m,null,x(u(s).getErrorsByAction("verifyOtp"),o=>(l(),r("p",{key:o},y(o),1))),128))])):_("",!0),t("button",{onClick:V,disabled:u(s).loading,class:"w-full mt-6 py-3 bg-blue-700 text-white font-bold rounded-xl shadow-lg hover:bg-blue-800 transition-colors duration-300 disabled:bg-gray-400"},y(u(s).loading?"جاري التحقق...":"تحقق"),9,J),t("div",Q,[e[2]||(e[2]=k(" لم تتلق الرمز؟ ")),t("a",{href:"#",onClick:U(B,["prevent"]),class:"text-blue-600 font-semibold hover:underline"},"إعادة إرسال الرمز")])])),t("div",{class:"text-center text-sm text-gray-500 mt-4"},[e[7]||(e[7]=k(" لديك حساب بالفعل؟ ")),t("a",{onClick:S,class:"text-blue-600 cursor-pointer font-semibold hover:underline"},"تسجيل الدخول")])])])]))}},oe=A(ee,[["__scopeId","data-v-a8d557c6"]]);export{oe as default};
