import{u as z,H as J,i as q,a as E,I as H,r as w,v as L,b as g,c as v,e as x,d as l,J as K,K as O,t as f,g as c,F as N,f as Y,x as $,L as M,z as _,s as I,M as Z}from"./index-12def618.js";const G="/assets/loginFormImg-54a808b3.png",{t:j}=z(),Q=J("auth",{state:()=>({user:null,token:localStorage.getItem("token")||"",loading:!1,error:""}),getters:{isAuthenticated:i=>!!i.token},actions:{async loginUser(i,m=!1){this.loading=!0,this.error="";try{const r=await q.post("api/login",i);this.user={id:r.data.data.user.id,name:r.data.data.user.name,phone:r.data.data.user.phone,email_verified_at:r.data.data.user.email_verified_at,permissions:r.data.data.user.permissions||[]},this.token=r.data.data.access_token,m&&(localStorage.setItem("userPermissions",JSON.stringify(this.user.permissions)),localStorage.setItem("usertoken",this.token)),await E().push({name:"home"})}catch(r){this.handleLoginError(r)}finally{this.loading=!1}},handleLoginError(i){var m,r,t;throw((m=i.response)==null?void 0:m.status)===401?this.error=j("auth.notcorrect"):(t=(r=i.response)==null?void 0:r.data)!=null&&t.message?this.error=i.response.data.message:this.error=j("auth.noneerorr"),i},logout(){const i=E();this.user=null,this.token="",this.error="",localStorage.removeItem("token"),localStorage.removeItem("userPermissions"),i.push({name:"login"})},async registration(i){this.loading=!0,this.error="";try{await q.post("api/register",i)&&this.loginUser({email:i.email,password:i.password})}catch(m){this.handleLoginError(m)}finally{this.loading=!1}}}});const W={class:"flex flex-col bg-[#111] min-h-[110vh]"},X={class:"min-h-[80vh] flex justify-evenly items-center"},ee={class:"bg-[#2A2A2A] p-8 rounded-md text-white lg:min-w-[40%] min-w-[80%]"},se={class:""},te={class:"font-bold"},ae={class:"text-[#9F9F9F] mb-6"},oe={class:"flex flex-col gap-1 w-full text-white"},le={key:0,for:"email",class:"mb-2"},ne=["onUpdate:modelValue","type","placeholder","onBlur","id"],ie=["onClick"],re={key:2,name:"email",class:"text-red-500 text-xs mx-4"},ue={key:0,class:"flex justify-between w-full"},de={for:"rememberme"},ce={class:"text-blue-500"},pe={key:1},me={for:"Terms"},he={class:"text-xs text-[#9F9F9F]"},fe={__name:"auth",setup(i){const m=H(),r=Q(),{t}=z(),u=w("login"),b=w(!0),k=w(!1),h=w([{type:"username",data:"",inputtype:"text",icon:"pi-user",placeholder:"Your Name",page:["registration"]},{type:"email",data:"",placeholder:"test@example.com",inputtype:"text",page:["login","registration"]},{type:"phone",data:"",placeholder:"07xxxxxxxx",inputtype:"text",page:["registration"]},{type:"password",data:"",icon:"pi-lock",showicon:"pi-eye-slash",inputtype:"password",page:["login","registration"]},{type:"checkpassword",data:"",icon:"pi-lock",showicon:"pi-eye-slash",inputtype:"password",page:["registration"]}]);w([{type:"email"}]);const s=w({}),B=n=>{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/i,o=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/;switch(n){case"email":s.value.type=n;const p=h.value.find(d=>d.type===n),a=p==null?void 0:p.data.trim();a?e.test(a)?s.value.message="":s.value.message=t("auth.emailerr"):s.value.message=t("auth.emailreq");break;case"password":s.value.type=n;const y=h.value.find(d=>d.type==="password"),T=y==null?void 0:y.data.trim();T?o.test(T)?s.value.message=t("auth.passworderr"):s.value.message="":s.value.message=t("auth.passwordreq");break;case"username":s.value.type=n;const V=h.value.find(d=>d.type===n);(V==null?void 0:V.data.trim())?s.value.message="":s.value.message=t("auth.usernamereq");break;case"checkpassword":s.value.type=n;const F=h.value.find(d=>d.type==="password"),R=F==null?void 0:F.data.trim(),S=h.value.find(d=>d.type===n),U=S==null?void 0:S.data.trim();U?U!==R?s.value.message=t("auth.repassworderr"):s.value.message="":s.value.message=t("auth.repasswordreq");break;case"phone":s.value.type=n;const C=h.value.find(d=>d.type===n),A=C==null?void 0:C.data.trim();A?/^\d+$/.test(A)?s.value.message="":s.value.message=t("auth.justnum"):s.value.message=t("auth.phonereq");break}},D=async()=>{const n=h.value.filter(o=>o.page.includes(u.value));for(const o of n)if(B(o.type),s.value.message)break;const e=w({});if(!s.value.message&&u.value=="login"){for(const o of n)e.value.email=o.type=="email"?o.data:e.value.email,e.value.password=o.type=="password"?o.data:e.value.password;await r.loginUser(e.value,b.value)}else if(!s.value.message&&u.value=="registration"){if(!k.value){m.add({severity:"info",summary:t("auth.Terms"),detail:t("auth.Termserror"),life:3e3});return}for(const o of n)e.value.email=o.type=="email"?o.data:e.value.email,e.value.password=o.type=="password"?o.data:e.value.password,e.value.name=o.type=="username"?o.data:e.value.name,e.value.phone=o.type=="phone"?o.data:e.value.phone;await r.registration(e.value)}},P=n=>{const e=document.getElementById(n),o=h.value.find(p=>p.type===n);e.type=="text"?(e.type="password",o.showicon="pi-eye-slash"):e.type=="password"&&(e.type="text",o.showicon="pi-eye")};return(n,e)=>{const o=L("Toast"),p=L("Button");return g(),v(N,null,[x(o),l("main",W,[e[5]||(e[5]=l("nav",null,[l("img",{src:K,alt:"",width:"80",class:"m-[2rem]"})],-1)),l("div",X,[l("div",ee,[l("div",se,[l("form",{class:"flex flex-col gap-4 items-center",onSubmit:e[3]||(e[3]=O(a=>D(),["prevent"]))},[l("h1",te,f(n.$t("auth.loginnow")),1),l("p",ae,f(c(t)("auth.loginnote")),1),(g(!0),v(N,null,Y(h.value,a=>(g(),v("div",oe,[a.page.includes(u.value)?(g(),v("label",le,f(c(t)(`auth.${a.type}`)),1)):_("",!0),a.page.includes(u.value)?(g(),v("div",{key:1,class:I(["bg-[#9F9F9F26] py-2 rounded-md px-4 flex items-center gap-2",s.value.type==a.type&&s.value.message?"border-2 border-red-500":""])},[l("i",{class:I(["pi",a.icon?a.icon:""])},null,2),$(l("input",{"onUpdate:modelValue":y=>a.data=y,type:a.inputtype,placeholder:a.placeholder,class:"bg-transparent outline-none flex-1",onBlur:y=>B(a.type),id:a.type},null,40,ne),[[Z,a.data]]),l("i",{class:I(["pi",a.showicon?a.showicon:""]),onClick:y=>P(a.type)},null,10,ie)],2)):_("",!0),s.value.type==a.type&&s.value.message?(g(),v("span",re,f(s.value.message),1)):_("",!0)]))),256)),u.value=="login"?(g(),v("div",ue,[l("div",null,[$(l("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),type:"checkbox",id:"rememberme",class:"mx-2"},null,512),[[M,b.value]]),l("label",de,f(c(t)("auth.rememberme")),1)]),l("span",ce,f(c(t)("auth.forgotpassword")),1)])):_("",!0),u.value=="registration"?(g(),v("div",pe,[$(l("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),type:"checkbox",id:"Terms",class:"mx-2 text-xs"},null,512),[[M,k.value]]),l("label",me,f(c(t)("auth.terms")),1)])):_("",!0),x(p,{type:"submit",label:u.value=="registration"?c(t)("auth.registration"):u.value=="login"?c(t)("auth.login"):"",class:"outline-none w-full mt-6 focus:!shadow-none"},null,8,["label"]),x(p,{onClick:e[2]||(e[2]=a=>u.value=="registration"?u.value="login":u.value="registration"),label:u.value=="login"?c(t)("auth.registration"):u.value=="registration"?c(t)("auth.login"):"",severity:"secondary",class:"outline-none w-full focus:!shadow-none Custombutton"},null,8,["label"]),l("span",he,f(n.$t("auth.or")),1),x(p,{label:c(t)("auth.loginwithfacebock"),icon:"pi pi-facebook",severity:"secondary",class:"text-[#9F9F9F] !text-sm outline-none w-full focus:!shadow-none Custombutton"},null,8,["label"]),x(p,{label:c(t)("auth.loginwithgoogle"),icon:"pi pi-google",severity:"secondary",class:"text-[#9F9F9F] !text-sm outline-none w-full focus:!shadow-none Custombutton"},null,8,["label"])],32)])]),e[4]||(e[4]=l("div",null,[l("img",{src:G,alt:"",class:"lg:block hidden w-[450px] rounded-tl-[30%] rounded-br-[30%]"})],-1))])])],64)}}};export{fe as default};
