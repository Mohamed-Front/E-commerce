import{_ as K,u as G,k as H,K as J,j as Q,r as u,l as W,n as X,o as Y,a2 as E,M as Z,a as c,c as p,z as ee,f as t,t as d,e as l,N as h,h as g,g as te,v as m,x as P,w as ae,F as oe,i as C}from"./index-d6470849.js";const re={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},le={class:"text-3xl font-bold text-center mb-8 text-gray-800"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ne={class:"space-y-2"},ie={for:"name_en",class:"block text-sm font-medium text-gray-700"},de={class:"space-y-2"},ue={for:"name_ar",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2"},pe={for:"parent_id",class:"block text-sm font-medium text-gray-700"},me={class:"space-y-2"},ge={for:"store_id",class:"block text-sm font-medium text-gray-700"},_e={class:"space-y-2"},ve={class:"block text-sm font-medium text-gray-700"},be={class:"flex items-center space-x-4"},ye={class:"text-sm text-gray-600"},fe={key:0,class:"space-y-2"},xe={for:"market_id",class:"block text-sm font-medium text-gray-700"},he={class:"space-y-2"},ke={class:"block text-sm font-medium text-gray-700"},we={class:"flex justify-center"},De={key:0,class:"p-4 w-full h-full"},Ve={class:"relative group w-full h-full"},je=["src","alt"],Te={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ee={key:1,class:"p-4 flex flex-col items-center justify-center"},Ce={class:"text-sm text-center text-gray-600"},Ie={class:"text-blue-500 font-medium"},Be={class:"space-y-2"},Pe={class:"block text-sm font-medium text-gray-700"},Ue={class:"flex justify-center"},$e={key:0,class:"p-4 w-full h-full"},Se={class:"relative group w-full h-full"},Le=["src","alt"],Me={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ae={key:1,class:"p-4 flex flex-col items-center justify-center"},Fe={class:"text-sm text-center text-gray-600"},Ne={class:"text-blue-500 font-medium"},Oe={class:"space-y-2 md:col-span-2"},Re={class:"block text-sm font-medium text-gray-700"},qe={class:"flex justify-center"},ze={key:0,class:"p-4 w-full h-full"},Ke={class:"relative group w-full h-full"},Ge=["src","alt"],He={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Je={key:1,class:"p-4 flex flex-col items-center justify-center"},Qe={class:"text-sm text-center text-gray-600"},We={class:"text-blue-500 font-medium"},Xe={class:"pt-4 flex justify-center space-x-4"},Ye={key:0},Ze={key:1,class:"pi pi-spinner pi-spin"},et={__name:"create",setup(tt){const U=G(),v=H(),b=J(),{t:a}=Q(),y=u(!1),I=W(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),r=u({name_en:"",name_ar:"",linked_to_market:!1,market_id:null,parent_id:null,store_id:null,image:null,banner_one_image:null,banner_two_image:null}),k=u(null),w=u(null),D=u(null),$=u([]),S=u([]),L=u([]),V=u(!1),j=u(!1),T=u(!1),M=async()=>{try{const o=r.value.linked_to_market?"/api/market":"/api/category",e=await C.get(o);$.value=e.data.data.data}catch(o){console.error("Error fetching parent categories:",o),b.add({severity:"error",summary:a("error"),detail:a("category.fetchParentError"),life:3e3})}},F=async()=>{try{const o=await C.get("/api/market");S.value=o.data.data.data}catch(o){console.error("Error fetching markets:",o),b.add({severity:"error",summary:a("error"),detail:a("category.fetchMarketsError"),life:3e3})}},N=async()=>{try{const o=await C.get("/api/store");L.value=o.data.data.data}catch(o){console.error("Error fetching stores:",o),b.add({severity:"error",summary:a("error"),detail:a("category.fetchStoresError"),life:3e3})}},O=async o=>{try{const i=(await C.get(`/api/category/${o}`)).data.data;r.value={name_en:i.name_en||"",name_ar:i.name_ar||"",linked_to_market:!!i.linked_to_market,market_id:i.market_id||null,parent_id:i.parent_id||null,store_id:i.store_id||null,image:null,banner_one_image:null,banner_two_image:null},i.media.forEach(n=>{n.name==="category_image"?k.value=n.url:n.name==="banner_one_image"?w.value=n.url:n.name==="banner_two_image"&&(D.value=n.url)})}catch(e){console.error("Error fetching category data:",e),b.add({severity:"error",summary:a("error"),detail:a("category.fetchError"),life:3e3})}},R=(o,e)=>{const i=new FileReader;i.onload=n=>{switch(e){case"image":r.value.image=o,k.value=n.target.result,V.value=!1;break;case"banner_one":r.value.banner_one_image=o,w.value=n.target.result,j.value=!1;break;case"banner_two":r.value.banner_two_image=o,D.value=n.target.result,T.value=!1;break}},i.readAsDataURL(o)},f=(o,e)=>{var n,x,_;const i=((n=o.target.files)==null?void 0:n[0])||((_=(x=o.dataTransfer)==null?void 0:x.files)==null?void 0:_[0]);i&&i.type.match("image.*")&&R(i,e)},B=o=>{switch(o){case"image":r.value.image=null,k.value=null;break;case"banner_one":r.value.banner_one_image=null,w.value=null;break;case"banner_two":r.value.banner_two_image=null,D.value=null;break}},q=async()=>{var e,i;y.value=!0;const o=new FormData;o.append("name_en",r.value.name_en),o.append("name_ar",r.value.name_ar),o.append("linked_to_market",r.value.linked_to_market?"1":"0"),o.append("market_id",r.value.market_id||""),o.append("parent_id",r.value.parent_id||""),o.append("store_id",r.value.store_id||""),r.value.image&&o.append("image",r.value.image),r.value.banner_one_image&&o.append("banner_one_image",r.value.banner_one_image),r.value.banner_two_image&&o.append("banner_two_image",r.value.banner_two_image);try{const n=v.params.id,x="post",_=n?`/api/category/${n}`:"/api/category",A=await C[x](_,o);U.push({name:"categories"}),b.add({severity:"success",summary:a("success"),detail:a(n?"category.updateSuccess":"category.createSuccess"),life:3e3})}catch(n){console.error("Error:",n),b.add({severity:"error",summary:a("error"),detail:((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.message)||(v.params.id?a("category.updateError"):a("category.createError")),life:3e3})}finally{y.value=!1}};return X(()=>r.value.linked_to_market,()=>{M(),r.value.parent_id=null}),Y(async()=>{await Promise.all([F(),M(),N()]);const o=v.params.id;o&&await O(o)}),(o,e)=>{const i=E("InputText"),n=E("Dropdown"),x=E("InputSwitch"),_=E("Button"),A=E("Toast"),z=Z("can");return c(),p(oe,null,[ee((c(),p("div",re,[t("h1",le,d(l(v).params.id?l(a)("category.updateTitle"):l(a)("category.createTitle")),1),t("form",{onSubmit:m(q,["prevent"]),class:"space-y-6"},[t("div",se,[t("div",ne,[t("label",ie,[h(d(l(a)("category.nameEn"))+" ",1),e[22]||(e[22]=t("span",{class:"text-red-500"},"*",-1))]),g(i,{id:"name_en",modelValue:r.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.name_en=s),placeholder:l(a)("category.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",de,[t("label",ue,[h(d(l(a)("category.nameAr"))+" ",1),e[23]||(e[23]=t("span",{class:"text-red-500"},"*",-1))]),g(i,{id:"name_ar",modelValue:r.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.name_ar=s),placeholder:l(a)("category.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),t("div",ce,[t("label",pe,d(l(a)("category.parent")),1),g(n,{filter:"",modelValue:r.value.parent_id,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.parent_id=s),options:$.value,optionLabel:I.value,optionValue:"id",placeholder:l(a)("category.selectParent"),class:"w-full"},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",me,[t("label",ge,d(l(a)("category.store")),1),g(n,{filter:"",modelValue:r.value.store_id,"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.store_id=s),options:L.value,optionLabel:I.value,optionValue:"id",placeholder:l(a)("category.selectStore"),class:"w-full"},null,8,["modelValue","options","optionLabel","placeholder"])]),t("div",_e,[t("label",ve,d(l(a)("category.linkedToMarket")),1),t("div",be,[g(x,{modelValue:r.value.linked_to_market,"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.linked_to_market=s)},null,8,["modelValue"]),t("span",ye,d(r.value.linked_to_market?l(a)("category.market"):l(a)("category.nonMarket")),1)])]),r.value.linked_to_market?(c(),p("div",fe,[t("label",xe,[h(d(l(a)("category.market"))+" ",1),e[24]||(e[24]=t("span",{class:"text-red-500"},"*",-1))]),g(n,{filter:"",modelValue:r.value.market_id,"onUpdate:modelValue":e[5]||(e[5]=s=>r.value.market_id=s),options:S.value,optionLabel:I.value,optionValue:"id",placeholder:l(a)("category.selectMarket"),class:"w-full",required:""},null,8,["modelValue","options","optionLabel","placeholder"])])):te("",!0),t("div",he,[t("label",ke,d(l(a)("category.image")),1),t("div",we,[t("label",{onDragover:e[8]||(e[8]=m(s=>V.value=!0,["prevent"])),onDragleave:e[9]||(e[9]=s=>V.value=!1),onDrop:e[10]||(e[10]=m(s=>f(s,"image"),["prevent"])),class:P([{"border-blue-500 bg-blue-50":V.value,"border-gray-300":!V.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[6]||(e[6]=s=>f(s,"image")),accept:"image/*",class:"hidden"},null,32),k.value?(c(),p("div",De,[t("div",Ve,[t("img",{src:k.value,alt:l(a)("category.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,je),t("div",Te,[t("button",{type:"button",onClick:e[7]||(e[7]=m(s=>B("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[25]||(e[25]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Ee,[e[26]||(e[26]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Ce,[t("span",Ie,d(l(a)("category.clickToUpload")),1),h(" "+d(l(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Be,[t("label",Pe,d(l(a)("category.bannerOne")),1),t("div",Ue,[t("label",{onDragover:e[13]||(e[13]=m(s=>j.value=!0,["prevent"])),onDragleave:e[14]||(e[14]=s=>j.value=!1),onDrop:e[15]||(e[15]=m(s=>f(s,"banner_one"),["prevent"])),class:P([{"border-blue-500 bg-blue-50":j.value,"border-gray-300":!j.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[11]||(e[11]=s=>f(s,"banner_one")),accept:"image/*",class:"hidden"},null,32),w.value?(c(),p("div",$e,[t("div",Se,[t("img",{src:w.value,alt:l(a)("category.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Le),t("div",Me,[t("button",{type:"button",onClick:e[12]||(e[12]=m(s=>B("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[27]||(e[27]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Ae,[e[28]||(e[28]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Fe,[t("span",Ne,d(l(a)("category.clickToUpload")),1),h(" "+d(l(a)("category.orDragAndDrop")),1)])]))],34)])]),t("div",Oe,[t("label",Re,d(l(a)("category.bannerTwo")),1),t("div",qe,[t("label",{onDragover:e[18]||(e[18]=m(s=>T.value=!0,["prevent"])),onDragleave:e[19]||(e[19]=s=>T.value=!1),onDrop:e[20]||(e[20]=m(s=>f(s,"banner_two"),["prevent"])),class:P([{"border-blue-500 bg-blue-50":T.value,"border-gray-300":!T.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[t("input",{type:"file",onChange:e[16]||(e[16]=s=>f(s,"banner_two")),accept:"image/*",class:"hidden"},null,32),D.value?(c(),p("div",ze,[t("div",Ke,[t("img",{src:D.value,alt:l(a)("category.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Ge),t("div",He,[t("button",{type:"button",onClick:e[17]||(e[17]=m(s=>B("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},e[29]||(e[29]=[t("i",{class:"pi pi-trash text-sm"},null,-1)]))])])])):(c(),p("div",Je,[e[30]||(e[30]=t("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[t("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),t("p",Qe,[t("span",We,d(l(a)("category.clickToUpload")),1),h(" "+d(l(a)("category.orDragAndDrop")),1)])]))],34)])])]),t("div",Xe,[g(_,{type:"button",label:l(a)("cancel"),icon:"pi pi-times",onClick:e[21]||(e[21]=s=>l(U).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},null,8,["label","disabled"]),g(_,{type:"submit",label:l(v).params.id?l(a)("category.updateButton"):l(a)("category.createButton"),icon:"pi pi-plus",loading:y.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},{default:ae(()=>[y.value?(c(),p("i",Ze)):(c(),p("span",Ye,d(l(v).params.id?l(a)("category.updateButton"):l(a)("category.createButton")),1))]),_:1},8,["label","loading","disabled"])])],32)])),[[z,"create categories"]]),g(A)],64)}}},ot=K(et,[["__scopeId","data-v-6c686431"]]);export{ot as default};
