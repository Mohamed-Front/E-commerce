import{_ as G,u as H,j as J,H as K,D as Q,r as d,B as W,k as X,J as T,K as Y,o as u,c as p,L as Z,a as e,t as c,e as o,m as x,b as _,P as g,s as E,w as ee,F as te,G as B,p as ae,i as oe}from"./index-22274b14.js";const m=C=>(ae("data-v-22bfcdb6"),C=C(),oe(),C),se={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},ne={class:"text-3xl font-bold text-center mb-8 text-gray-800"},re=["onSubmit"],le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={class:"space-y-2"},ce={for:"name_en",class:"block text-sm font-medium text-gray-700"},de=m(()=>e("span",{class:"text-red-500"},"*",-1)),ue={class:"space-y-2"},pe={for:"name_ar",class:"block text-sm font-medium text-gray-700"},ge=m(()=>e("span",{class:"text-red-500"},"*",-1)),me={class:"space-y-2"},_e={for:"parent_id",class:"block text-sm font-medium text-gray-700"},be={class:"space-y-2"},ve={for:"store_id",class:"block text-sm font-medium text-gray-700"},ye=m(()=>e("span",{class:"text-red-500"},"*",-1)),fe={class:"space-y-2 md:col-span-2"},he={class:"block text-sm font-medium text-gray-700"},xe={class:"flex items-center space-x-4"},we={class:"text-sm text-gray-600"},ke={class:"space-y-2"},De={class:"block text-sm font-medium text-gray-700"},Ve={class:"flex justify-center"},je={key:0,class:"p-4 w-full h-full"},Ie={class:"relative group w-full h-full"},Te=["src","alt"],Ce={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Be=m(()=>e("i",{class:"pi pi-trash text-sm"},null,-1)),Se=[Be],$e={key:1,class:"p-4 flex flex-col items-center justify-center"},Ee=m(()=>e("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[e("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),Pe={class:"text-sm text-center text-gray-600"},Ue={class:"text-blue-500 font-medium"},Le={class:"space-y-2"},Ae={class:"block text-sm font-medium text-gray-700"},Fe={class:"flex justify-center"},Oe={key:0,class:"p-4 w-full h-full"},Re={class:"relative group w-full h-full"},qe=["src","alt"],Me={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ne=m(()=>e("i",{class:"pi pi-trash text-sm"},null,-1)),ze=[Ne],Ge={key:1,class:"p-4 flex flex-col items-center justify-center"},He=m(()=>e("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[e("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),Je={class:"text-sm text-center text-gray-600"},Ke={class:"text-blue-500 font-medium"},Qe={class:"space-y-2 md:col-span-2"},We={class:"block text-sm font-medium text-gray-700"},Xe={class:"flex justify-center"},Ye={key:0,class:"p-4 w-full h-full"},Ze={class:"relative group w-full h-full"},et=["src","alt"],tt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},at=m(()=>e("i",{class:"pi pi-trash text-sm"},null,-1)),ot=[at],st={key:1,class:"p-4 flex flex-col items-center justify-center"},nt=m(()=>e("div",{class:"bg-blue-100 p-3 rounded-full mb-2"},[e("i",{class:"pi pi-image text-blue-500 text-xl"})],-1)),rt={class:"text-sm text-center text-gray-600"},lt={class:"text-blue-500 font-medium"},it={class:"pt-4 flex justify-center space-x-4"},ct={key:0},dt={key:1,class:"pi pi-spinner pi-spin"},ut={setup(C){const P=H(),v=J(),S=K(),{t:a}=Q(),y=d(!1),U=W(()=>localStorage.getItem("appLang")=="ar"?"name_ar":"name_en"),r=d({name_en:"",name_ar:"",is_market:!1,parent_id:null,store_id:null,image:null,banner_one_image:null,banner_two_image:null}),w=d(null),k=d(null),D=d(null),L=d([]),A=d([]),V=d(!1),j=d(!1),I=d(!1),O=async()=>{try{const s=await B.get("/api/category");L.value=s.data.data.data}catch(s){console.error("Error fetching parent categories:",s)}},R=async()=>{try{const s=await B.get("/api/store");A.value=s.data.data.data}catch(s){console.error("Error fetching stores:",s)}},q=async s=>{try{const i=(await B.get(`/api/category/${s}`)).data.data;r.value={name_en:i.name_en||"",name_ar:i.name_ar||"",is_market:!!i.is_market,parent_id:i.parent_id||null,store_id:i.store_id||null,image:null,banner_one_image:null,banner_two_image:null},i.media.forEach(l=>{l.name==="category_image"?w.value=l.url:l.name==="banner_one_image"?k.value=l.url:l.name==="banner_two_image"&&(D.value=l.url)})}catch(t){console.error("Error fetching category data:",t),S.add({severity:"error",summary:a("error"),detail:a("category.fetchError"),life:3e3})}},M=(s,t)=>{const i=new FileReader;i.onload=l=>{switch(t){case"image":r.value.image=s,w.value=l.target.result,V.value=!1;break;case"banner_one":r.value.banner_one_image=s,k.value=l.target.result,j.value=!1;break;case"banner_two":r.value.banner_two_image=s,D.value=l.target.result,I.value=!1;break}},i.readAsDataURL(s)},f=(s,t)=>{var l,h,b;const i=((l=s.target.files)==null?void 0:l[0])||((b=(h=s.dataTransfer)==null?void 0:h.files)==null?void 0:b[0]);i&&i.type.match("image.*")&&M(i,t)},$=s=>{switch(s){case"image":r.value.image=null,w.value=null;break;case"banner_one":r.value.banner_one_image=null,k.value=null;break;case"banner_two":r.value.banner_two_image=null,D.value=null;break}},N=async()=>{var t,i;y.value=!0;const s=new FormData;s.append("name_en",r.value.name_en),s.append("name_ar",r.value.name_ar),s.append("is_market",r.value.is_market?"1":"0"),s.append("parent_id",r.value.parent_id||""),s.append("store_id",r.value.store_id||""),r.value.image&&s.append("image",r.value.image),r.value.banner_one_image&&s.append("banner_one_image",r.value.banner_one_image),r.value.banner_two_image&&s.append("banner_two_image",r.value.banner_two_image);try{const l=v.params.id,h="post",b=l?`/api/category/${l}`:"/api/category",F=await B[h](b,s);P.push({name:"category"}),S.add({severity:"success",summary:a("success"),detail:a(l?"category.updateSuccess":"category.createSuccess"),life:3e3})}catch(l){console.error("Error:",l),S.add({severity:"error",summary:a("error"),detail:((i=(t=l.response)==null?void 0:t.data)==null?void 0:i.message)||(v.params.id?a("category.updateError"):a("category.createError")),life:3e3})}finally{y.value=!1}};return X(async()=>{await O(),await R();const s=v.params.id;s&&await q(s)}),(s,t)=>{const i=T("InputText"),l=T("Dropdown"),h=T("InputSwitch"),b=T("Button"),F=T("Toast"),z=Y("can");return u(),p(te,null,[Z((u(),p("div",se,[e("h1",ne,c(o(v).params.id?o(a)("category.updateTitle"):o(a)("category.createTitle")),1),e("form",{onSubmit:g(N,["prevent"]),class:"space-y-6"},[e("div",le,[e("div",ie,[e("label",ce,[x(c(o(a)("category.nameEn"))+" ",1),de]),_(i,{id:"name_en",modelValue:r.value.name_en,"onUpdate:modelValue":t[0]||(t[0]=n=>r.value.name_en=n),placeholder:o(a)("category.nameEnPlaceholder"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),e("div",ue,[e("label",pe,[x(c(o(a)("category.nameAr"))+" ",1),ge]),_(i,{id:"name_ar",modelValue:r.value.name_ar,"onUpdate:modelValue":t[1]||(t[1]=n=>r.value.name_ar=n),placeholder:o(a)("category.nameArPlaceholder"),dir:"rtl",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"])]),e("div",me,[e("label",_e,c(o(a)("category.parent")),1),_(l,{modelValue:r.value.parent_id,"onUpdate:modelValue":t[2]||(t[2]=n=>r.value.parent_id=n),options:L.value,optionLabel:o(U),optionValue:"id",placeholder:o(a)("category.selectParent"),class:"w-full",showClear:!0},null,8,["modelValue","options","optionLabel","placeholder"])]),e("div",be,[e("label",ve,[x(c(o(a)("category.store"))+" ",1),ye]),_(l,{modelValue:r.value.store_id,"onUpdate:modelValue":t[3]||(t[3]=n=>r.value.store_id=n),options:A.value,optionLabel:o(U),optionValue:"id",placeholder:o(a)("category.selectStore"),class:"w-full",required:""},null,8,["modelValue","options","optionLabel","placeholder"])]),e("div",fe,[e("label",he,c(o(a)("category.marketType")),1),e("div",xe,[_(h,{modelValue:r.value.is_market,"onUpdate:modelValue":t[4]||(t[4]=n=>r.value.is_market=n)},null,8,["modelValue"]),e("span",we,c(r.value.is_market?o(a)("category.market"):o(a)("category.nonMarket")),1)])]),e("div",ke,[e("label",De,c(o(a)("category.image")),1),e("div",Ve,[e("label",{onDragover:t[7]||(t[7]=g(n=>V.value=!0,["prevent"])),onDragleave:t[8]||(t[8]=n=>V.value=!1),onDrop:t[9]||(t[9]=g(n=>f(n,"image"),["prevent"])),class:E([{"border-blue-500 bg-blue-50":V.value,"border-gray-300":!V.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[e("input",{type:"file",onChange:t[5]||(t[5]=n=>f(n,"image")),accept:"image/*",class:"hidden"},null,32),w.value?(u(),p("div",je,[e("div",Ie,[e("img",{src:w.value,alt:o(a)("category.imagePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Te),e("div",Ce,[e("button",{type:"button",onClick:t[6]||(t[6]=g(n=>$("image"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},Se)])])])):(u(),p("div",$e,[Ee,e("p",Pe,[e("span",Ue,c(o(a)("category.clickToUpload")),1),x(" "+c(o(a)("category.orDragAndDrop")),1)])]))],34)])]),e("div",Le,[e("label",Ae,c(o(a)("category.bannerOne")),1),e("div",Fe,[e("label",{onDragover:t[12]||(t[12]=g(n=>j.value=!0,["prevent"])),onDragleave:t[13]||(t[13]=n=>j.value=!1),onDrop:t[14]||(t[14]=g(n=>f(n,"banner_one"),["prevent"])),class:E([{"border-blue-500 bg-blue-50":j.value,"border-gray-300":!j.value},"cursor-pointer w-full h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[e("input",{type:"file",onChange:t[10]||(t[10]=n=>f(n,"banner_one")),accept:"image/*",class:"hidden"},null,32),k.value?(u(),p("div",Oe,[e("div",Re,[e("img",{src:k.value,alt:o(a)("category.bannerOnePreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,qe),e("div",Me,[e("button",{type:"button",onClick:t[11]||(t[11]=g(n=>$("banner_one"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},ze)])])])):(u(),p("div",Ge,[He,e("p",Je,[e("span",Ke,c(o(a)("category.clickToUpload")),1),x(" "+c(o(a)("category.orDragAndDrop")),1)])]))],34)])]),e("div",Qe,[e("label",We,c(o(a)("category.bannerTwo")),1),e("div",Xe,[e("label",{onDragover:t[17]||(t[17]=g(n=>I.value=!0,["prevent"])),onDragleave:t[18]||(t[18]=n=>I.value=!1),onDrop:t[19]||(t[19]=g(n=>f(n,"banner_two"),["prevent"])),class:E([{"border-blue-500 bg-blue-50":I.value,"border-gray-300":!I.value},"cursor-pointer w-full max-w-2xl h-48 rounded-xl border-2 border-dashed transition-colors duration-300 flex items-center justify-center"])},[e("input",{type:"file",onChange:t[15]||(t[15]=n=>f(n,"banner_two")),accept:"image/*",class:"hidden"},null,32),D.value?(u(),p("div",Ye,[e("div",Ze,[e("img",{src:D.value,alt:o(a)("category.bannerTwoPreview"),class:"w-full h-full object-contain rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,et),e("div",tt,[e("button",{type:"button",onClick:t[16]||(t[16]=g(n=>$("banner_two"),["stop"])),class:"opacity-0 group-hover:opacity-100 bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},ot)])])])):(u(),p("div",st,[nt,e("p",rt,[e("span",lt,c(o(a)("category.clickToUpload")),1),x(" "+c(o(a)("category.orDragAndDrop")),1)])]))],34)])])]),e("div",it,[_(b,{type:"button",label:o(a)("cancel"),icon:"pi pi-times",onClick:t[20]||(t[20]=n=>o(P).go(-1)),class:"px-6 py-3 mx-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},null,8,["label","disabled"]),_(b,{type:"submit",label:o(v).params.id?o(a)("category.updateButton"):o(a)("category.createButton"),icon:"pi pi-plus",loading:y.value,class:"px-8 mx-2 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},{default:ee(()=>[y.value?(u(),p("i",dt)):(u(),p("span",ct,c(o(v).params.id?o(a)("category.updateButton"):o(a)("category.createButton")),1))]),_:1},8,["label","loading","disabled"])])],40,re)])),[[z,"create categories"]]),_(F)],64)}}},gt=G(ut,[["__scopeId","data-v-22bfcdb6"]]);export{gt as default};
