import{_ as K,B as M,u as O,j as Q,H as W,D as X,r as g,k as Z,G as h,J as p,o as r,c as u,a as s,t as a,b as i,w as T,P as ee,F as te,m as y,e as j,E as _,p as oe,i as se}from"./index-22274b14.js";import{h as E}from"./moment-fbc5633a.js";const v=f=>(oe("data-v-14746d41"),f=f(),se(),f),ae={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},le={class:"text-3xl font-bold text-center mb-8 text-gray-800"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ne={class:"space-y-2"},re={for:"model_id",class:"block text-sm font-medium text-gray-700"},ue=v(()=>s("span",{class:"text-red-500"},"*",-1)),ie={key:0,class:"text-red-500 text-xs"},ce={class:"space-y-2"},pe={for:"model_type",class:"block text-sm font-medium text-gray-700"},_e=v(()=>s("span",{class:"text-red-500"},"*",-1)),me={key:0,class:"text-red-500 text-xs"},ye={class:"space-y-2"},ve={for:"discount_type",class:"block text-sm font-medium text-gray-700"},fe=v(()=>s("span",{class:"text-red-500"},"*",-1)),be={key:0,class:"text-red-500 text-xs"},ge={class:"space-y-2"},xe={for:"discount_value",class:"block text-sm font-medium text-gray-700"},he=v(()=>s("span",{class:"text-red-500"},"*",-1)),we={key:0,class:"text-gray-500 text-xs"},Ve={key:1,class:"text-red-500 text-xs"},ke={class:"space-y-2"},$e={for:"expires_at",class:"block text-sm font-medium text-gray-700"},De=v(()=>s("span",{class:"text-red-500"},"*",-1)),Fe={key:0,class:"text-red-500 text-xs"},Ie={class:"pt-4 flex justify-center space-x-4"},Se={key:0},Be={key:1,class:"pi pi-spinner pi-spin"},Ce={setup(f){const Y=M(()=>localStorage.getItem("appLang")||"en"),P=M(()=>Y.value==="en"?"name_en":"name_ar"),w=O(),V=Q(),x=W(),{t:m}=X(),d=g(),c=g(!1),k=g([]),t=g({model_id:"",model_type:"",discount_type:null,discount_value:"",expires_at:""});Z(()=>{R(),A()});const R=()=>{h.get("api/model").then(e=>{k.value=e.data.data.data})},A=()=>{const e=V.params.id;h.get(`/api/discount/${e}`).then(o=>{const l=o.data.data;t.value={model_id:l.model_id,model_type:l.model_type,discount_type:l.discount_type,discount_value:l.discount_value,expires_at:E(l.expires_at).toDate()}}).catch(o=>{console.error("Error fetching discount:",o),x.add({severity:"error",summary:m("error"),detail:m("discount.fetch_error"),life:3e3})})},G=async()=>{var o,l;c.value=!0,t.value.expires_at=E(t.value.expires_at).format("YYYY-MM-DD");const e=new FormData;e.append("model_id",t.value.model_id),e.append("model_type",t.value.model_type),e.append("discount_type",t.value.discount_type),e.append("discount_value",t.value.discount_value),e.append("expires_at",t.value.expires_at),e.append("_method","PUT");try{await h.post(`/api/discount/${V.params.id}`,e),w.push({name:"discount"}),x.add({severity:"success",summary:m("success"),detail:m("discount.updated_successfully"),life:3e3})}catch(b){console.error("Error:",b),x.add({severity:"error",summary:m("error"),detail:((l=(o=b.response)==null?void 0:o.data)==null?void 0:l.message)||"An error occurred",life:3e3})}finally{c.value=!1}};return(e,o)=>{const l=p("Dropdown"),b=p("InputNumber"),H=p("Calendar"),$=p("Button"),J=p("Form"),z=p("Toast");return r(),u(te,null,[s("div",ae,[s("h1",le,a(e.$t("discount.update_discount")),1),i(J,{ref_key:"form",ref:d,onSubmit:ee(G,["prevent"]),class:"space-y-6"},{default:T(()=>{var D,F,I,S,B,C,N,U,q,L;return[s("div",de,[s("div",ne,[s("label",re,[y(a(e.$t("discount.model_id"))+" ",1),ue]),i(l,{id:"model_id",modelValue:t.value.model_id,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value.model_id=n),options:k.value,optionLabel:j(P),optionValue:"id",placeholder:e.$t("discount.enter_model_id"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","options","optionLabel","placeholder"]),(F=(D=d.value)==null?void 0:D.errors)!=null&&F.model_id?(r(),u("small",ie,a(d.value.errors.model_id[0]),1)):_("",!0)]),s("div",ce,[s("label",pe,[y(a(e.$t("discount.model_type"))+" ",1),_e]),i(l,{id:"model_type",modelValue:t.value.model_type,"onUpdate:modelValue":o[1]||(o[1]=n=>t.value.model_type=n),options:["product","category"],placeholder:e.$t("discount.select_model_type"),class:"w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","placeholder"]),(S=(I=d.value)==null?void 0:I.errors)!=null&&S.model_type?(r(),u("small",me,a(d.value.errors.model_type[0]),1)):_("",!0)]),s("div",ye,[s("label",ve,[y(a(e.$t("discount.discount_type"))+" ",1),fe]),i(l,{id:"discount_type",modelValue:t.value.discount_type,"onUpdate:modelValue":o[2]||(o[2]=n=>t.value.discount_type=n),options:[{label:e.$t("discount.fixed_amount"),value:1},{label:e.$t("discount.percentage"),value:2}],optionLabel:"label",optionValue:"value",placeholder:e.$t("discount.select_discount_type"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","options","placeholder"]),(C=(B=d.value)==null?void 0:B.errors)!=null&&C.discount_type?(r(),u("small",be,a(d.value.errors.discount_type[0]),1)):_("",!0)]),s("div",ge,[s("label",xe,[y(a(e.$t("discount.discount_value"))+" ",1),he]),i(b,{id:"discount_value",modelValue:t.value.discount_value,"onUpdate:modelValue":o[3]||(o[3]=n=>t.value.discount_value=n),min:0,max:t.value.discount_type===2?100:null,placeholder:e.$t("discount.enter_discount_value"),class:"w-full px-4 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",required:""},null,8,["modelValue","max","placeholder"]),t.value.discount_type===2?(r(),u("small",we,a(e.$t("discount.percentage_note")),1)):_("",!0),(U=(N=d.value)==null?void 0:N.errors)!=null&&U.discount_value?(r(),u("small",Ve,a(d.value.errors.discount_value[0]),1)):_("",!0)]),s("div",ke,[s("label",$e,[y(a(e.$t("discount.expiration_date"))+" ",1),De]),i(H,{id:"expires_at",modelValue:t.value.expires_at,"onUpdate:modelValue":o[4]||(o[4]=n=>t.value.expires_at=n),minDate:new Date,dateFormat:"yy-mm-dd",placeholder:e.$t("discount.select_expiration_date"),class:"w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,8,["modelValue","minDate","placeholder"]),(L=(q=d.value)==null?void 0:q.errors)!=null&&L.expires_at?(r(),u("small",Fe,a(d.value.errors.expires_at[0]),1)):_("",!0)])]),s("div",Ie,[i($,{type:"button",label:e.$t("discount.cancel"),icon:"pi pi-times",onClick:o[5]||(o[5]=n=>j(w).go(-1)),class:"px-6 mx-2 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:c.value},null,8,["label","disabled"]),i($,{type:"submit",label:e.$t("discount.update_discount"),icon:"pi pi-check",loading:c.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:c.value},{default:T(()=>[c.value?(r(),u("i",Be)):(r(),u("span",Se,a(e.$t("discount.update_discount")),1))]),_:1},8,["label","loading","disabled"])])]}),_:1},8,["onSubmit"])]),i(z)],64)}}},qe=K(Ce,[["__scopeId","data-v-14746d41"]]);export{qe as default};
